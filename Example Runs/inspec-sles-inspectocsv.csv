id,title,desc,descriptions,impact,refs,severity,gtitle,gid,rid,stig_id,fix_id,cci,nist,false_negatives,false_positives,documentable,mitigations,severity_override_guidance,potential_impacts,third_party_tools,mitigation_controls,responsibility,ia_controls,check,fix,code,source_location,status,code_desc,run_time,start_time,message
V-89465,"The SLES for vRealize must automatically remove or disable temporary
user accounts after 72 hours.","If temporary user accounts remain active when no longer needed or for
an excessive period, these accounts may be used to gain unauthorized access. To
mitigate this risk, automated termination of all temporary accounts must be set
upon account creation.

    Temporary accounts are established as part of normal account activation
procedures when there is a need for short-term accounts without the demand for
immediacy in account activation.

    If temporary accounts are used, the operating system must be configured to
automatically terminate these types of accounts after a DoD-defined time period
of 72 hours.

    To address access requirements, many operating systems may be integrated
with enterprise-level authentication/access mechanisms that meet or exceed
access control policy requirements.","[{""label""=>""default"", ""data""=>""If temporary user accounts remain active when no longer needed or for\nan excessive period, these accounts may be used to gain unauthorized access. To\nmitigate this risk, automated termination of all temporary accounts must be set\nupon account creation.\n\n    Temporary accounts are established as part of normal account activation\nprocedures when there is a need for short-term accounts without the demand for\nimmediacy in account activation.\n\n    If temporary accounts are used, the operating system must be configured to\nautomatically terminate these types of accounts after a DoD-defined time period\nof 72 hours.\n\n    To address access requirements, many operating systems may be integrated\nwith enterprise-level authentication/access mechanisms that meet or exceed\naccess control policy requirements.""}]",0.5,[],"",SRG-OS-000002-GPOS-00002,V-89465,SV-100115r1_rule,VRAU-SL-000010,F-96207r1_fix,"[""CCI-000016""]","[""AC-2 (2)"", ""Rev_4""]","","","","","","","","","","","For every existing temporary account, run the following command
to obtain its account expiration information:

# chage -l system_account_name

Verify each of these accounts has an expiration date set within ""72"" hours.

If any temporary accounts have no expiration date set or do not expire within
""72"" hours, this is a finding.","In the event temporary accounts are required, configure the
system to terminate them after a 72-hour time period. For every temporary
account, run the following command to set an expiration date on it,
substituting ""system_account_name"" to the appropriate value:

# chage -E `date -d ""+3 days"" +%Y-%m-%d` system_account_name

`date -d ""+3 days"" +%Y-%m-%d` gets the ""72"" expiration date for the account
at the time of running the command.","control ""V-89465"" do
  title ""The SLES for vRealize must automatically remove or disable temporary
user accounts after 72 hours.""
  desc  ""If temporary user accounts remain active when no longer needed or for
an excessive period, these accounts may be used to gain unauthorized access. To
mitigate this risk, automated termination of all temporary accounts must be set
upon account creation.

    Temporary accounts are established as part of normal account activation
procedures when there is a need for short-term accounts without the demand for
immediacy in account activation.

    If temporary accounts are used, the operating system must be configured to
automatically terminate these types of accounts after a DoD-defined time period
of 72 hours.

    To address access requirements, many operating systems may be integrated
with enterprise-level authentication/access mechanisms that meet or exceed
access control policy requirements.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000002-GPOS-00002""
  tag ""gid"": ""V-89465""
  tag ""rid"": ""SV-100115r1_rule""
  tag ""stig_id"": ""VRAU-SL-000010""
  tag ""fix_id"": ""F-96207r1_fix""
  tag ""cci"": [""CCI-000016""]
  tag ""nist"": [""AC-2 (2)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""For every existing temporary account, run the following command
to obtain its account expiration information:

# chage -l system_account_name

Verify each of these accounts has an expiration date set within \""72\"" hours.

If any temporary accounts have no expiration date set or do not expire within
\""72\"" hours, this is a finding.""
  tag ""fix"": ""In the event temporary accounts are required, configure the
system to terminate them after a 72-hour time period. For every temporary
account, run the following command to set an expiration date on it,
substituting \""system_account_name\"" to the appropriate value:

# chage -E `date -d \""+3 days\"" +%Y-%m-%d` system_account_name

`date -d \""+3 days\"" +%Y-%m-%d` gets the \""72\"" expiration date for the account
at the time of running the command.""

#temporary_accounts = attribute('temporary_accounts')

#if temporary_accounts.empty?
#  describe ""Temporary accounts"" do
#    it { should_be empty }
#  end
#else
#  temporary_accounts.each do |acct|
#    describe command(""chage -l #{acct} | grep 'Account expires'"") do
#      its('stdout.strip') { should_not match %r{:\s*never} }
#    end
#  end
#end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89465.rb""}","","","","",""
V-89467,The SLES for vRealize must audit all account creations.,"Once an attacker establishes initial access to a system, the attacker
often attempts to create a persistent method of reestablishing access. One way
to accomplish this is for the attacker to simply create a new account. Auditing
of account creation mitigates this risk.

    To address access requirements, many operating systems may be integrated
with enterprise-level authentication/access/auditing mechanisms that meet or
exceed access control policy requirements.","[{""label""=>""default"", ""data""=>""Once an attacker establishes initial access to a system, the attacker\noften attempts to create a persistent method of reestablishing access. One way\nto accomplish this is for the attacker to simply create a new account. Auditing\nof account creation mitigates this risk.\n\n    To address access requirements, many operating systems may be integrated\nwith enterprise-level authentication/access/auditing mechanisms that meet or\nexceed access control policy requirements.""}]",0.5,[],",
",SRG-OS-000004-GPOS-00004,V-89467,SV-100117r1_rule,VRAU-SL-000015,F-96209r1_fix,"[""CCI-000018""]","[""AC-2 (4)"", ""Rev_4""]",",
",",
",",
",",
",",
",",
",",
",",
",",
",",
","Determine if execution of the useradd and groupadd executable
are audited.

# auditctl -l | egrep '(useradd|groupadd)'

If either useradd or groupadd are not listed with a permissions filter of at
least ""x"", this is a finding.

Expected result:
LIST_RULES: exit,always watch=/usr/sbin/useradd perm=x key=useradd
LIST_RULES: exit,always watch=/usr/sbin/groupadd perm=x key=groupadd","Configure execute auditing of the useradd and groupadd
executables. Run the dodscript with the following command as root:

# /etc/dodscript.sh

OR

Configure execute auditing of the useradd and groupadd executables.

Add the following to /etc/audit/audit.rules:
-w /usr/sbin/useradd -p x -k useradd
-w /usr/sbin/groupadd -p x -k groupadd

Restart the auditd service:
# service auditd restart","control ""V-89467"" do
  title ""The SLES for vRealize must audit all account creations.""
  desc  ""Once an attacker establishes initial access to a system, the attacker
often attempts to create a persistent method of reestablishing access. One way
to accomplish this is for the attacker to simply create a new account. Auditing
of account creation mitigates this risk.

    To address access requirements, many operating systems may be integrated
with enterprise-level authentication/access/auditing mechanisms that meet or
exceed access control policy requirements.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000004-GPOS-00004""
  tag ""gid"": ""V-89467""
  tag ""rid"": ""SV-100117r1_rule""
  tag ""stig_id"": ""VRAU-SL-000015""
  tag ""fix_id"": ""F-96209r1_fix""
  tag ""cci"": [""CCI-000018""]
  tag ""nist"": [""AC-2 (4)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Determine if execution of the useradd and groupadd executable
are audited.

# auditctl -l | egrep '(useradd|groupadd)'

If either useradd or groupadd are not listed with a permissions filter of at
least \""x\"", this is a finding.

Expected result:
LIST_RULES: exit,always watch=/usr/sbin/useradd perm=x key=useradd
LIST_RULES: exit,always watch=/usr/sbin/groupadd perm=x key=groupadd""
  tag ""fix"": ""Configure execute auditing of the useradd and groupadd
executables. Run the dodscript with the following command as root:

# /etc/dodscript.sh

OR

Configure execute auditing of the useradd and groupadd executables.

Add the following to /etc/audit/audit.rules:
-w /usr/sbin/useradd -p x -k useradd
-w /usr/sbin/groupadd -p x -k groupadd

Restart the auditd service:
# service auditd restart""

  describe file(""/etc/audit/audit.rules"") do
    its(""content"") { should match %r{-w /usr/sbin/useradd -p x -k useradd} }
    its(""content"") { should match %r{-w /usr/sbin/groupadd -p x -k groupadd} }
  end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89467.rb""}","passed,
passed","File /etc/audit/audit.rules content should match /-w \/usr\/sbin\/useradd -p x -k useradd/,
File /etc/audit/audit.rules content should match /-w \/usr\/sbin\/groupadd -p x -k groupadd/","0.1232025,
0.0002069","2019-08-01T08:47:25-07:00,
2019-08-01T08:47:25-07:00",",
"
V-89469,"In addition to auditing new user and group accounts, these watches
will alert the system administrator(s) to any modifications. Any unexpected
users, groups, or modifications must be investigated for legitimacy.","Once an attacker establishes initial access to a system, the attacker
often attempts to create a persistent method of reestablishing access. One way
to accomplish this is for the attacker to simply create a new account. Auditing
of account creation mitigates this risk.

    To address access requirements, many operating systems may be integrated
with enterprise-level authentication/access/auditing mechanisms that meet or
exceed access control policy requirements.","[{""label""=>""default"", ""data""=>""Once an attacker establishes initial access to a system, the attacker\noften attempts to create a persistent method of reestablishing access. One way\nto accomplish this is for the attacker to simply create a new account. Auditing\nof account creation mitigates this risk.\n\n    To address access requirements, many operating systems may be integrated\nwith enterprise-level authentication/access/auditing mechanisms that meet or\nexceed access control policy requirements.""}]",0.5,[],",
,
,
",SRG-OS-000004-GPOS-00004,V-89469,SV-100119r1_rule,VRAU-SL-000020,F-96211r1_fix,"[""CCI-000018""]","[""AC-2 (4)"", ""Rev_4""]",",
,
,
",",
,
,
",",
,
,
",",
,
,
",",
,
,
",",
,
,
",",
,
,
",",
,
,
",",
,
,
",",
,
,
","Determine if /etc/passwd, /etc/shadow, /etc/group, and
/etc/gshadow are audited for appending.

# auditctl -l | egrep '(/etc/passwd|/etc/shadow|/etc/group|/etc/gshadow)' |
grep perm=a

If any of these are not listed with a permissions filter of at least ""a"",
this is a finding.

Expected result:
LIST_RULES: exit,always watch=/etc/passwd perm=a key=passwd
LIST_RULES: exit,always watch=/etc/shadow perm=a key=shadow
LIST_RULES: exit,always watch=/etc/group perm=a key=group
LIST_RULES: exit,always watch=/etc/gshadow perm=a key=gshadow","Configure append auditing of the passwd, shadow, group, and
gshadow files. Run the dodscript with the following command as root:

# /etc/dodscript.sh
# echo '-w /etc/gshadow -p a -k gshadow' >> /etc/audit/audit.rules

Restart the auditd service.
# service auditd restart

OR

Configure append auditing of the passwd, shadow, group, and gshadow files by
running the following commands:

# echo '-w /etc/passwd -p a -k passwd' >> /etc/audit/audit.rules
# echo '-w /etc/shadow -p a -k shadow' >> /etc/audit/audit.rules
# echo '-w /etc/group -p a -k group' >> /etc/audit/audit.rules
# echo '-w /etc/gshadow -p a -k gshadow' >> /etc/audit/audit.rules

Restart the auditd service:
# service auditd restart","control ""V-89469"" do
  title ""In addition to auditing new user and group accounts, these watches
will alert the system administrator(s) to any modifications. Any unexpected
users, groups, or modifications must be investigated for legitimacy.""
  desc  ""Once an attacker establishes initial access to a system, the attacker
often attempts to create a persistent method of reestablishing access. One way
to accomplish this is for the attacker to simply create a new account. Auditing
of account creation mitigates this risk.

    To address access requirements, many operating systems may be integrated
with enterprise-level authentication/access/auditing mechanisms that meet or
exceed access control policy requirements.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000004-GPOS-00004""
  tag ""gid"": ""V-89469""
  tag ""rid"": ""SV-100119r1_rule""
  tag ""stig_id"": ""VRAU-SL-000020""
  tag ""fix_id"": ""F-96211r1_fix""
  tag ""cci"": [""CCI-000018""]
  tag ""nist"": [""AC-2 (4)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Determine if /etc/passwd, /etc/shadow, /etc/group, and
/etc/gshadow are audited for appending.

# auditctl -l | egrep '(/etc/passwd|/etc/shadow|/etc/group|/etc/gshadow)' |
grep perm=a

If any of these are not listed with a permissions filter of at least \""a\"",
this is a finding.

Expected result:
LIST_RULES: exit,always watch=/etc/passwd perm=a key=passwd
LIST_RULES: exit,always watch=/etc/shadow perm=a key=shadow
LIST_RULES: exit,always watch=/etc/group perm=a key=group
LIST_RULES: exit,always watch=/etc/gshadow perm=a key=gshadow""
  tag ""fix"": ""Configure append auditing of the passwd, shadow, group, and
gshadow files. Run the dodscript with the following command as root:

# /etc/dodscript.sh
# echo '-w /etc/gshadow -p a -k gshadow' >> /etc/audit/audit.rules

Restart the auditd service.
# service auditd restart

OR

Configure append auditing of the passwd, shadow, group, and gshadow files by
running the following commands:

# echo '-w /etc/passwd -p a -k passwd' >> /etc/audit/audit.rules
# echo '-w /etc/shadow -p a -k shadow' >> /etc/audit/audit.rules
# echo '-w /etc/group -p a -k group' >> /etc/audit/audit.rules
# echo '-w /etc/gshadow -p a -k gshadow' >> /etc/audit/audit.rules

Restart the auditd service:
# service auditd restart""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-w /etc/passwd -p a -k passwd} }
  its(""content"") { should match %r{-w /etc/shadow -p a -k shadow} }
  its(""content"") { should match %r{-w /etc/group -p a -k group} }
  its(""content"") { should match %r{-w /etc/gshadow -p a -k gshadow} }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89469.rb""}","passed,
passed,
passed,
passed","File /etc/audit/audit.rules content should match /-w \/etc\/passwd -p a -k passwd/,
File /etc/audit/audit.rules content should match /-w \/etc\/shadow -p a -k shadow/,
File /etc/audit/audit.rules content should match /-w \/etc\/group -p a -k group/,
File /etc/audit/audit.rules content should match /-w \/etc\/gshadow -p a -k gshadow/","0.0001369,
0.0001705,
0.0001432,
0.0001271","2019-08-01T08:47:25-07:00,
2019-08-01T08:47:25-07:00,
2019-08-01T08:47:25-07:00,
2019-08-01T08:47:25-07:00",",
,
,
"
V-89471,"The SLES for vRealize must enforce the limit of three consecutive
invalid logon attempts by a user during a 15-minute time period.","By limiting the number of failed logon attempts, the risk of
unauthorized system access via user password guessing, otherwise known as
brute-force attacks, is reduced. Limits are imposed by locking the account.","[{""label""=>""default"", ""data""=>""By limiting the number of failed logon attempts, the risk of\nunauthorized system access via user password guessing, otherwise known as\nbrute-force attacks, is reduced. Limits are imposed by locking the account.""}]",0.5,[],"",SRG-OS-000021-GPOS-00005,V-89471,SV-100121r1_rule,VRAU-SL-000025,F-96213r2_fix,"[""CCI-000044""]","[""AC-7 a"", ""Rev_4""]","","","","","","","","","","","Run the following command to ensure that the operating system
enforces the limit of three consecutive invalid logon attempts by a user:

# grep pam_tally2.so /etc/pam.d/common-auth

The output should contain ""deny=3"" in the returned line.

If this is not the case, this is a finding.

Expected Result:
auth    required       pam_tally2.so deny=3 onerr=fail even_deny_root
unlock_time=86400 root_unlock_time=300","To configure the SLES for vRealize to enforce the limit of three
consecutive invalid attempts using ""pam_tally2.so"", modify the content of the
/etc/pam.d/common-auth-vmware.local by running the following command:

# sed -i ""/^[^#]*pam_tally2.so/ c\auth required pam_tally2.so deny=3
onerr=fail even_deny_root unlock_time=86400 root_unlock_time=300""
/etc/pam.d/common-auth-vmware.local","control ""V-89471"" do
  title ""The SLES for vRealize must enforce the limit of three consecutive
invalid logon attempts by a user during a 15-minute time period.""
  desc  ""By limiting the number of failed logon attempts, the risk of
unauthorized system access via user password guessing, otherwise known as
brute-force attacks, is reduced. Limits are imposed by locking the account.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000021-GPOS-00005""
  tag ""gid"": ""V-89471""
  tag ""rid"": ""SV-100121r1_rule""
  tag ""stig_id"": ""VRAU-SL-000025""
  tag ""fix_id"": ""F-96213r2_fix""
  tag ""cci"": [""CCI-000044""]
  tag ""nist"": [""AC-7 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Run the following command to ensure that the operating system
enforces the limit of three consecutive invalid logon attempts by a user:

# grep pam_tally2.so /etc/pam.d/common-auth

The output should contain \""deny=3\"" in the returned line.

If this is not the case, this is a finding.

Expected Result:
auth    required       pam_tally2.so deny=3 onerr=fail even_deny_root
unlock_time=86400 root_unlock_time=300""
  tag ""fix"": ""To configure the SLES for vRealize to enforce the limit of three
consecutive invalid attempts using \""pam_tally2.so\"", modify the content of the
/etc/pam.d/common-auth-vmware.local by running the following command:

# sed -i \""/^[^#]*pam_tally2.so/ c\\auth required pam_tally2.so deny=3
onerr=fail even_deny_root unlock_time=86400 root_unlock_time=300\""
/etc/pam.d/common-auth-vmware.local""

file(""/etc/pam.d/common-auth"").content.to_s.scan(/^\s*auth\s+(?:(?:sufficient)|(?:\[default=die\]))\s+pam_faillock\.so\s+authfail.*deny=([0-9]+).*$/).flatten.each do |entry|
  describe entry do
    it { should cmp == 3 }
  end
end


end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89471.rb""}","","","","",""
V-89473,"The SLES for vRealize must display the Standard Mandatory DoD Notice
and Consent Banner before granting access via SSH.","Display of a standardized and approved use notification before
granting access to the operating system ensures privacy and security
notification verbiage used is consistent with applicable federal laws,
Executive Orders, directives, policies, regulations, standards, and guidance.

    System use notifications are required only for access via logon interfaces
with human users and are not required when such human interfaces do not exist.

    The banner must be formatted in accordance with applicable DoD policy. Use
the following verbiage for operating systems that can accommodate banners of
1300 characters:

    ""You are accessing a U.S. Government (USG) Information System (IS) that is
provided for USG-authorized use only.

    By using this IS (which includes any device attached to this IS), you
consent to the following conditions:

    -The USG routinely intercepts and monitors communications on this IS for
purposes including, but not limited to, penetration testing, COMSEC monitoring,
network operations and defense, personnel misconduct (PM), law enforcement
(LE), and counterintelligence (CI) investigations.

    -At any time, the USG may inspect and seize data stored on this IS.

    -Communications using, or data stored on, this IS are not private, are
subject to routine monitoring, interception, and search, and may be disclosed
or used for any USG-authorized purpose.

    -This IS includes security measures (e.g., authentication and access
controls) to protect USG interests--not for your personal benefit or privacy.

    -Notwithstanding the above, using this IS does not constitute consent to
PM, LE or CI investigative searching or monitoring of the content of privileged
communications, or work product, related to personal representation or services
by attorneys, psychotherapists, or clergy, and their assistants. Such
communications and work product are private and confidential. See User
Agreement for details.""

    Use the following verbiage for operating systems that have severe
limitations on the number of characters that can be displayed in the banner:

    ""I've read and consent to terms in IS user agreem't.""","[{""label""=>""default"", ""data""=>""Display of a standardized and approved use notification before\ngranting access to the operating system ensures privacy and security\nnotification verbiage used is consistent with applicable federal laws,\nExecutive Orders, directives, policies, regulations, standards, and guidance.\n\n    System use notifications are required only for access via logon interfaces\nwith human users and are not required when such human interfaces do not exist.\n\n    The banner must be formatted in accordance with applicable DoD policy. Use\nthe following verbiage for operating systems that can accommodate banners of\n1300 characters:\n\n    \""You are accessing a U.S. Government (USG) Information System (IS) that is\nprovided for USG-authorized use only.\n\n    By using this IS (which includes any device attached to this IS), you\nconsent to the following conditions:\n\n    -The USG routinely intercepts and monitors communications on this IS for\npurposes including, but not limited to, penetration testing, COMSEC monitoring,\nnetwork operations and defense, personnel misconduct (PM), law enforcement\n(LE), and counterintelligence (CI) investigations.\n\n    -At any time, the USG may inspect and seize data stored on this IS.\n\n    -Communications using, or data stored on, this IS are not private, are\nsubject to routine monitoring, interception, and search, and may be disclosed\nor used for any USG-authorized purpose.\n\n    -This IS includes security measures (e.g., authentication and access\ncontrols) to protect USG interests--not for your personal benefit or privacy.\n\n    -Notwithstanding the above, using this IS does not constitute consent to\nPM, LE or CI investigative searching or monitoring of the content of privileged\ncommunications, or work product, related to personal representation or services\nby attorneys, psychotherapists, or clergy, and their assistants. Such\ncommunications and work product are private and confidential. See User\nAgreement for details.\""\n\n    Use the following verbiage for operating systems that have severe\nlimitations on the number of characters that can be displayed in the banner:\n\n    \""I've read and consent to terms in IS user agreem't.\""""}]",0.5,[],"",SRG-OS-000023-GPOS-00006,V-89473,SV-100123r1_rule,VRAU-SL-000030,F-96215r2_fix,"[""CCI-000048""]","[""AC-8 a"", ""Rev_4""]","","","","","","","","","","","Check that the SSH daemon is configured for logon warning
banners:

# grep -i banner /etc/ssh/sshd_config | grep -v '#'

If the output does not contain ""Banner /etc/issue"", this is a finding.","To configure the SSH daemon for the logon warning banners, modify
/etc/ssh/sshd_config with the following command:

# sed -i ""/^[^#]*Banner/ c\Banner /etc/issue"" /etc/ssh/sshd_config

The SSH service will need to be restarted after the above change has been made
to SSH. This can be done by running the following command:

# service sshd restart","control ""V-89473"" do
  title ""The SLES for vRealize must display the Standard Mandatory DoD Notice
and Consent Banner before granting access via SSH.""
  desc  ""Display of a standardized and approved use notification before
granting access to the operating system ensures privacy and security
notification verbiage used is consistent with applicable federal laws,
Executive Orders, directives, policies, regulations, standards, and guidance.

    System use notifications are required only for access via logon interfaces
with human users and are not required when such human interfaces do not exist.

    The banner must be formatted in accordance with applicable DoD policy. Use
the following verbiage for operating systems that can accommodate banners of
1300 characters:

    \""You are accessing a U.S. Government (USG) Information System (IS) that is
provided for USG-authorized use only.

    By using this IS (which includes any device attached to this IS), you
consent to the following conditions:

    -The USG routinely intercepts and monitors communications on this IS for
purposes including, but not limited to, penetration testing, COMSEC monitoring,
network operations and defense, personnel misconduct (PM), law enforcement
(LE), and counterintelligence (CI) investigations.

    -At any time, the USG may inspect and seize data stored on this IS.

    -Communications using, or data stored on, this IS are not private, are
subject to routine monitoring, interception, and search, and may be disclosed
or used for any USG-authorized purpose.

    -This IS includes security measures (e.g., authentication and access
controls) to protect USG interests--not for your personal benefit or privacy.

    -Notwithstanding the above, using this IS does not constitute consent to
PM, LE or CI investigative searching or monitoring of the content of privileged
communications, or work product, related to personal representation or services
by attorneys, psychotherapists, or clergy, and their assistants. Such
communications and work product are private and confidential. See User
Agreement for details.\""

    Use the following verbiage for operating systems that have severe
limitations on the number of characters that can be displayed in the banner:

    \""I've read and consent to terms in IS user agreem't.\""
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000023-GPOS-00006""
  tag ""gid"": ""V-89473""
  tag ""rid"": ""SV-100123r1_rule""
  tag ""stig_id"": ""VRAU-SL-000030""
  tag ""fix_id"": ""F-96215r2_fix""
  tag ""cci"": [""CCI-000048""]
  tag ""nist"": [""AC-8 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check that the SSH daemon is configured for logon warning
banners:

# grep -i banner /etc/ssh/sshd_config | grep -v '#'

If the output does not contain \""Banner /etc/issue\"", this is a finding.""
  tag ""fix"": ""To configure the SSH daemon for the logon warning banners, modify
/etc/ssh/sshd_config with the following command:

# sed -i \""/^[^#]*Banner/ c\\Banner /etc/issue\"" /etc/ssh/sshd_config

The SSH service will need to be restarted after the above change has been made
to SSH. This can be done by running the following command:

# service sshd restart""

describe sshd_config do
    its('Banner') { should cmp '/etc/issue' }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89473.rb""}",passed,"SSHD Configuration Banner should cmp == ""/etc/issue""",0.0008024,2019-08-01T08:47:25-07:00,""
V-89475,"The SLES for vRealize must limit the number of concurrent sessions to
10 for all accounts and/or account types.","Operating system management includes the ability to control the number
of users and user sessions that utilize an operating system. Limiting the
number of allowed users and sessions per user is helpful in reducing the risks
related to DoS attacks.

    This requirement addresses concurrent sessions for information system
accounts and does not address concurrent sessions by single users via multiple
system accounts. The maximum number of concurrent sessions should be defined
based upon mission needs and the operational environment for each system.","[{""label""=>""default"", ""data""=>""Operating system management includes the ability to control the number\nof users and user sessions that utilize an operating system. Limiting the\nnumber of allowed users and sessions per user is helpful in reducing the risks\nrelated to DoS attacks.\n\n    This requirement addresses concurrent sessions for information system\naccounts and does not address concurrent sessions by single users via multiple\nsystem accounts. The maximum number of concurrent sessions should be defined\nbased upon mission needs and the operational environment for each system.""}]",0.3,[],"",SRG-OS-000027-GPOS-00008,V-89475,SV-100125r1_rule,VRAU-SL-000040,F-96217r2_fix,"[""CCI-000054""]","[""AC-10"", ""Rev_4""]","","","","","","","","","","","Verify the SLES for vRealize limits the number of concurrent
sessions to ""10"" for all accounts and/or account types with the following
command:

# grep maxlogins /etc/security/limits.conf  | grep -v '#'

The default maxlimits should be set to a max of ""10"" or a documented site
defined number:

*              hard    maxlogins      10

If no such line exists, this is a finding.","Configure the SLES for vRealize to limit the number of concurrent
sessions to ""10"" for all accounts and/or account types by using the following
command.

sed -i 's/\(^* *hard *maxlogins\).*/*              hard    maxlogins
10/g' /etc/security/limits.conf","control ""V-89475"" do
  title ""The SLES for vRealize must limit the number of concurrent sessions to
10 for all accounts and/or account types.""
  desc  ""Operating system management includes the ability to control the number
of users and user sessions that utilize an operating system. Limiting the
number of allowed users and sessions per user is helpful in reducing the risks
related to DoS attacks.

    This requirement addresses concurrent sessions for information system
accounts and does not address concurrent sessions by single users via multiple
system accounts. The maximum number of concurrent sessions should be defined
based upon mission needs and the operational environment for each system.
  ""
  impact 0.3
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000027-GPOS-00008""
  tag ""gid"": ""V-89475""
  tag ""rid"": ""SV-100125r1_rule""
  tag ""stig_id"": ""VRAU-SL-000040""
  tag ""fix_id"": ""F-96217r2_fix""
  tag ""cci"": [""CCI-000054""]
  tag ""nist"": [""AC-10"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the SLES for vRealize limits the number of concurrent
sessions to \""10\"" for all accounts and/or account types with the following
command:

# grep maxlogins /etc/security/limits.conf  | grep -v '#'

The default maxlimits should be set to a max of \""10\"" or a documented site
defined number:

*              hard    maxlogins      10

If no such line exists, this is a finding.""
  tag ""fix"": ""Configure the SLES for vRealize to limit the number of concurrent
sessions to \""10\"" for all accounts and/or account types by using the following
command.

sed -i 's/\\(^* *hard *maxlogins\\).*/*              hard    maxlogins
10/g' /etc/security/limits.conf""

  describe limits_conf('/etc/security/limits.conf') do
    its('*') { should include ['hard', 'maxlogins', '10'] }
  end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89475.rb""}",passed,"limits.conf * should include [""hard"", ""maxlogins"", ""10""]",0.0095174,2019-08-01T08:47:25-07:00,""
V-89477,"The SLES for vRealize must initiate a session lock after a 15-minute
period of inactivity for all connection types.","A session time-out lock is a temporary action taken when a user stops
work and moves away from the immediate physical vicinity of the information
system but does not log out because of the temporary nature of the absence.
Rather than relying on the user to manually lock their operating system session
prior to vacating the vicinity, operating systems need to be able to identify
when a user's session has idled and take action to initiate the session lock.

    The session lock is implemented at the point where session activity can be
determined and/or controlled.","[{""label""=>""default"", ""data""=>""A session time-out lock is a temporary action taken when a user stops\nwork and moves away from the immediate physical vicinity of the information\nsystem but does not log out because of the temporary nature of the absence.\nRather than relying on the user to manually lock their operating system session\nprior to vacating the vicinity, operating systems need to be able to identify\nwhen a user's session has idled and take action to initiate the session lock.\n\n    The session lock is implemented at the point where session activity can be\ndetermined and/or controlled.""}]",0.5,[],",
",SRG-OS-000029-GPOS-00010,V-89477,SV-100127r1_rule,VRAU-SL-000050,F-96219r1_fix,"[""CCI-000057""]","[""AC-11 a"", ""Rev_4""]",",
",",
",",
",",
",",
",",
",",
",",
",",
",",
","Check for the existence of the /etc/profile.d/tmout.sh file:

# ls -al /etc/profile.d/tmout.sh

Check for the presence of the TMOUT variable:

# grep TMOUT /etc/profile.d/tmout.sh

The value of TMOUT should be set to ""900"" seconds (15 minutes).

If the file does not exist, or the TMOUT variable is not set, this is a
finding.","Ensure the file exists and is owned by ""root"". If the file does
not exist, use the following commands to create the file:

# touch /etc/profile.d/tmout.sh
# chown root:root /etc/profile.d/tmout.sh
# chmod 644 /etc/profile.d/tmout.sh

Edit the file ""/etc/profile.d/tmout.sh"" and add the following lines:

TMOUT=900
readonly TMOUT
export TMOUT
mesg n 2>/dev/null","control ""V-89477"" do
  title ""The SLES for vRealize must initiate a session lock after a 15-minute
period of inactivity for all connection types.""
  desc  ""A session time-out lock is a temporary action taken when a user stops
work and moves away from the immediate physical vicinity of the information
system but does not log out because of the temporary nature of the absence.
Rather than relying on the user to manually lock their operating system session
prior to vacating the vicinity, operating systems need to be able to identify
when a user's session has idled and take action to initiate the session lock.

    The session lock is implemented at the point where session activity can be
determined and/or controlled.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000029-GPOS-00010""
  tag ""gid"": ""V-89477""
  tag ""rid"": ""SV-100127r1_rule""
  tag ""stig_id"": ""VRAU-SL-000050""
  tag ""fix_id"": ""F-96219r1_fix""
  tag ""cci"": [""CCI-000057""]
  tag ""nist"": [""AC-11 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check for the existence of the /etc/profile.d/tmout.sh file:

# ls -al /etc/profile.d/tmout.sh

Check for the presence of the TMOUT variable:

# grep TMOUT /etc/profile.d/tmout.sh

The value of TMOUT should be set to \""900\"" seconds (15 minutes).

If the file does not exist, or the TMOUT variable is not set, this is a
finding.""
  tag ""fix"": ""Ensure the file exists and is owned by \""root\"". If the file does
not exist, use the following commands to create the file:

# touch /etc/profile.d/tmout.sh
# chown root:root /etc/profile.d/tmout.sh
# chmod 644 /etc/profile.d/tmout.sh

Edit the file \""/etc/profile.d/tmout.sh\"" and add the following lines:

TMOUT=900
readonly TMOUT
export TMOUT
mesg n 2>/dev/null""

  describe file('/etc/profile.d/tmout.sh') do
    it { should exist }
    its('content') { should match %r{TMOUT=900} }
  end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89477.rb""}","passed,
passed","File /etc/profile.d/tmout.sh should exist,
File /etc/profile.d/tmout.sh content should match /TMOUT=900/","0.1294056,
0.1429479","2019-08-01T08:47:25-07:00,
2019-08-01T08:47:25-07:00",",
"
V-89479,"The SLES for vRealize must initiate a session lock after a 15-minute
period of inactivity for an SSH connection.","A session time-out lock is a temporary action taken when a user stops
work and moves away from the immediate physical vicinity of the information
system but does not log out because of the temporary nature of the absence.
Rather than relying on the user to manually lock their operating system session
prior to vacating the vicinity, operating systems need to be able to identify
when a user's session has idled and take action to initiate the session lock.

    The session lock is implemented at the point where session activity can be
determined and/or controlled.","[{""label""=>""default"", ""data""=>""A session time-out lock is a temporary action taken when a user stops\nwork and moves away from the immediate physical vicinity of the information\nsystem but does not log out because of the temporary nature of the absence.\nRather than relying on the user to manually lock their operating system session\nprior to vacating the vicinity, operating systems need to be able to identify\nwhen a user's session has idled and take action to initiate the session lock.\n\n    The session lock is implemented at the point where session activity can be\ndetermined and/or controlled.""}]",0.5,[],",
",SRG-OS-000029-GPOS-00010,V-89479,SV-100129r1_rule,VRAU-SL-000055,F-96221r1_fix,"[""CCI-000057""]","[""AC-11 a"", ""Rev_4""]",",
",",
",",
",",
",",
",",
",",
",",
",",
",",
","Verify the SLES for vRealize initiates a session lock after a
15-minute period of inactivity for SSH.

Execute the following command:

# grep ClientAliveInterval /etc/ssh/sshd_config; grep  ClientAliveCountMax
/etc/ssh/sshd_config

Verify the following result:

ClientAliveInterval 900
ClientAliveCountMax 0

If this is not set, this is a finding.","Configure the SLES for vRealize to initiate a session lock after
a 15-minute period of inactivity for SSH.

Set the session lock after a 15-minute period by executing the following
command:

# sed -i 's/^.*\bClientAliveInterval\b.*$/ClientAliveInterval 900/'
/etc/ssh/sshd_config; sed -i
's/^.*\bClientAliveCountMax\b.*$/ClientAliveCountMax 0/' /etc/ssh/sshd_config","control ""V-89479"" do
  title ""The SLES for vRealize must initiate a session lock after a 15-minute
period of inactivity for an SSH connection.""
  desc  ""A session time-out lock is a temporary action taken when a user stops
work and moves away from the immediate physical vicinity of the information
system but does not log out because of the temporary nature of the absence.
Rather than relying on the user to manually lock their operating system session
prior to vacating the vicinity, operating systems need to be able to identify
when a user's session has idled and take action to initiate the session lock.

    The session lock is implemented at the point where session activity can be
determined and/or controlled.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000029-GPOS-00010""
  tag ""gid"": ""V-89479""
  tag ""rid"": ""SV-100129r1_rule""
  tag ""stig_id"": ""VRAU-SL-000055""
  tag ""fix_id"": ""F-96221r1_fix""
  tag ""cci"": [""CCI-000057""]
  tag ""nist"": [""AC-11 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the SLES for vRealize initiates a session lock after a
15-minute period of inactivity for SSH.

Execute the following command:

# grep ClientAliveInterval /etc/ssh/sshd_config; grep  ClientAliveCountMax
/etc/ssh/sshd_config

Verify the following result:

ClientAliveInterval 900
ClientAliveCountMax 0

If this is not set, this is a finding.""
  tag ""fix"": ""Configure the SLES for vRealize to initiate a session lock after
a 15-minute period of inactivity for SSH.

Set the session lock after a 15-minute period by executing the following
command:

# sed -i 's/^.*\\bClientAliveInterval\\b.*$/ClientAliveInterval 900/'
/etc/ssh/sshd_config; sed -i
's/^.*\\bClientAliveCountMax\\b.*$/ClientAliveCountMax 0/' /etc/ssh/sshd_config""

describe sshd_config do
  its('ClientAliveInterval') { should cmp 900 }
  its('ClientAliveCountMax') { should cmp 0 }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89479.rb""}","passed,
passed","SSHD Configuration ClientAliveInterval should cmp == 900,
SSHD Configuration ClientAliveCountMax should cmp == 0","0.0227157,
0.0002486","2019-08-01T08:47:25-07:00,
2019-08-01T08:47:25-07:00",",
"
V-89481,The SLES for vRealize must monitor remote access methods - SSH Daemon.,"Remote access services, such as those providing remote access to
network devices and information systems, which lack automated monitoring
capabilities, increase risk and make remote user access management difficult at
best.

    Remote access is access to DoD nonpublic information systems by an
authorized user (or an information system) communicating through an external,
non-organization-controlled network. Remote access methods include, for
example, dial-up, broadband, and wireless.

    Automated monitoring of remote access sessions allows organizations to
detect cyber attacks and also ensure ongoing compliance with remote access
policies by auditing connection activities of remote access capabilities, such
as Remote Desktop Protocol (RDP), on a variety of information system components
(e.g., servers, workstations, notebook computers, smartphones, and tablets).","[{""label""=>""default"", ""data""=>""Remote access services, such as those providing remote access to\nnetwork devices and information systems, which lack automated monitoring\ncapabilities, increase risk and make remote user access management difficult at\nbest.\n\n    Remote access is access to DoD nonpublic information systems by an\nauthorized user (or an information system) communicating through an external,\nnon-organization-controlled network. Remote access methods include, for\nexample, dial-up, broadband, and wireless.\n\n    Automated monitoring of remote access sessions allows organizations to\ndetect cyber attacks and also ensure ongoing compliance with remote access\npolicies by auditing connection activities of remote access capabilities, such\nas Remote Desktop Protocol (RDP), on a variety of information system components\n(e.g., servers, workstations, notebook computers, smartphones, and tablets).""}]",0.5,[],"",SRG-OS-000032-GPOS-00013,V-89481,SV-100131r1_rule,VRAU-SL-000070,F-96223r1_fix,"[""CCI-000067""]","[""AC-17 (1)"", ""Rev_4""]","","","","","","","","","","","Verify that SSH is configured to verbosely log connection
attempts and failed logon attempts to the server by running the following
command:

# grep LogLevel /etc/ssh/sshd_config  | grep -v '#'

The output message must contain the following text:

LogLevel VERBOSE

If it is not set to ""VERBOSE"", this is a finding.","To configure SSH to verbosely log connection attempts and failed
logon attempts to the server, run the following command:

# sed -i 's/^.*\bLogLevel\b.*$/LogLevel VERBOSE/' /etc/ssh/sshd_config

The SSH service will need to be restarted after the above change has been made
to SSH. This can be done by running the following command:

# service sshd restart","control ""V-89481"" do
  title ""The SLES for vRealize must monitor remote access methods - SSH Daemon.""
  desc  ""Remote access services, such as those providing remote access to
network devices and information systems, which lack automated monitoring
capabilities, increase risk and make remote user access management difficult at
best.

    Remote access is access to DoD nonpublic information systems by an
authorized user (or an information system) communicating through an external,
non-organization-controlled network. Remote access methods include, for
example, dial-up, broadband, and wireless.

    Automated monitoring of remote access sessions allows organizations to
detect cyber attacks and also ensure ongoing compliance with remote access
policies by auditing connection activities of remote access capabilities, such
as Remote Desktop Protocol (RDP), on a variety of information system components
(e.g., servers, workstations, notebook computers, smartphones, and tablets).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000032-GPOS-00013""
  tag ""gid"": ""V-89481""
  tag ""rid"": ""SV-100131r1_rule""
  tag ""stig_id"": ""VRAU-SL-000070""
  tag ""fix_id"": ""F-96223r1_fix""
  tag ""cci"": [""CCI-000067""]
  tag ""nist"": [""AC-17 (1)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that SSH is configured to verbosely log connection
attempts and failed logon attempts to the server by running the following
command:

# grep LogLevel /etc/ssh/sshd_config  | grep -v '#'

The output message must contain the following text:

LogLevel VERBOSE

If it is not set to \""VERBOSE\"", this is a finding.""
  tag ""fix"": ""To configure SSH to verbosely log connection attempts and failed
logon attempts to the server, run the following command:

# sed -i 's/^.*\\bLogLevel\\b.*$/LogLevel VERBOSE/' /etc/ssh/sshd_config

The SSH service will need to be restarted after the above change has been made
to SSH. This can be done by running the following command:

# service sshd restart""

describe sshd_config do
  its('LogLevel') { should cmp 'VERBOSE' }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89481.rb""}",passed,"SSHD Configuration LogLevel should cmp == ""VERBOSE""",0.0008146,2019-08-01T08:47:25-07:00,""
V-89483,"The SLES for vRealize must implement DoD-approved encryption to
protect the confidentiality of remote access sessions- SSH Daemon.","Without confidentiality protection mechanisms, unauthorized
individuals may gain access to sensitive information via a remote access
session.

    Remote access is access to DoD nonpublic information systems by an
authorized user (or an information system) communicating through an external,
non-organization-controlled network. Remote access methods include, for
example, dial-up, broadband, and wireless.

    Encryption provides a means to secure the remote connection to prevent
unauthorized access to the data traversing the remote access connection (e.g.,
RDP), thereby providing a degree of confidentiality. The encryption strength of
a mechanism is selected based on the security categorization of the information.","[{""label""=>""default"", ""data""=>""Without confidentiality protection mechanisms, unauthorized\nindividuals may gain access to sensitive information via a remote access\nsession.\n\n    Remote access is access to DoD nonpublic information systems by an\nauthorized user (or an information system) communicating through an external,\nnon-organization-controlled network. Remote access methods include, for\nexample, dial-up, broadband, and wireless.\n\n    Encryption provides a means to secure the remote connection to prevent\nunauthorized access to the data traversing the remote access connection (e.g.,\nRDP), thereby providing a degree of confidentiality. The encryption strength of\na mechanism is selected based on the security categorization of the information.""}]",0.5,[],"",SRG-OS-000033-GPOS-00014,V-89483,SV-100133r1_rule,VRAU-SL-000075,F-96225r2_fix,"[""CCI-000068""]","[""AC-17 (2)"", ""Rev_4""]","","","","","","","","","","","Check the SSH daemon configuration for DoD-approved encryption
to protect the confidentiality of SSH remote connections by performing the
following commands:

Check the ""Ciphers"" setting in the ""sshd_config"" file.

# grep -i Ciphers /etc/ssh/sshd_config  | grep -v '#'

The output must contain either nothing or any number of the following
algorithms:

aes128-ctr, aes256-ctr.

If the output contains an algorithm not listed above, this is a finding.

Expected Output:
Ciphers aes256-ctr,aes128-ctr","Update the Ciphers directive with the following command:

# sed -i ""/^[^#]*Ciphers/ c\Ciphers aes256-ctr,aes128-ctr""
/etc/ssh/sshd_config

Save and close the file.

Restart the sshd process:

# service sshd restart","control ""V-89483"" do
  title ""The SLES for vRealize must implement DoD-approved encryption to
protect the confidentiality of remote access sessions- SSH Daemon.""
  desc  ""Without confidentiality protection mechanisms, unauthorized
individuals may gain access to sensitive information via a remote access
session.

    Remote access is access to DoD nonpublic information systems by an
authorized user (or an information system) communicating through an external,
non-organization-controlled network. Remote access methods include, for
example, dial-up, broadband, and wireless.

    Encryption provides a means to secure the remote connection to prevent
unauthorized access to the data traversing the remote access connection (e.g.,
RDP), thereby providing a degree of confidentiality. The encryption strength of
a mechanism is selected based on the security categorization of the information.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000033-GPOS-00014""
  tag ""gid"": ""V-89483""
  tag ""rid"": ""SV-100133r1_rule""
  tag ""stig_id"": ""VRAU-SL-000075""
  tag ""fix_id"": ""F-96225r2_fix""
  tag ""cci"": [""CCI-000068""]
  tag ""nist"": [""AC-17 (2)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the SSH daemon configuration for DoD-approved encryption
to protect the confidentiality of SSH remote connections by performing the
following commands:

Check the \""Ciphers\"" setting in the \""sshd_config\"" file.

# grep -i Ciphers /etc/ssh/sshd_config  | grep -v '#'

The output must contain either nothing or any number of the following
algorithms:

aes128-ctr, aes256-ctr.

If the output contains an algorithm not listed above, this is a finding.

Expected Output:
Ciphers aes256-ctr,aes128-ctr""
  tag ""fix"": ""Update the Ciphers directive with the following command:

# sed -i \""/^[^#]*Ciphers/ c\\Ciphers aes256-ctr,aes128-ctr\""
/etc/ssh/sshd_config

Save and close the file.

Restart the sshd process:

# service sshd restart""

describe sshd_config do
  its('Ciphers') { should cmp 'aes256-ctr,aes128-ctr' }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89483.rb""}",passed,"SSHD Configuration Ciphers should cmp == ""aes256-ctr,aes128-ctr""",0.0007596,2019-08-01T08:47:25-07:00,""
V-89485,"The SLES for vRealize must implement DoD-approved encryption to
protect the confidentiality of remote access sessions - SSH Client.","Without confidentiality protection mechanisms, unauthorized
individuals may gain access to sensitive information via a remote access
session.

    Remote access is access to DoD nonpublic information systems by an
authorized user (or an information system) communicating through an external,
non-organization-controlled network. Remote access methods include, for
example, dial-up, broadband, and wireless.

    Encryption provides a means to secure the remote connection to prevent
unauthorized access to the data traversing the remote access connection (e.g.,
RDP), thereby providing a degree of confidentiality. The encryption strength of
a mechanism is selected based on the security categorization of the information.","[{""label""=>""default"", ""data""=>""Without confidentiality protection mechanisms, unauthorized\nindividuals may gain access to sensitive information via a remote access\nsession.\n\n    Remote access is access to DoD nonpublic information systems by an\nauthorized user (or an information system) communicating through an external,\nnon-organization-controlled network. Remote access methods include, for\nexample, dial-up, broadband, and wireless.\n\n    Encryption provides a means to secure the remote connection to prevent\nunauthorized access to the data traversing the remote access connection (e.g.,\nRDP), thereby providing a degree of confidentiality. The encryption strength of\na mechanism is selected based on the security categorization of the information.""}]",0.5,[],"",SRG-OS-000033-GPOS-00014,V-89485,SV-100135r1_rule,VRAU-SL-000080,F-96227r2_fix,"[""CCI-000068""]","[""AC-17 (2)"", ""Rev_4""]","","","","","","","","","","","Check the SSH daemon configuration for DoD-approved encryption
to protect the confidentiality of SSH remote connections by performing the
following commands:

Check the ""Ciphers"" setting in the ""ssh_config"" file.

# grep -i Ciphers /etc/ssh/ssh_config  | grep -v '#'

The output must contain either nothing or any number of the following
algorithms:

aes128-ctr, aes256-ctr.

If the output contains an algorithm not listed above, this is a finding.

Expected Output:
Ciphers aes256-ctr,aes128-ctr","Update the ""Ciphers"" directive with the following command:

# sed -i ""/^[^#]*Ciphers/ c\Ciphers aes256-ctr,aes128-ctr""
/etc/ssh/ssh_config

Save and close the file.","control ""V-89485"" do
  title ""The SLES for vRealize must implement DoD-approved encryption to
protect the confidentiality of remote access sessions - SSH Client.""
  desc  ""Without confidentiality protection mechanisms, unauthorized
individuals may gain access to sensitive information via a remote access
session.

    Remote access is access to DoD nonpublic information systems by an
authorized user (or an information system) communicating through an external,
non-organization-controlled network. Remote access methods include, for
example, dial-up, broadband, and wireless.

    Encryption provides a means to secure the remote connection to prevent
unauthorized access to the data traversing the remote access connection (e.g.,
RDP), thereby providing a degree of confidentiality. The encryption strength of
a mechanism is selected based on the security categorization of the information.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000033-GPOS-00014""
  tag ""gid"": ""V-89485""
  tag ""rid"": ""SV-100135r1_rule""
  tag ""stig_id"": ""VRAU-SL-000080""
  tag ""fix_id"": ""F-96227r2_fix""
  tag ""cci"": [""CCI-000068""]
  tag ""nist"": [""AC-17 (2)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the SSH daemon configuration for DoD-approved encryption
to protect the confidentiality of SSH remote connections by performing the
following commands:

Check the \""Ciphers\"" setting in the \""ssh_config\"" file.

# grep -i Ciphers /etc/ssh/ssh_config  | grep -v '#'

The output must contain either nothing or any number of the following
algorithms:

aes128-ctr, aes256-ctr.

If the output contains an algorithm not listed above, this is a finding.

Expected Output:
Ciphers aes256-ctr,aes128-ctr""
  tag ""fix"": ""Update the \""Ciphers\"" directive with the following command:

# sed -i \""/^[^#]*Ciphers/ c\\Ciphers aes256-ctr,aes128-ctr\""
/etc/ssh/ssh_config

Save and close the file.""

describe ssh_config do
  its('Ciphers') { should cmp 'aes256-ctr,aes128-ctr' }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89485.rb""}",passed,"SSH Configuration Ciphers should cmp == ""aes256-ctr,aes128-ctr""",0.0004619,2019-08-01T08:47:25-07:00,""
V-89487,The SLES for vRealize must produce audit records.,"Without establishing what type of events occurred, it would be
difficult to establish, correlate, and investigate the events leading up to an
outage or attack.

    Audit record content that may be necessary to satisfy this requirement
includes, for example, time stamps, source and destination addresses,
user/process identifiers, event descriptions, success/fail indications,
filenames involved, and access control or flow control rules invoked.

    Associating event types with detected events in the operating system audit
logs provides a means of investigating an attack; recognizing resource
utilization or capacity thresholds; or identifying an improperly configured
operating system.","[{""label""=>""default"", ""data""=>""Without establishing what type of events occurred, it would be\ndifficult to establish, correlate, and investigate the events leading up to an\noutage or attack.\n\n    Audit record content that may be necessary to satisfy this requirement\nincludes, for example, time stamps, source and destination addresses,\nuser/process identifiers, event descriptions, success/fail indications,\nfilenames involved, and access control or flow control rules invoked.\n\n    Associating event types with detected events in the operating system audit\nlogs provides a means of investigating an attack; recognizing resource\nutilization or capacity thresholds; or identifying an improperly configured\noperating system.""}]",0.5,[],",
,
",SRG-OS-000037-GPOS-00015,V-89487,SV-100137r1_rule,VRAU-SL-000085,F-96229r1_fix,"[""CCI-000130""]","[""AU-3"", ""Rev_4""]",",
,
",",
,
",",
,
",",
,
",",
,
",",
,
",",
,
",",
,
",",
,
",",
,
","Verify the SLES for vRealize produces audit records by running
the following command to determine the current status of the ""auditd"" service:

# service auditd status

If the service is enabled, the returned message must contain the following text:

Checking for service auditd                running

If the service is not running, this is a finding.","Enable the ""auditd"" service by performing the following
commands:

# chkconfig auditd on
# service auditd start","control ""V-89487"" do
  title ""The SLES for vRealize must produce audit records.""
  desc  ""Without establishing what type of events occurred, it would be
difficult to establish, correlate, and investigate the events leading up to an
outage or attack.

    Audit record content that may be necessary to satisfy this requirement
includes, for example, time stamps, source and destination addresses,
user/process identifiers, event descriptions, success/fail indications,
filenames involved, and access control or flow control rules invoked.

    Associating event types with detected events in the operating system audit
logs provides a means of investigating an attack; recognizing resource
utilization or capacity thresholds; or identifying an improperly configured
operating system.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000037-GPOS-00015""
  tag ""gid"": ""V-89487""
  tag ""rid"": ""SV-100137r1_rule""
  tag ""stig_id"": ""VRAU-SL-000085""
  tag ""fix_id"": ""F-96229r1_fix""
  tag ""cci"": [""CCI-000130""]
  tag ""nist"": [""AU-3"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the SLES for vRealize produces audit records by running
the following command to determine the current status of the \""auditd\"" service:

# service auditd status

If the service is enabled, the returned message must contain the following text:

Checking for service auditd                running

If the service is not running, this is a finding.""
  tag ""fix"": ""Enable the \""auditd\"" service by performing the following
commands:

# chkconfig auditd on
# service auditd start""

describe service('auditd') do
  it { should be_installed }
  it { should be_enabled }
  it { should be_running }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89487.rb""}","passed,
passed,
passed","Service auditd should be installed,
Service auditd should be enabled,
Service auditd should be running","0.4384853,
0.0002153,
0.0031798","2019-08-01T08:47:25-07:00,
2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00",",
,
"
V-89489,"The SLES for vRealize must alert the ISSO and SA (at a minimum) in the
event of an audit processing failure.","It is critical for the appropriate personnel to be aware if a system
is at risk of failing to process audit logs as required. Without this
notification, the security personnel may be unaware of an impending failure of
the audit capability, and system operation may be adversely affected.

    Audit processing failures include software/hardware errors, failures in the
audit capturing mechanisms, and audit storage capacity being reached or
exceeded.

    This requirement applies to each audit data storage repository (i.e.,
distinct information system component where audit records are stored), the
centralized audit storage capacity of organizations (i.e., all audit data
storage repositories combined), or both.","[{""label""=>""default"", ""data""=>""It is critical for the appropriate personnel to be aware if a system\nis at risk of failing to process audit logs as required. Without this\nnotification, the security personnel may be unaware of an impending failure of\nthe audit capability, and system operation may be adversely affected.\n\n    Audit processing failures include software/hardware errors, failures in the\naudit capturing mechanisms, and audit storage capacity being reached or\nexceeded.\n\n    This requirement applies to each audit data storage repository (i.e.,\ndistinct information system component where audit records are stored), the\ncentralized audit storage capacity of organizations (i.e., all audit data\nstorage repositories combined), or both.""}]",0.5,[],",
,
,
,
,
",SRG-OS-000046-GPOS-00022,V-89489,SV-100139r1_rule,VRAU-SL-000125,F-96231r1_fix,"[""CCI-000139""]","[""AU-5 a"", ""Rev_4""]",",
,
,
,
,
",",
,
,
,
,
",",
,
,
,
,
",",
,
,
,
,
",",
,
,
,
,
",",
,
,
,
,
",",
,
,
,
,
",",
,
,
,
,
",",
,
,
,
,
",",
,
,
,
,
","Check /etc/audit/auditd.conf for the space_left_action with the
following command:

# cat /etc/audit/auditd.conf | grep space_left_action

If the ""space_left_action"" parameter is missing; is set to ""ignore"",
""suspend"", ""single"", or ""halt""; or is blank, this is a finding.

Expected Result:
space_left_action = SYSLOG

NOTES:

If the ""space_left_action"" is set to ""exec"", the system executes a
designated script.

If this script informs the SA of the event, this is not a finding.

If the ""space_left_action"" is set to ""email"" and the ""action_mail_acct""
parameter is not set to the email address of the system administrator, this is
a finding.

The ""action_mail_acct"" parameter, if missing, defaults to ""root"". Note that
if the email address of the system administrator is on a remote system,
""sendmail"" must be available.","Set the space_left_action parameter to the valid setting
""SYSLOG"" by running the following command:

# sed -i ""/^[^#]*space_left_action/ c\space_left_action = SYSLOG""
/etc/audit/auditd.conf

Restart the audit service:
# service auditd restart","control ""V-89489"" do
  title ""The SLES for vRealize must alert the ISSO and SA (at a minimum) in the
event of an audit processing failure.""
  desc  ""It is critical for the appropriate personnel to be aware if a system
is at risk of failing to process audit logs as required. Without this
notification, the security personnel may be unaware of an impending failure of
the audit capability, and system operation may be adversely affected.

    Audit processing failures include software/hardware errors, failures in the
audit capturing mechanisms, and audit storage capacity being reached or
exceeded.

    This requirement applies to each audit data storage repository (i.e.,
distinct information system component where audit records are stored), the
centralized audit storage capacity of organizations (i.e., all audit data
storage repositories combined), or both.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000046-GPOS-00022""
  tag ""gid"": ""V-89489""
  tag ""rid"": ""SV-100139r1_rule""
  tag ""stig_id"": ""VRAU-SL-000125""
  tag ""fix_id"": ""F-96231r1_fix""
  tag ""cci"": [""CCI-000139""]
  tag ""nist"": [""AU-5 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check /etc/audit/auditd.conf for the space_left_action with the
following command:

# cat /etc/audit/auditd.conf | grep space_left_action

If the \""space_left_action\"" parameter is missing; is set to \""ignore\"",
\""suspend\"", \""single\"", or \""halt\""; or is blank, this is a finding.

Expected Result:
space_left_action = SYSLOG

NOTES:

If the \""space_left_action\"" is set to \""exec\"", the system executes a
designated script.

If this script informs the SA of the event, this is not a finding.

If the \""space_left_action\"" is set to \""email\"" and the \""action_mail_acct\""
parameter is not set to the email address of the system administrator, this is
a finding.

The \""action_mail_acct\"" parameter, if missing, defaults to \""root\"". Note that
if the email address of the system administrator is on a remote system,
\""sendmail\"" must be available.""
  tag ""fix"": ""Set the space_left_action parameter to the valid setting
\""SYSLOG\"" by running the following command:

# sed -i \""/^[^#]*space_left_action/ c\\space_left_action = SYSLOG\""
/etc/audit/auditd.conf

Restart the audit service:
# service auditd restart""

describe auditd_conf('/etc/audit/auditd.conf') do
  its('space_left_action') { should cmp 'syslog' }
  its('space_left_action') { should_not cmp 'ignore' }
  its('space_left_action') { should_not cmp 'suspend' }
  its('space_left_action') { should_not cmp 'single' }
  its('space_left_action') { should_not cmp 'halt' }
  its('space_left_action') { should_not cmp '' }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89489.rb""}","passed,
passed,
passed,
passed,
passed,
passed","Audit Daemon Config space_left_action should cmp == ""syslog"",
Audit Daemon Config space_left_action should not cmp == ""ignore"",
Audit Daemon Config space_left_action should not cmp == ""suspend"",
Audit Daemon Config space_left_action should not cmp == ""single"",
Audit Daemon Config space_left_action should not cmp == ""halt"",
Audit Daemon Config space_left_action should not cmp == """"","0.0004321,
0.0002019,
0.0001928,
0.0001936,
0.0002266,
0.0003909","2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00",",
,
,
,
,
"
V-89491,"The SLES for vRealize must shut down by default upon audit failure
(unless availability is an overriding concern).","It is critical that when the operating system is at risk of failing to
process audit logs as required, it takes action to mitigate the failure. Audit
processing failures include: software/hardware errors; failures in the audit
capturing mechanisms; and audit storage capacity being reached or exceeded.
Responses to audit failure depend upon the nature of the failure mode.

    When availability is an overriding concern, other approved actions in
response to an audit failure are as follows:

    1) If the failure was caused by the lack of audit record storage capacity,
the operating system must continue generating audit records if possible
(automatically restarting the audit service if necessary), overwriting the
oldest audit records in a first-in-first-out manner.

    2) If audit records are sent to a centralized collection server and
communication with this server is lost or the server fails, the operating
system must queue audit records locally until communication is restored or
until the audit records are retrieved manually. Upon restoration of the
connection to the centralized collection server, action should be taken to
synchronize the local audit data with the collection server.","[{""label""=>""default"", ""data""=>""It is critical that when the operating system is at risk of failing to\nprocess audit logs as required, it takes action to mitigate the failure. Audit\nprocessing failures include: software/hardware errors; failures in the audit\ncapturing mechanisms; and audit storage capacity being reached or exceeded.\nResponses to audit failure depend upon the nature of the failure mode.\n\n    When availability is an overriding concern, other approved actions in\nresponse to an audit failure are as follows:\n\n    1) If the failure was caused by the lack of audit record storage capacity,\nthe operating system must continue generating audit records if possible\n(automatically restarting the audit service if necessary), overwriting the\noldest audit records in a first-in-first-out manner.\n\n    2) If audit records are sent to a centralized collection server and\ncommunication with this server is lost or the server fails, the operating\nsystem must queue audit records locally until communication is restored or\nuntil the audit records are retrieved manually. Upon restoration of the\nconnection to the centralized collection server, action should be taken to\nsynchronize the local audit data with the collection server.""}]",0.5,[],",
,
,
,
,
,
,
,
,
,
,
",SRG-OS-000047-GPOS-00023,V-89491,SV-100141r1_rule,VRAU-SL-000130,F-96233r1_fix,"[""CCI-000140""]","[""AU-5 b"", ""Rev_4""]",",
,
,
,
,
,
,
,
,
,
,
",",
,
,
,
,
,
,
,
,
,
,
",",
,
,
,
,
,
,
,
,
,
,
",",
,
,
,
,
,
,
,
,
,
,
",",
,
,
,
,
,
,
,
,
,
,
",",
,
,
,
,
,
,
,
,
,
,
",",
,
,
,
,
,
,
,
,
,
,
",",
,
,
,
,
,
,
,
,
,
,
",",
,
,
,
,
,
,
,
,
,
,
",",
,
,
,
,
,
,
,
,
,
,
","Verify the /etc/audit/auditd.conf has the ""disk_full_action"",
""disk_error_action"", and ""admin_disk_space_left"" parameters set.

# grep disk_full_action /etc/audit/auditd.conf

If the ""disk_full_action"" parameter is missing or set to ""suspend"" or
""ignore"" this is a finding.

# grep disk_error_action /etc/audit/auditd.conf

If the ""disk_error_action"" parameter is missing or set to ""suspend"" or
""ignore"" this is a finding.

# grep admin_space_left_action /etc/audit/auditd.conf

If the ""admin_space_left_action"" parameter is missing or set to ""suspend""
or ""ignore"" this is a finding.","Edit /etc/audit/auditd.conf and set the ""disk_full_action"",
""disk_error_action"", and ""admin_space_left_action"" parameters to ""syslog""
with the following commands:

# sed -i ""/^[^#]*disk_full_action/ c\disk_full_action = SYSLOG""
/etc/audit/auditd.conf
# sed -i ""/^[^#]*disk_error_action/ c\disk_error_action = SYSLOG""
/etc/audit/auditd.conf
# sed -i ""/^[^#]*admin_space_left_action/ c\admin_space_left_action =
SYSLOG"" /etc/audit/auditd.conf

For certain systems, the need for availability outweighs the need to log all
actions, and a different setting should be determined.","control ""V-89491"" do
  title ""The SLES for vRealize must shut down by default upon audit failure
(unless availability is an overriding concern).""
  desc  ""It is critical that when the operating system is at risk of failing to
process audit logs as required, it takes action to mitigate the failure. Audit
processing failures include: software/hardware errors; failures in the audit
capturing mechanisms; and audit storage capacity being reached or exceeded.
Responses to audit failure depend upon the nature of the failure mode.

    When availability is an overriding concern, other approved actions in
response to an audit failure are as follows:

    1) If the failure was caused by the lack of audit record storage capacity,
the operating system must continue generating audit records if possible
(automatically restarting the audit service if necessary), overwriting the
oldest audit records in a first-in-first-out manner.

    2) If audit records are sent to a centralized collection server and
communication with this server is lost or the server fails, the operating
system must queue audit records locally until communication is restored or
until the audit records are retrieved manually. Upon restoration of the
connection to the centralized collection server, action should be taken to
synchronize the local audit data with the collection server.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000047-GPOS-00023""
  tag ""gid"": ""V-89491""
  tag ""rid"": ""SV-100141r1_rule""
  tag ""stig_id"": ""VRAU-SL-000130""
  tag ""fix_id"": ""F-96233r1_fix""
  tag ""cci"": [""CCI-000140""]
  tag ""nist"": [""AU-5 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the /etc/audit/auditd.conf has the \""disk_full_action\"",
\""disk_error_action\"", and \""admin_disk_space_left\"" parameters set.

# grep disk_full_action /etc/audit/auditd.conf

If the \""disk_full_action\"" parameter is missing or set to \""suspend\"" or
\""ignore\"" this is a finding.

# grep disk_error_action /etc/audit/auditd.conf

If the \""disk_error_action\"" parameter is missing or set to \""suspend\"" or
\""ignore\"" this is a finding.

# grep admin_space_left_action /etc/audit/auditd.conf

If the \""admin_space_left_action\"" parameter is missing or set to \""suspend\""
or \""ignore\"" this is a finding.""
  tag ""fix"": ""Edit /etc/audit/auditd.conf and set the \""disk_full_action\"",
\""disk_error_action\"", and \""admin_space_left_action\"" parameters to \""syslog\""
with the following commands:

# sed -i \""/^[^#]*disk_full_action/ c\\disk_full_action = SYSLOG\""
/etc/audit/auditd.conf
# sed -i \""/^[^#]*disk_error_action/ c\\disk_error_action = SYSLOG\""
/etc/audit/auditd.conf
# sed -i \""/^[^#]*admin_space_left_action/ c\\admin_space_left_action =
SYSLOG\"" /etc/audit/auditd.conf

For certain systems, the need for availability outweighs the need to log all
actions, and a different setting should be determined.""

describe auditd_conf('/etc/audit/auditd.conf') do
  #disk_full_action
  its('disk_full_action') { should_not cmp '' }
  its('disk_full_action') { should_not cmp 'suspend' }
  its('disk_full_action') { should_not cmp 'ignore' }
  its('disk_full_action') { should cmp 'syslog' }
  #disk_error_action
  its('disk_error_action') { should_not cmp '' }
  its('disk_error_action') { should_not cmp 'suspend' }
  its('disk_error_action') { should_not cmp 'ignore' }
  its('disk_error_action') { should cmp 'syslog' }
  #admin_space_left_action
  its('admin_space_left_action') { should_not cmp '' }
  its('admin_space_left_action') { should_not cmp 'suspend' }
  its('admin_space_left_action') { should_not cmp 'ignore' }
  its('admin_space_left_action') { should cmp 'syslog' }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89491.rb""}","passed,
passed,
passed,
passed,
passed,
passed,
passed,
passed,
passed,
passed,
passed,
passed","Audit Daemon Config disk_full_action should not cmp == """",
Audit Daemon Config disk_full_action should not cmp == ""suspend"",
Audit Daemon Config disk_full_action should not cmp == ""ignore"",
Audit Daemon Config disk_full_action should cmp == ""syslog"",
Audit Daemon Config disk_error_action should not cmp == """",
Audit Daemon Config disk_error_action should not cmp == ""suspend"",
Audit Daemon Config disk_error_action should not cmp == ""ignore"",
Audit Daemon Config disk_error_action should cmp == ""syslog"",
Audit Daemon Config admin_space_left_action should not cmp == """",
Audit Daemon Config admin_space_left_action should not cmp == ""suspend"",
Audit Daemon Config admin_space_left_action should not cmp == ""ignore"",
Audit Daemon Config admin_space_left_action should cmp == ""syslog""","0.0003876,
0.0001863,
0.0002265,
0.0001921,
0.0001878,
0.0002252,
0.0003381,
0.0001818,
0.0002618,
0.0002464,
0.0002428,
0.0001866","2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00",",
,
,
,
,
,
,
,
,
,
,
"
V-89493,"The SLES for vRealize must protect audit information from unauthorized
read access - ownership.","Unauthorized disclosure of audit records can reveal system and
configuration data to attackers, thus compromising its confidentiality.

    Audit information includes all information (e.g., audit records, audit
settings, audit reports) needed to successfully audit operating system activity.","[{""label""=>""default"", ""data""=>""Unauthorized disclosure of audit records can reveal system and\nconfiguration data to attackers, thus compromising its confidentiality.\n\n    Audit information includes all information (e.g., audit records, audit\nsettings, audit reports) needed to successfully audit operating system activity.""}]",0.5,[],"",SRG-OS-000057-GPOS-00027,V-89493,SV-100143r1_rule,VRAU-SL-000150,F-96235r1_fix,"[""CCI-000162""]","[""AU-9"", ""Rev_4""]","","","","","","","","","","","Verify that the system audit logs are owned by ""root"":

# (audit_log_file=$(grep ""^log_file"" /etc/audit/auditd.conf|sed s/^[^\/]*//)
&& if [ -f ""${audit_log_file}"" ] ; then printf ""Log(s) found in
""${audit_log_file%/*}"":""; ls -l ${audit_log_file%/*}; else printf ""audit log file(s) not found""; fi)

If any audit log file is not owned by ""root"", this is a finding.","Change the ownership of the audit log file(s).

Procedure:
# chown root <audit log file>

# chown root /var/log/audit/audit.log","control ""V-89493"" do
  title ""The SLES for vRealize must protect audit information from unauthorized
read access - ownership.""
  desc  ""Unauthorized disclosure of audit records can reveal system and
configuration data to attackers, thus compromising its confidentiality.

    Audit information includes all information (e.g., audit records, audit
settings, audit reports) needed to successfully audit operating system activity.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000057-GPOS-00027""
  tag ""gid"": ""V-89493""
  tag ""rid"": ""SV-100143r1_rule""
  tag ""stig_id"": ""VRAU-SL-000150""
  tag ""fix_id"": ""F-96235r1_fix""
  tag ""cci"": [""CCI-000162""]
  tag ""nist"": [""AU-9"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that the system audit logs are owned by \""root\"":

# (audit_log_file=$(grep \""^log_file\"" /etc/audit/auditd.conf|sed s/^[^\\/]*//)
&& if [ -f \""${audit_log_file}\"" ] ; then printf \""Log(s) found in
\""${audit_log_file%/*}\"":\
\""; ls -l ${audit_log_file%/*}; else printf \""audit log file(s) not found\
\""; fi)

If any audit log file is not owned by \""root\"", this is a finding.""
  tag ""fix"": ""Change the ownership of the audit log file(s).

Procedure:
# chown root <audit log file>

# chown root /var/log/audit/audit.log""

describe file('/var/log/audit/audit.log') do
  its('owner') { should eq 'root' }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89493.rb""}",passed,"File /var/log/audit/audit.log owner should eq ""root""",0.0001847,2019-08-01T08:47:26-07:00,""
V-89495,"The SLES for vRealize must protect audit information from unauthorized
read access - group-ownership.","Unauthorized disclosure of audit records can reveal system and
configuration data to attackers, thus compromising its confidentiality.

    Audit information includes all information (e.g., audit records, audit
settings, audit reports) needed to successfully audit operating system activity.","[{""label""=>""default"", ""data""=>""Unauthorized disclosure of audit records can reveal system and\nconfiguration data to attackers, thus compromising its confidentiality.\n\n    Audit information includes all information (e.g., audit records, audit\nsettings, audit reports) needed to successfully audit operating system activity.""}]",0.5,[],"",SRG-OS-000057-GPOS-00027,V-89495,SV-100145r1_rule,VRAU-SL-000155,F-96237r1_fix,"[""CCI-000162""]","[""AU-9"", ""Rev_4""]","","","","","","","","","","","Verify that the system audit logs are group-owned by ""root"":

# (audit_log_file=$(grep ""^log_file"" /etc/audit/auditd.conf|sed s/^[^\/]*//)
&& if [ -f ""${audit_log_file}"" ] ; then printf ""Log(s) found in
""${audit_log_file%/*}"":""; ls -l ${audit_log_file%/*}; else printf ""audit log file(s) not found""; fi)

If any audit log file is not group-owned by ""root"" or ""admin"", this is a
finding.","Change the group-ownership of the audit log file(s).

Procedure:
# chgrp root <audit log file>

# chgrp root /var/log/audit/audit.log","control ""V-89495"" do
  title ""The SLES for vRealize must protect audit information from unauthorized
read access - group-ownership.""
  desc  ""Unauthorized disclosure of audit records can reveal system and
configuration data to attackers, thus compromising its confidentiality.

    Audit information includes all information (e.g., audit records, audit
settings, audit reports) needed to successfully audit operating system activity.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000057-GPOS-00027""
  tag ""gid"": ""V-89495""
  tag ""rid"": ""SV-100145r1_rule""
  tag ""stig_id"": ""VRAU-SL-000155""
  tag ""fix_id"": ""F-96237r1_fix""
  tag ""cci"": [""CCI-000162""]
  tag ""nist"": [""AU-9"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that the system audit logs are group-owned by \""root\"":

# (audit_log_file=$(grep \""^log_file\"" /etc/audit/auditd.conf|sed s/^[^\\/]*//)
&& if [ -f \""${audit_log_file}\"" ] ; then printf \""Log(s) found in
\""${audit_log_file%/*}\"":\
\""; ls -l ${audit_log_file%/*}; else printf \""audit log file(s) not found\
\""; fi)

If any audit log file is not group-owned by \""root\"" or \""admin\"", this is a
finding.""
  tag ""fix"": ""Change the group-ownership of the audit log file(s).

Procedure:
# chgrp root <audit log file>

# chgrp root /var/log/audit/audit.log""

describe.one do
  #check if group is root or admin
  describe file('/var/log/audit/audit.log') do
    its('group') { should eq 'root' }
  end
  describe file('/var/log/audit/audit.log') do
    its('group') { should eq 'admin' }
  end
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89495.rb""}",passed,"File /var/log/audit/audit.log group should eq ""root""",0.0001095,2019-08-01T08:47:26-07:00,""
V-89497,"The SLES for vRealize must protect audit information from unauthorized
modification.","If audit information were to become compromised, then forensic
analysis and discovery of the true source of potentially malicious system
activity is impossible to achieve.

    To ensure the veracity of audit information, the operating system must
protect audit information from unauthorized modification.

    Audit information includes all information (e.g., audit records, audit
settings, audit reports) needed to successfully audit information system
activity.","[{""label""=>""default"", ""data""=>""If audit information were to become compromised, then forensic\nanalysis and discovery of the true source of potentially malicious system\nactivity is impossible to achieve.\n\n    To ensure the veracity of audit information, the operating system must\nprotect audit information from unauthorized modification.\n\n    Audit information includes all information (e.g., audit records, audit\nsettings, audit reports) needed to successfully audit information system\nactivity.""}]",0.5,[],"",SRG-OS-000058-GPOS-00028,V-89497,SV-100147r1_rule,VRAU-SL-000160,F-96239r1_fix,"[""CCI-000163""]","[""AU-9"", ""Rev_4""]","","","","","","","","","","","Verify that the system audit logs with the following command:

# (audit_log_file=$(grep ""^log_file"" /etc/audit/auditd.conf|sed s/^[^\/]*//)
&& if [ -f ""${audit_log_file}"" ] ; then printf ""Log(s) found in
""${audit_log_file%/*}"":""; ls -l ${audit_log_file%/*}; else printf ""audit log file(s) not found""; fi)

If any audit log file has a mode more permissive than ""0640"", this is a
finding.","Change the mode of the audit log file(s):

# chmod 0640 <audit log file>","control ""V-89497"" do
  title ""The SLES for vRealize must protect audit information from unauthorized
modification.""
  desc  ""If audit information were to become compromised, then forensic
analysis and discovery of the true source of potentially malicious system
activity is impossible to achieve.

    To ensure the veracity of audit information, the operating system must
protect audit information from unauthorized modification.

    Audit information includes all information (e.g., audit records, audit
settings, audit reports) needed to successfully audit information system
activity.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000058-GPOS-00028""
  tag ""gid"": ""V-89497""
  tag ""rid"": ""SV-100147r1_rule""
  tag ""stig_id"": ""VRAU-SL-000160""
  tag ""fix_id"": ""F-96239r1_fix""
  tag ""cci"": [""CCI-000163""]
  tag ""nist"": [""AU-9"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that the system audit logs with the following command:

# (audit_log_file=$(grep \""^log_file\"" /etc/audit/auditd.conf|sed s/^[^\\/]*//)
&& if [ -f \""${audit_log_file}\"" ] ; then printf \""Log(s) found in
\""${audit_log_file%/*}\"":\
\""; ls -l ${audit_log_file%/*}; else printf \""audit log file(s) not found\
\""; fi)

If any audit log file has a mode more permissive than \""0640\"", this is a
finding.""
  tag ""fix"": ""Change the mode of the audit log file(s):

# chmod 0640 <audit log file>""

describe file('/var/log/audit/audit.log') do
  it { should_not be_more_permissive_than('0640') }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89497.rb""}",passed,"File /var/log/audit/audit.log should not be more permissive than ""0640""",0.1340194,2019-08-01T08:47:26-07:00,""
V-89499,"The SLES for vRealize must protect audit information from unauthorized
deletion.","If audit information were to become compromised, then forensic
analysis and discovery of the true source of potentially malicious system
activity is impossible to achieve.

    To ensure the veracity of audit information, the operating system must
protect audit information from unauthorized deletion. This requirement can be
achieved through multiple methods, which will depend upon system architecture
and design.

    Audit information includes all information (e.g., audit records, audit
settings, audit reports) needed to successfully audit information system
activity.","[{""label""=>""default"", ""data""=>""If audit information were to become compromised, then forensic\nanalysis and discovery of the true source of potentially malicious system\nactivity is impossible to achieve.\n\n    To ensure the veracity of audit information, the operating system must\nprotect audit information from unauthorized deletion. This requirement can be\nachieved through multiple methods, which will depend upon system architecture\nand design.\n\n    Audit information includes all information (e.g., audit records, audit\nsettings, audit reports) needed to successfully audit information system\nactivity.""}]",0.5,[],"",SRG-OS-000059-GPOS-00029,V-89499,SV-100149r1_rule,VRAU-SL-000165,F-96241r1_fix,"[""CCI-000164""]","[""AU-9"", ""Rev_4""]","","","","","","","","","","","Verify that the system audit logs with the following command:

# (audit_log_file=$(grep ""^log_file"" /etc/audit/auditd.conf|sed s/^[^\/]*//)
&& if [ -f ""${audit_log_file}"" ] ; then printf ""Log(s) found in
""${audit_log_file%/*}"":""; ls -l ${audit_log_file%/*}; else printf ""audit log file(s) not found""; fi)

If any audit log file has a mode more permissive than ""0640"", this is a
finding.","Change the mode of the audit log file(s):

# chmod 0640 <audit log file>","control ""V-89499"" do
  title ""The SLES for vRealize must protect audit information from unauthorized
deletion.""
  desc  ""If audit information were to become compromised, then forensic
analysis and discovery of the true source of potentially malicious system
activity is impossible to achieve.

    To ensure the veracity of audit information, the operating system must
protect audit information from unauthorized deletion. This requirement can be
achieved through multiple methods, which will depend upon system architecture
and design.

    Audit information includes all information (e.g., audit records, audit
settings, audit reports) needed to successfully audit information system
activity.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000059-GPOS-00029""
  tag ""gid"": ""V-89499""
  tag ""rid"": ""SV-100149r1_rule""
  tag ""stig_id"": ""VRAU-SL-000165""
  tag ""fix_id"": ""F-96241r1_fix""
  tag ""cci"": [""CCI-000164""]
  tag ""nist"": [""AU-9"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that the system audit logs with the following command:

# (audit_log_file=$(grep \""^log_file\"" /etc/audit/auditd.conf|sed s/^[^\\/]*//)
&& if [ -f \""${audit_log_file}\"" ] ; then printf \""Log(s) found in
\""${audit_log_file%/*}\"":\
\""; ls -l ${audit_log_file%/*}; else printf \""audit log file(s) not found\
\""; fi)

If any audit log file has a mode more permissive than \""0640\"", this is a
finding.""
  tag ""fix"": ""Change the mode of the audit log file(s):

# chmod 0640 <audit log file>""

describe file('/var/log/audit/audit.log') do
  it { should_not be_more_permissive_than('0640') }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89499.rb""}",passed,"File /var/log/audit/audit.log should not be more permissive than ""0640""",0.0002836,2019-08-01T08:47:26-07:00,""
V-89501,"The SLES for vRealize must protect audit information from unauthorized
deletion - log directories.","If audit information were to become compromised, then forensic
analysis and discovery of the true source of potentially malicious system
activity is impossible to achieve.

    To ensure the veracity of audit information, the operating system must
protect audit information from unauthorized deletion. This requirement can be
achieved through multiple methods, which will depend upon system architecture
and design.

    Audit information includes all information (e.g., audit records, audit
settings, audit reports) needed to successfully audit information system
activity.","[{""label""=>""default"", ""data""=>""If audit information were to become compromised, then forensic\nanalysis and discovery of the true source of potentially malicious system\nactivity is impossible to achieve.\n\n    To ensure the veracity of audit information, the operating system must\nprotect audit information from unauthorized deletion. This requirement can be\nachieved through multiple methods, which will depend upon system architecture\nand design.\n\n    Audit information includes all information (e.g., audit records, audit\nsettings, audit reports) needed to successfully audit information system\nactivity.""}]",0.5,[],"",SRG-OS-000059-GPOS-00029,V-89501,SV-100151r1_rule,VRAU-SL-000170,F-96243r1_fix,"[""CCI-000164""]","[""AU-9"", ""Rev_4""]","","","","","","","","","","","Run the following command to check the mode of the system audit
directories:

# grep ""^log_file"" /etc/audit/auditd.conf|sed 's/^[^/]*//; s/[^/]*$//'|xargs
stat -c %a:%n

Audit directories must be mode ""0700"".

If any are more permissive, this is a finding.","Change the mode of the audit log directories with the following
command:

# chmod 700 <audit log directory>","control ""V-89501"" do
  title ""The SLES for vRealize must protect audit information from unauthorized
deletion - log directories.""
  desc  ""If audit information were to become compromised, then forensic
analysis and discovery of the true source of potentially malicious system
activity is impossible to achieve.

    To ensure the veracity of audit information, the operating system must
protect audit information from unauthorized deletion. This requirement can be
achieved through multiple methods, which will depend upon system architecture
and design.

    Audit information includes all information (e.g., audit records, audit
settings, audit reports) needed to successfully audit information system
activity.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000059-GPOS-00029""
  tag ""gid"": ""V-89501""
  tag ""rid"": ""SV-100151r1_rule""
  tag ""stig_id"": ""VRAU-SL-000170""
  tag ""fix_id"": ""F-96243r1_fix""
  tag ""cci"": [""CCI-000164""]
  tag ""nist"": [""AU-9"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Run the following command to check the mode of the system audit
directories:

# grep \""^log_file\"" /etc/audit/auditd.conf|sed 's/^[^/]*//; s/[^/]*$//'|xargs
stat -c %a:%n

Audit directories must be mode \""0700\"".

If any are more permissive, this is a finding.""
  tag ""fix"": ""Change the mode of the audit log directories with the following
command:

# chmod 700 <audit log directory>""

describe directory('/var/log/audit') do
  it { should_not be_more_permissive_than('0700') }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89501.rb""}",passed,"Directory /var/log/audit should not be more permissive than ""0700""",0.3546015,2019-08-01T08:47:26-07:00,""
V-89503,"The SLES for vRealize audit system must be configured to audit all
administrative, privileged, and security actions.","Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.","[{""label""=>""default"", ""data""=>""Without the capability to generate audit records, it would be\ndifficult to establish, correlate, and investigate the events relating to an\nincident or identify those responsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).\n\n    The list of audited events is the set of events for which audits are to be\ngenerated. This set of events is typically a subset of the list of all events\nfor which the system is capable of generating audit records.\n\n    DoD has defined the list of events for which the operating system will\nprovide an audit record generation capability as the following:\n\n    1) Successful and unsuccessful attempts to access, modify, or delete\nprivileges, security objects, security levels, or categories of information\n(e.g., classification levels);\n\n    2) Access actions, such as successful and unsuccessful logon attempts,\nprivileged activities or other system-level access, starting and ending time\nfor user access to the system, concurrent logons from different workstations,\nsuccessful and unsuccessful accesses to objects, all program initiations, and\nall direct access to the information system;\n\n    3) All account creations, modifications, disabling, and terminations; and\n\n    4) All kernel module load, unload, and restart actions.""}]",0.5,[],"",SRG-OS-000062-GPOS-00031,V-89503,SV-100153r1_rule,VRAU-SL-000175,F-96245r1_fix,"[""CCI-000169""]","[""AU-12 a"", ""Rev_4""]","","","","","","","","","","","Check the auditing configuration of the system:

# cat /etc/audit/audit.rules | grep -i ""auditd.conf""

If no results are returned, or the line does not start with ""-w"", this is a
finding.

Expected Result:
-w /etc/audit/auditd.conf","Add the following lines to the audit.rules file to enable
auditing of administrative, privileged, and security actions:

echo '-w /etc/audit/auditd.conf' >> /etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89503"" do
  title ""The SLES for vRealize audit system must be configured to audit all
administrative, privileged, and security actions.""
  desc  ""Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000062-GPOS-00031""
  tag ""gid"": ""V-89503""
  tag ""rid"": ""SV-100153r1_rule""
  tag ""stig_id"": ""VRAU-SL-000175""
  tag ""fix_id"": ""F-96245r1_fix""
  tag ""cci"": [""CCI-000169""]
  tag ""nist"": [""AU-12 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the auditing configuration of the system:

# cat /etc/audit/audit.rules | grep -i \""auditd.conf\""

If no results are returned, or the line does not start with \""-w\"", this is a
finding.

Expected Result:
-w /etc/audit/auditd.conf""
  tag ""fix"": ""Add the following lines to the audit.rules file to enable
auditing of administrative, privileged, and security actions:

echo '-w /etc/audit/auditd.conf' >> /etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

  describe file(""/etc/audit/audit.rules"") do
    its(""content"") { should match %r{-w /etc/audit/auditd.conf} }
  end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89503.rb""}",passed,File /etc/audit/audit.rules content should match /-w \/etc\/audit\/auditd.conf/,0.0002553,2019-08-01T08:47:26-07:00,""
V-89505,"The SLES for vRealize audit system must be configured to audit all
attempts to alter system time through adjtimex.","Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.","[{""label""=>""default"", ""data""=>""Without the capability to generate audit records, it would be\ndifficult to establish, correlate, and investigate the events relating to an\nincident or identify those responsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).\n\n    The list of audited events is the set of events for which audits are to be\ngenerated. This set of events is typically a subset of the list of all events\nfor which the system is capable of generating audit records.\n\n    DoD has defined the list of events for which the operating system will\nprovide an audit record generation capability as the following:\n\n    1) Successful and unsuccessful attempts to access, modify, or delete\nprivileges, security objects, security levels, or categories of information\n(e.g., classification levels);\n\n    2) Access actions, such as successful and unsuccessful logon attempts,\nprivileged activities or other system-level access, starting and ending time\nfor user access to the system, concurrent logons from different workstations,\nsuccessful and unsuccessful accesses to objects, all program initiations, and\nall direct access to the information system;\n\n    3) All account creations, modifications, disabling, and terminations; and\n\n    4) All kernel module load, unload, and restart actions.""}]",0.5,[],",
",SRG-OS-000062-GPOS-00031,V-89505,SV-100155r1_rule,VRAU-SL-000180,F-96247r1_fix,"[""CCI-000169""]","[""AU-12 a"", ""Rev_4""]",",
",",
",",
",",
",",
",",
",",
",",
",",
",",
","Check if the system is configured to audit calls to the
""adjtimex"" system call by running the following command:

# grep -w ""adjtimex"" /etc/audit/audit.rules

If the system is configured to audit time changes, it will return at least two
lines containing ""-S adjtimex"" that also contain ""arch=b64"".

If no line is returned, this is a finding.","Run the following command:

echo '-a exit,always -F arch=b64 -S adjtimex -F auid=0' >>
/etc/audit/audit.rules
echo '-a exit,always -F arch=b64 -S adjtimex -F auid>=500 -F auid!=4294967295'
>> /etc/audit/audit.rules


Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89505"" do
  title ""The SLES for vRealize audit system must be configured to audit all
attempts to alter system time through adjtimex.""
  desc  ""Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000062-GPOS-00031""
  tag ""gid"": ""V-89505""
  tag ""rid"": ""SV-100155r1_rule""
  tag ""stig_id"": ""VRAU-SL-000180""
  tag ""fix_id"": ""F-96247r1_fix""
  tag ""cci"": [""CCI-000169""]
  tag ""nist"": [""AU-12 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check if the system is configured to audit calls to the
\""adjtimex\"" system call by running the following command:

# grep -w \""adjtimex\"" /etc/audit/audit.rules

If the system is configured to audit time changes, it will return at least two
lines containing \""-S adjtimex\"" that also contain \""arch=b64\"".

If no line is returned, this is a finding.""
  tag ""fix"": ""Run the following command:

echo '-a exit,always -F arch=b64 -S adjtimex -F auid=0' >>
/etc/audit/audit.rules
echo '-a exit,always -F arch=b64 -S adjtimex -F auid>=500 -F auid!=4294967295'
>> /etc/audit/audit.rules


Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-a exit,always -F arch=b64 -S settimeofday -S adjtimex -F auid=0} }
  its(""content"") { should match %r{-a exit,always -F arch=b64 -S settimeofday -S adjtimex -F auid\>=500 -F auid!=4294967295} }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89505.rb""}","passed,
passed","File /etc/audit/audit.rules content should match /-a exit,always -F arch=b64 -S settimeofday -S adjtimex -F auid=0/,
File /etc/audit/audit.rules content should match /-a exit,always -F arch=b64 -S settimeofday -S adjtimex -F auid\>=500 -F auid!=4294967295/","0.000138,
0.000133","2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00",",
"
V-89507,"The SLES for vRealize audit system must be configured to audit all
attempts to alter system time through settimeofday.","Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.","[{""label""=>""default"", ""data""=>""Without the capability to generate audit records, it would be\ndifficult to establish, correlate, and investigate the events relating to an\nincident or identify those responsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).\n\n    The list of audited events is the set of events for which audits are to be\ngenerated. This set of events is typically a subset of the list of all events\nfor which the system is capable of generating audit records.\n\n    DoD has defined the list of events for which the operating system will\nprovide an audit record generation capability as the following:\n\n    1) Successful and unsuccessful attempts to access, modify, or delete\nprivileges, security objects, security levels, or categories of information\n(e.g., classification levels);\n\n    2) Access actions, such as successful and unsuccessful logon attempts,\nprivileged activities or other system-level access, starting and ending time\nfor user access to the system, concurrent logons from different workstations,\nsuccessful and unsuccessful accesses to objects, all program initiations, and\nall direct access to the information system;\n\n    3) All account creations, modifications, disabling, and terminations; and\n\n    4) All kernel module load, unload, and restart actions.""}]",0.5,[],",
",SRG-OS-000062-GPOS-00031,V-89507,SV-100157r1_rule,VRAU-SL-000185,F-96249r1_fix,"[""CCI-000169""]","[""AU-12 a"", ""Rev_4""]",",
",",
",",
",",
",",
",",
",",
",",
",",
",",
","Check if the system is configured to audit calls to the
""settimeofday"" system call by running the following command:

# grep -w ""settimeofday"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return at least two
lines containing ""-S settimeofday"" that also contain ""arch=b64"".

If no line is returned, this is a finding.","Run the following command:

echo '-a exit,always -F arch=b64 -S settimeofday -F auid=0' >>
/etc/audit/audit.rules
echo '-a exit,always -F arch=b64 -S settimeofday -F auid>=500 -F
auid!=4294967295' >> /etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89507"" do
  title ""The SLES for vRealize audit system must be configured to audit all
attempts to alter system time through settimeofday.""
  desc  ""Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000062-GPOS-00031""
  tag ""gid"": ""V-89507""
  tag ""rid"": ""SV-100157r1_rule""
  tag ""stig_id"": ""VRAU-SL-000185""
  tag ""fix_id"": ""F-96249r1_fix""
  tag ""cci"": [""CCI-000169""]
  tag ""nist"": [""AU-12 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check if the system is configured to audit calls to the
\""settimeofday\"" system call by running the following command:

# grep -w \""settimeofday\"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return at least two
lines containing \""-S settimeofday\"" that also contain \""arch=b64\"".

If no line is returned, this is a finding.""
  tag ""fix"": ""Run the following command:

echo '-a exit,always -F arch=b64 -S settimeofday -F auid=0' >>
/etc/audit/audit.rules
echo '-a exit,always -F arch=b64 -S settimeofday -F auid>=500 -F
auid!=4294967295' >> /etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-a exit,always -F arch=b64 -S settimeofday -S adjtimex -F auid=0} }
  its(""content"") { should match %r{-a exit,always -F arch=b64 -S settimeofday -S adjtimex -F auid\>=500 -F auid!=4294967295} }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89507.rb""}","passed,
passed","File /etc/audit/audit.rules content should match /-a exit,always -F arch=b64 -S settimeofday -S adjtimex -F auid=0/,
File /etc/audit/audit.rules content should match /-a exit,always -F arch=b64 -S settimeofday -S adjtimex -F auid\>=500 -F auid!=4294967295/","0.0001681,
0.0001656","2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00",",
"
V-89509,"The SLES for vRealize audit system must be configured to audit all
attempts to alter system time through stime.","Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.","[{""label""=>""default"", ""data""=>""Without the capability to generate audit records, it would be\ndifficult to establish, correlate, and investigate the events relating to an\nincident or identify those responsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).\n\n    The list of audited events is the set of events for which audits are to be\ngenerated. This set of events is typically a subset of the list of all events\nfor which the system is capable of generating audit records.\n\n    DoD has defined the list of events for which the operating system will\nprovide an audit record generation capability as the following:\n\n    1) Successful and unsuccessful attempts to access, modify, or delete\nprivileges, security objects, security levels, or categories of information\n(e.g., classification levels);\n\n    2) Access actions, such as successful and unsuccessful logon attempts,\nprivileged activities or other system-level access, starting and ending time\nfor user access to the system, concurrent logons from different workstations,\nsuccessful and unsuccessful accesses to objects, all program initiations, and\nall direct access to the information system;\n\n    3) All account creations, modifications, disabling, and terminations; and\n\n    4) All kernel module load, unload, and restart actions.""}]",0.5,[],"",SRG-OS-000062-GPOS-00031,V-89509,SV-100159r1_rule,VRAU-SL-000190,F-96251r1_fix,"[""CCI-000169""]","[""AU-12 a"", ""Rev_4""]","","","","","","","","","","","Check if the system is configured to audit calls to the
""settimeofday"" system call by running the following command:

# grep -w ""stime"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return at least two
lines containing ""-S settimeofday"" that also contain ""arch=b64"".

If no line is returned, this is a finding.","Run the following command:

echo '-a exit,always -F arch=b64 -S stime' >> /etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89509"" do
  title ""The SLES for vRealize audit system must be configured to audit all
attempts to alter system time through stime.""
  desc  ""Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000062-GPOS-00031""
  tag ""gid"": ""V-89509""
  tag ""rid"": ""SV-100159r1_rule""
  tag ""stig_id"": ""VRAU-SL-000190""
  tag ""fix_id"": ""F-96251r1_fix""
  tag ""cci"": [""CCI-000169""]
  tag ""nist"": [""AU-12 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check if the system is configured to audit calls to the
\""settimeofday\"" system call by running the following command:

# grep -w \""stime\"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return at least two
lines containing \""-S settimeofday\"" that also contain \""arch=b64\"".

If no line is returned, this is a finding.""
  tag ""fix"": ""Run the following command:

echo '-a exit,always -F arch=b64 -S stime' >> /etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-S stime} }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89509.rb""}",passed,File /etc/audit/audit.rules content should match /-S stime/,0.0001386,2019-08-01T08:47:26-07:00,""
V-89511,"The SLES for vRealize audit system must be configured to audit all
attempts to alter system time through clock_settime.","Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.","[{""label""=>""default"", ""data""=>""Without the capability to generate audit records, it would be\ndifficult to establish, correlate, and investigate the events relating to an\nincident or identify those responsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).\n\n    The list of audited events is the set of events for which audits are to be\ngenerated. This set of events is typically a subset of the list of all events\nfor which the system is capable of generating audit records.\n\n    DoD has defined the list of events for which the operating system will\nprovide an audit record generation capability as the following:\n\n    1) Successful and unsuccessful attempts to access, modify, or delete\nprivileges, security objects, security levels, or categories of information\n(e.g., classification levels);\n\n    2) Access actions, such as successful and unsuccessful logon attempts,\nprivileged activities or other system-level access, starting and ending time\nfor user access to the system, concurrent logons from different workstations,\nsuccessful and unsuccessful accesses to objects, all program initiations, and\nall direct access to the information system;\n\n    3) All account creations, modifications, disabling, and terminations; and\n\n    4) All kernel module load, unload, and restart actions.""}]",0.5,[],"",SRG-OS-000062-GPOS-00031,V-89511,SV-100161r1_rule,VRAU-SL-000195,F-96253r1_fix,"[""CCI-000169""]","[""AU-12 a"", ""Rev_4""]","","","","","","","","","","","Check if the system is configured to audit calls to the
""clock_settime"" system call by running the following command:

# grep -w ""clock_settime"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return at least a
line containing ""-S clock_settime"" that also contain ""arch=b64"".

If no line is returned, this is a finding.","Run the following command:

echo '-a exit,always -F arch=b64 -S clock_settime' >> /etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89511"" do
  title ""The SLES for vRealize audit system must be configured to audit all
attempts to alter system time through clock_settime.""
  desc  ""Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000062-GPOS-00031""
  tag ""gid"": ""V-89511""
  tag ""rid"": ""SV-100161r1_rule""
  tag ""stig_id"": ""VRAU-SL-000195""
  tag ""fix_id"": ""F-96253r1_fix""
  tag ""cci"": [""CCI-000169""]
  tag ""nist"": [""AU-12 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check if the system is configured to audit calls to the
\""clock_settime\"" system call by running the following command:

# grep -w \""clock_settime\"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return at least a
line containing \""-S clock_settime\"" that also contain \""arch=b64\"".

If no line is returned, this is a finding.""
  tag ""fix"": ""Run the following command:

echo '-a exit,always -F arch=b64 -S clock_settime' >> /etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

  describe file(""/etc/audit/audit.rules"") do
    its(""content"") { should match %r{-a exit,always -F arch=b64 -S clock_settime} }
  end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89511.rb""}",passed,"File /etc/audit/audit.rules content should match /-a exit,always -F arch=b64 -S clock_settime/",0.0001373,2019-08-01T08:47:26-07:00,""
V-89513,"The SLES for vRealize audit system must be configured to audit all
attempts to alter system time through /etc/localtime.","Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.","[{""label""=>""default"", ""data""=>""Without the capability to generate audit records, it would be\ndifficult to establish, correlate, and investigate the events relating to an\nincident or identify those responsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).\n\n    The list of audited events is the set of events for which audits are to be\ngenerated. This set of events is typically a subset of the list of all events\nfor which the system is capable of generating audit records.\n\n    DoD has defined the list of events for which the operating system will\nprovide an audit record generation capability as the following:\n\n    1) Successful and unsuccessful attempts to access, modify, or delete\nprivileges, security objects, security levels, or categories of information\n(e.g., classification levels);\n\n    2) Access actions, such as successful and unsuccessful logon attempts,\nprivileged activities or other system-level access, starting and ending time\nfor user access to the system, concurrent logons from different workstations,\nsuccessful and unsuccessful accesses to objects, all program initiations, and\nall direct access to the information system;\n\n    3) All account creations, modifications, disabling, and terminations; and\n\n    4) All kernel module load, unload, and restart actions.""}]",0.5,[],"",SRG-OS-000062-GPOS-00031,V-89513,SV-100163r1_rule,VRAU-SL-000200,F-96255r1_fix,"[""CCI-000169""]","[""AU-12 a"", ""Rev_4""]","","","","","","","","","","","To determine if the system is configured to audit attempts to
alter time via the /etc/localtime file, run the following command:

# auditctl -l | grep ""watch=/etc/localtime""

If the system is configured to audit this activity, it will return.

LIST_RULES: exit,always watch=/etc/localtime perm=wa key=localtime

If no line is returned, this is a finding.","To configure the system to audit attempts to alter time via the
/etc/localtime file, run the following command:

echo '-w /etc/localtime -p wa -k localtime' >> /etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89513"" do
  title ""The SLES for vRealize audit system must be configured to audit all
attempts to alter system time through /etc/localtime.""
  desc  ""Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000062-GPOS-00031""
  tag ""gid"": ""V-89513""
  tag ""rid"": ""SV-100163r1_rule""
  tag ""stig_id"": ""VRAU-SL-000200""
  tag ""fix_id"": ""F-96255r1_fix""
  tag ""cci"": [""CCI-000169""]
  tag ""nist"": [""AU-12 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To determine if the system is configured to audit attempts to
alter time via the /etc/localtime file, run the following command:

# auditctl -l | grep \""watch=/etc/localtime\""

If the system is configured to audit this activity, it will return.

LIST_RULES: exit,always watch=/etc/localtime perm=wa key=localtime

If no line is returned, this is a finding.""
  tag ""fix"": ""To configure the system to audit attempts to alter time via the
/etc/localtime file, run the following command:

echo '-w /etc/localtime -p wa -k localtime' >> /etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-w /etc/localtime -p wa -k localtime} }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89513.rb""}",passed,File /etc/audit/audit.rules content should match /-w \/etc\/localtime -p wa -k localtime/,0.0001792,2019-08-01T08:47:26-07:00,""
V-89515,"The SLES for vRealize audit system must be configured to audit all
attempts to alter the system through sethostname.","Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.","[{""label""=>""default"", ""data""=>""Without the capability to generate audit records, it would be\ndifficult to establish, correlate, and investigate the events relating to an\nincident or identify those responsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).\n\n    The list of audited events is the set of events for which audits are to be\ngenerated. This set of events is typically a subset of the list of all events\nfor which the system is capable of generating audit records.\n\n    DoD has defined the list of events for which the operating system will\nprovide an audit record generation capability as the following:\n\n    1) Successful and unsuccessful attempts to access, modify, or delete\nprivileges, security objects, security levels, or categories of information\n(e.g., classification levels);\n\n    2) Access actions, such as successful and unsuccessful logon attempts,\nprivileged activities or other system-level access, starting and ending time\nfor user access to the system, concurrent logons from different workstations,\nsuccessful and unsuccessful accesses to objects, all program initiations, and\nall direct access to the information system;\n\n    3) All account creations, modifications, disabling, and terminations; and\n\n    4) All kernel module load, unload, and restart actions.""}]",0.5,[],"",SRG-OS-000062-GPOS-00031,V-89515,SV-100165r1_rule,VRAU-SL-000205,F-96257r1_fix,"[""CCI-000169""]","[""AU-12 a"", ""Rev_4""]","","","","","","","","","","","Check if the system is configured to audit calls to the
""sethostname"" system call by running the following command:

# grep -w ""sethostname"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return at least one
line.

If no line is returned, this is a finding.","Run the following command:

# echo '-a exit,always -F arch=b64 -S sethostname' >> /etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89515"" do
  title ""The SLES for vRealize audit system must be configured to audit all
attempts to alter the system through sethostname.""
  desc  ""Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000062-GPOS-00031""
  tag ""gid"": ""V-89515""
  tag ""rid"": ""SV-100165r1_rule""
  tag ""stig_id"": ""VRAU-SL-000205""
  tag ""fix_id"": ""F-96257r1_fix""
  tag ""cci"": [""CCI-000169""]
  tag ""nist"": [""AU-12 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check if the system is configured to audit calls to the
\""sethostname\"" system call by running the following command:

# grep -w \""sethostname\"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return at least one
line.

If no line is returned, this is a finding.""
  tag ""fix"": ""Run the following command:

# echo '-a exit,always -F arch=b64 -S sethostname' >> /etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-S sethostname} }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89515.rb""}",passed,File /etc/audit/audit.rules content should match /-S sethostname/,0.0001308,2019-08-01T08:47:26-07:00,""
V-89517,"The SLES for vRealize audit system must be configured to audit all
attempts to alter the system through setdomainname.","Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.","[{""label""=>""default"", ""data""=>""Without the capability to generate audit records, it would be\ndifficult to establish, correlate, and investigate the events relating to an\nincident or identify those responsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).\n\n    The list of audited events is the set of events for which audits are to be\ngenerated. This set of events is typically a subset of the list of all events\nfor which the system is capable of generating audit records.\n\n    DoD has defined the list of events for which the operating system will\nprovide an audit record generation capability as the following:\n\n    1) Successful and unsuccessful attempts to access, modify, or delete\nprivileges, security objects, security levels, or categories of information\n(e.g., classification levels);\n\n    2) Access actions, such as successful and unsuccessful logon attempts,\nprivileged activities or other system-level access, starting and ending time\nfor user access to the system, concurrent logons from different workstations,\nsuccessful and unsuccessful accesses to objects, all program initiations, and\nall direct access to the information system;\n\n    3) All account creations, modifications, disabling, and terminations; and\n\n    4) All kernel module load, unload, and restart actions.""}]",0.5,[],"",SRG-OS-000062-GPOS-00031,V-89517,SV-100167r1_rule,VRAU-SL-000210,F-96259r1_fix,"[""CCI-000169""]","[""AU-12 a"", ""Rev_4""]","","","","","","","","","","","Check if the system is configured to audit calls to the
""sethostname"" system call by running the following command:

# grep -w ""setdomainname"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return a line.

If no line is returned, this is a finding.","Run the following command:

# echo '-a exit,always -F arch=b64 -S setdomainname' >> /etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89517"" do
  title ""The SLES for vRealize audit system must be configured to audit all
attempts to alter the system through setdomainname.""
  desc  ""Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000062-GPOS-00031""
  tag ""gid"": ""V-89517""
  tag ""rid"": ""SV-100167r1_rule""
  tag ""stig_id"": ""VRAU-SL-000210""
  tag ""fix_id"": ""F-96259r1_fix""
  tag ""cci"": [""CCI-000169""]
  tag ""nist"": [""AU-12 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check if the system is configured to audit calls to the
\""sethostname\"" system call by running the following command:

# grep -w \""setdomainname\"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return a line.

If no line is returned, this is a finding.""
  tag ""fix"": ""Run the following command:

# echo '-a exit,always -F arch=b64 -S setdomainname' >> /etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-S setdomainname} }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89517.rb""}",passed,File /etc/audit/audit.rules content should match /-S setdomainname/,0.0001486,2019-08-01T08:47:26-07:00,""
V-89519,"The SLES for vRealize audit system must be configured to audit all
attempts to alter the system through sched_setparam.","Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.","[{""label""=>""default"", ""data""=>""Without the capability to generate audit records, it would be\ndifficult to establish, correlate, and investigate the events relating to an\nincident or identify those responsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).\n\n    The list of audited events is the set of events for which audits are to be\ngenerated. This set of events is typically a subset of the list of all events\nfor which the system is capable of generating audit records.\n\n    DoD has defined the list of events for which the operating system will\nprovide an audit record generation capability as the following:\n\n    1) Successful and unsuccessful attempts to access, modify, or delete\nprivileges, security objects, security levels, or categories of information\n(e.g., classification levels);\n\n    2) Access actions, such as successful and unsuccessful logon attempts,\nprivileged activities or other system-level access, starting and ending time\nfor user access to the system, concurrent logons from different workstations,\nsuccessful and unsuccessful accesses to objects, all program initiations, and\nall direct access to the information system;\n\n    3) All account creations, modifications, disabling, and terminations; and\n\n    4) All kernel module load, unload, and restart actions.""}]",0.5,[],"",SRG-OS-000062-GPOS-00031,V-89519,SV-100169r1_rule,VRAU-SL-000215,F-96261r1_fix,"[""CCI-000169""]","[""AU-12 a"", ""Rev_4""]","","","","","","","","","","","Check if the system is configured to audit calls to the
""sethostname"" system call by running the following command:

# grep -w ""sched_setparam"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return a line.

If no line is returned, this is a finding.","Run the following command:

echo '-a exit,always -F arch=b64 -S sched_setparam' >> /etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89519"" do
  title ""The SLES for vRealize audit system must be configured to audit all
attempts to alter the system through sched_setparam.""
  desc  ""Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000062-GPOS-00031""
  tag ""gid"": ""V-89519""
  tag ""rid"": ""SV-100169r1_rule""
  tag ""stig_id"": ""VRAU-SL-000215""
  tag ""fix_id"": ""F-96261r1_fix""
  tag ""cci"": [""CCI-000169""]
  tag ""nist"": [""AU-12 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check if the system is configured to audit calls to the
\""sethostname\"" system call by running the following command:

# grep -w \""sched_setparam\"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return a line.

If no line is returned, this is a finding.""
  tag ""fix"": ""Run the following command:

echo '-a exit,always -F arch=b64 -S sched_setparam' >> /etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-S sched_setparam} }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89519.rb""}",passed,File /etc/audit/audit.rules content should match /-S sched_setparam/,0.0001258,2019-08-01T08:47:26-07:00,""
V-89521,"The SLES for vRealize audit system must be configured to audit all
attempts to alter the system through sched_setscheduler.","Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.","[{""label""=>""default"", ""data""=>""Without the capability to generate audit records, it would be\ndifficult to establish, correlate, and investigate the events relating to an\nincident or identify those responsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).\n\n    The list of audited events is the set of events for which audits are to be\ngenerated. This set of events is typically a subset of the list of all events\nfor which the system is capable of generating audit records.\n\n    DoD has defined the list of events for which the operating system will\nprovide an audit record generation capability as the following:\n\n    1) Successful and unsuccessful attempts to access, modify, or delete\nprivileges, security objects, security levels, or categories of information\n(e.g., classification levels);\n\n    2) Access actions, such as successful and unsuccessful logon attempts,\nprivileged activities or other system-level access, starting and ending time\nfor user access to the system, concurrent logons from different workstations,\nsuccessful and unsuccessful accesses to objects, all program initiations, and\nall direct access to the information system;\n\n    3) All account creations, modifications, disabling, and terminations; and\n\n    4) All kernel module load, unload, and restart actions.""}]",0.5,[],"",SRG-OS-000062-GPOS-00031,V-89521,SV-100171r1_rule,VRAU-SL-000220,F-96263r1_fix,"[""CCI-000169""]","[""AU-12 a"", ""Rev_4""]","","","","","","","","","","","Check if the system is configured to audit calls to the
""sethostname"" system call by running the following command:

# grep -w ""sched_setscheduler"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return a line.

If no line is returned, this is a finding.","Run the following command:

echo '-a exit,always -F arch=b64 -S sched_setscheduler' >>
/etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89521"" do
  title ""The SLES for vRealize audit system must be configured to audit all
attempts to alter the system through sched_setscheduler.""
  desc  ""Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000062-GPOS-00031""
  tag ""gid"": ""V-89521""
  tag ""rid"": ""SV-100171r1_rule""
  tag ""stig_id"": ""VRAU-SL-000220""
  tag ""fix_id"": ""F-96263r1_fix""
  tag ""cci"": [""CCI-000169""]
  tag ""nist"": [""AU-12 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check if the system is configured to audit calls to the
\""sethostname\"" system call by running the following command:

# grep -w \""sched_setscheduler\"" /etc/audit/audit.rules

If the system is configured to audit this activity, it will return a line.

If no line is returned, this is a finding.""
  tag ""fix"": ""Run the following command:

echo '-a exit,always -F arch=b64 -S sched_setscheduler' >>
/etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-S sched_setscheduler} }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89521.rb""}",passed,File /etc/audit/audit.rules content should match /-S sched_setscheduler/,0.000151,2019-08-01T08:47:26-07:00,""
V-89523,"The SLES for vRealize audit system must be configured to audit all
attempts to alter /var/log/faillog.","Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.","[{""label""=>""default"", ""data""=>""Without the capability to generate audit records, it would be\ndifficult to establish, correlate, and investigate the events relating to an\nincident or identify those responsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).\n\n    The list of audited events is the set of events for which audits are to be\ngenerated. This set of events is typically a subset of the list of all events\nfor which the system is capable of generating audit records.\n\n    DoD has defined the list of events for which the operating system will\nprovide an audit record generation capability as the following:\n\n    1) Successful and unsuccessful attempts to access, modify, or delete\nprivileges, security objects, security levels, or categories of information\n(e.g., classification levels);\n\n    2) Access actions, such as successful and unsuccessful logon attempts,\nprivileged activities or other system-level access, starting and ending time\nfor user access to the system, concurrent logons from different workstations,\nsuccessful and unsuccessful accesses to objects, all program initiations, and\nall direct access to the information system;\n\n    3) All account creations, modifications, disabling, and terminations; and\n\n    4) All kernel module load, unload, and restart actions.""}]",0.5,[],"",SRG-OS-000062-GPOS-00031,V-89523,SV-100173r1_rule,VRAU-SL-000225,F-96265r1_fix,"[""CCI-000169""]","[""AU-12 a"", ""Rev_4""]","","","","","","","","","","","Verify that attempts to alter the log files /var/log/faillog
are audited:

# egrep ""faillog"" /etc/audit/audit.rules

If ""-w /var/log/faillog -p wa"" entry does not exist, this is a finding.","Ensure attempts to alter /var/log/faillog are audited by
modifying /etc/audit/audit.rules to contain -w /var/log/faillog -p wa with the
following command:

echo '-w /var/log/faillog -p wa' >> /etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89523"" do
  title ""The SLES for vRealize audit system must be configured to audit all
attempts to alter /var/log/faillog.""
  desc  ""Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000062-GPOS-00031""
  tag ""gid"": ""V-89523""
  tag ""rid"": ""SV-100173r1_rule""
  tag ""stig_id"": ""VRAU-SL-000225""
  tag ""fix_id"": ""F-96265r1_fix""
  tag ""cci"": [""CCI-000169""]
  tag ""nist"": [""AU-12 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that attempts to alter the log files /var/log/faillog
are audited:

# egrep \""faillog\"" /etc/audit/audit.rules

If \""-w /var/log/faillog -p wa\"" entry does not exist, this is a finding.""
  tag ""fix"": ""Ensure attempts to alter /var/log/faillog are audited by
modifying /etc/audit/audit.rules to contain -w /var/log/faillog -p wa with the
following command:

echo '-w /var/log/faillog -p wa' >> /etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-w /var/log/faillog -p wa} }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89523.rb""}",passed,File /etc/audit/audit.rules content should match /-w \/var\/log\/faillog -p wa/,0.0001305,2019-08-01T08:47:26-07:00,""
V-89525,"The SLES for vRealize audit system must be configured to audit all
attempts to alter /var/log/lastlog.","Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.","[{""label""=>""default"", ""data""=>""Without the capability to generate audit records, it would be\ndifficult to establish, correlate, and investigate the events relating to an\nincident or identify those responsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).\n\n    The list of audited events is the set of events for which audits are to be\ngenerated. This set of events is typically a subset of the list of all events\nfor which the system is capable of generating audit records.\n\n    DoD has defined the list of events for which the operating system will\nprovide an audit record generation capability as the following:\n\n    1) Successful and unsuccessful attempts to access, modify, or delete\nprivileges, security objects, security levels, or categories of information\n(e.g., classification levels);\n\n    2) Access actions, such as successful and unsuccessful logon attempts,\nprivileged activities or other system-level access, starting and ending time\nfor user access to the system, concurrent logons from different workstations,\nsuccessful and unsuccessful accesses to objects, all program initiations, and\nall direct access to the information system;\n\n    3) All account creations, modifications, disabling, and terminations; and\n\n    4) All kernel module load, unload, and restart actions.""}]",0.5,[],"",SRG-OS-000062-GPOS-00031,V-89525,SV-100175r1_rule,VRAU-SL-000230,F-96267r1_fix,"[""CCI-000169""]","[""AU-12 a"", ""Rev_4""]","","","","","","","","","","","Verify that attempts to alter the log files /var/log/lastlog
are audited:

# egrep ""lastlog"" /etc/audit/audit.rules

If ""-w /var/log/lastlog -p wa"" entry does not exist, this is a finding.","Ensure attempts to alter /var/log/lastlog are audited by
modifying /etc/audit/audit.rules to contain -w /var/log/lastlog -p wa with the
following command:

echo '-w /var/log/lastlog -p wa' >> /etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89525"" do
  title ""The SLES for vRealize audit system must be configured to audit all
attempts to alter /var/log/lastlog.""
  desc  ""Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000062-GPOS-00031""
  tag ""gid"": ""V-89525""
  tag ""rid"": ""SV-100175r1_rule""
  tag ""stig_id"": ""VRAU-SL-000230""
  tag ""fix_id"": ""F-96267r1_fix""
  tag ""cci"": [""CCI-000169""]
  tag ""nist"": [""AU-12 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that attempts to alter the log files /var/log/lastlog
are audited:

# egrep \""lastlog\"" /etc/audit/audit.rules

If \""-w /var/log/lastlog -p wa\"" entry does not exist, this is a finding.""
  tag ""fix"": ""Ensure attempts to alter /var/log/lastlog are audited by
modifying /etc/audit/audit.rules to contain -w /var/log/lastlog -p wa with the
following command:

echo '-w /var/log/lastlog -p wa' >> /etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-w /var/log/lastlog -p wa} }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89525.rb""}",passed,File /etc/audit/audit.rules content should match /-w \/var\/log\/lastlog -p wa/,0.0001246,2019-08-01T08:47:26-07:00,""
V-89527,"The SLES for vRealize audit system must be configured to audit all
attempts to alter /var/log/tallylog.","Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.","[{""label""=>""default"", ""data""=>""Without the capability to generate audit records, it would be\ndifficult to establish, correlate, and investigate the events relating to an\nincident or identify those responsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).\n\n    The list of audited events is the set of events for which audits are to be\ngenerated. This set of events is typically a subset of the list of all events\nfor which the system is capable of generating audit records.\n\n    DoD has defined the list of events for which the operating system will\nprovide an audit record generation capability as the following:\n\n    1) Successful and unsuccessful attempts to access, modify, or delete\nprivileges, security objects, security levels, or categories of information\n(e.g., classification levels);\n\n    2) Access actions, such as successful and unsuccessful logon attempts,\nprivileged activities or other system-level access, starting and ending time\nfor user access to the system, concurrent logons from different workstations,\nsuccessful and unsuccessful accesses to objects, all program initiations, and\nall direct access to the information system;\n\n    3) All account creations, modifications, disabling, and terminations; and\n\n    4) All kernel module load, unload, and restart actions.""}]",0.5,[],"",SRG-OS-000062-GPOS-00031,V-89527,SV-100177r1_rule,VRAU-SL-000235,F-96269r1_fix,"[""CCI-000169""]","[""AU-12 a"", ""Rev_4""]","","","","","","","","","","","Verify that attempts to alter the log files /var/log/tallylog
are audited:

# egrep ""tallylog"" /etc/audit/audit.rules

If ""-w /var/log/tallylog -p wa"" entry does not exist, this is a finding.","Ensure attempts to alter /var/log/tallylog are audited by
modifying /etc/audit/audit.rules to contain ""-w /var/log/tallylog -p wa"" with
the following command:

echo '-w /var/log/tallylog -p wa' >> /etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89527"" do
  title ""The SLES for vRealize audit system must be configured to audit all
attempts to alter /var/log/tallylog.""
  desc  ""Without the capability to generate audit records, it would be
difficult to establish, correlate, and investigate the events relating to an
incident or identify those responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).

    The list of audited events is the set of events for which audits are to be
generated. This set of events is typically a subset of the list of all events
for which the system is capable of generating audit records.

    DoD has defined the list of events for which the operating system will
provide an audit record generation capability as the following:

    1) Successful and unsuccessful attempts to access, modify, or delete
privileges, security objects, security levels, or categories of information
(e.g., classification levels);

    2) Access actions, such as successful and unsuccessful logon attempts,
privileged activities or other system-level access, starting and ending time
for user access to the system, concurrent logons from different workstations,
successful and unsuccessful accesses to objects, all program initiations, and
all direct access to the information system;

    3) All account creations, modifications, disabling, and terminations; and

    4) All kernel module load, unload, and restart actions.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000062-GPOS-00031""
  tag ""gid"": ""V-89527""
  tag ""rid"": ""SV-100177r1_rule""
  tag ""stig_id"": ""VRAU-SL-000235""
  tag ""fix_id"": ""F-96269r1_fix""
  tag ""cci"": [""CCI-000169""]
  tag ""nist"": [""AU-12 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that attempts to alter the log files /var/log/tallylog
are audited:

# egrep \""tallylog\"" /etc/audit/audit.rules

If \""-w /var/log/tallylog -p wa\"" entry does not exist, this is a finding.""
  tag ""fix"": ""Ensure attempts to alter /var/log/tallylog are audited by
modifying /etc/audit/audit.rules to contain \""-w /var/log/tallylog -p wa\"" with
the following command:

echo '-w /var/log/tallylog -p wa' >> /etc/audit/audit.rules

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-w /var/log/tallylog -p wa} }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89527.rb""}",passed,File /etc/audit/audit.rules content should match /-w \/var\/log\/tallylog -p wa/,0.0001255,2019-08-01T08:47:26-07:00,""
V-89529,"The SLES for vRealize must allow only the ISSM (or individuals or
roles appointed by the ISSM) to select which auditable events are to be audited
- Permissions.","Without the capability to restrict which roles and individuals can
select which events are audited, unauthorized personnel may be able to prevent
the auditing of critical events. Misconfigured audits may degrade the system's
performance by overwhelming the audit log. Misconfigured audits may also make
it more difficult to establish, correlate, and investigate the events relating
to an incident or identify those responsible for one.","[{""label""=>""default"", ""data""=>""Without the capability to restrict which roles and individuals can\nselect which events are audited, unauthorized personnel may be able to prevent\nthe auditing of critical events. Misconfigured audits may degrade the system's\nperformance by overwhelming the audit log. Misconfigured audits may also make\nit more difficult to establish, correlate, and investigate the events relating\nto an incident or identify those responsible for one.""}]",0.5,[],"",SRG-OS-000063-GPOS-00032,V-89529,SV-100179r1_rule,VRAU-SL-000240,F-96271r1_fix,"[""CCI-000171""]","[""AU-12 b"", ""Rev_4""]","","","","","","","","","","","Check the permissions of the rules files in /etc/audit:

# ls -l /etc/audit/

NOTE: If /etc/audit/audit.rules is a symblic link to
/etc/audit/audit.rules.STIG, then the check is only applicable to
/etc/audit/audit.rules.STIG.

If the permissions of the file is not set to ""640"", this is a finding.","Change the permissions of the /etc/audit/audit.rules.STIG, the
/etc/audit/audit.rules.ORIG, and the /etc/audit/audit.rules files (if not a
symblic link):

# chmod 640 /etc/audit/audit.rules.STIG
# chmod 640 /etc/audit/audit.rules.ORIG
# if [ -f /etc/audit/audit.rules ]; then chmod 640 /etc/audit/audit.rules; fi

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89529"" do
  title ""The SLES for vRealize must allow only the ISSM (or individuals or
roles appointed by the ISSM) to select which auditable events are to be audited
- Permissions.""
  desc  ""Without the capability to restrict which roles and individuals can
select which events are audited, unauthorized personnel may be able to prevent
the auditing of critical events. Misconfigured audits may degrade the system's
performance by overwhelming the audit log. Misconfigured audits may also make
it more difficult to establish, correlate, and investigate the events relating
to an incident or identify those responsible for one.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000063-GPOS-00032""
  tag ""gid"": ""V-89529""
  tag ""rid"": ""SV-100179r1_rule""
  tag ""stig_id"": ""VRAU-SL-000240""
  tag ""fix_id"": ""F-96271r1_fix""
  tag ""cci"": [""CCI-000171""]
  tag ""nist"": [""AU-12 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the permissions of the rules files in /etc/audit:

# ls -l /etc/audit/

NOTE: If /etc/audit/audit.rules is a symblic link to
/etc/audit/audit.rules.STIG, then the check is only applicable to
/etc/audit/audit.rules.STIG.

If the permissions of the file is not set to \""640\"", this is a finding.""
  tag ""fix"": ""Change the permissions of the /etc/audit/audit.rules.STIG, the
/etc/audit/audit.rules.ORIG, and the /etc/audit/audit.rules files (if not a
symblic link):

# chmod 640 /etc/audit/audit.rules.STIG
# chmod 640 /etc/audit/audit.rules.ORIG
# if [ -f /etc/audit/audit.rules ]; then chmod 640 /etc/audit/audit.rules; fi

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file('/etc/audit/audit.rules.STIG') do
  it { should_not be_more_permissive_than('0640') }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89529.rb""}",passed,"File /etc/audit/audit.rules.STIG should not be more permissive than ""0640""",0.3324712,2019-08-01T08:47:26-07:00,""
V-89531,"The SLES for vRealize must allow only the ISSM (or individuals or
roles appointed by the ISSM) to select which auditable events are to be audited
- ownership.","Without the capability to restrict which roles and individuals can
select which events are audited, unauthorized personnel may be able to prevent
the auditing of critical events. Misconfigured audits may degrade the system's
performance by overwhelming the audit log. Misconfigured audits may also make
it more difficult to establish, correlate, and investigate the events relating
to an incident or identify those responsible for one.","[{""label""=>""default"", ""data""=>""Without the capability to restrict which roles and individuals can\nselect which events are audited, unauthorized personnel may be able to prevent\nthe auditing of critical events. Misconfigured audits may degrade the system's\nperformance by overwhelming the audit log. Misconfigured audits may also make\nit more difficult to establish, correlate, and investigate the events relating\nto an incident or identify those responsible for one.""}]",0.5,[],"",SRG-OS-000063-GPOS-00032,V-89531,SV-100181r1_rule,VRAU-SL-000245,F-96273r1_fix,"[""CCI-000171""]","[""AU-12 b"", ""Rev_4""]","","","","","","","","","","","Check the permissions of the rules files in /etc/audit:

# ls -l /etc/audit/

NOTE: If /etc/audit/audit.rules is a symblic link to
/etc/audit/audit.rules.STIG, then the check is only applicable to
/etc/audit/audit.rules.STIG

If the ownership is not set to ""root"", this is a finding.","Change the ownership of the /etc/audit/audit.rules.STIG, the
/etc/audit/audit.rules.ORIG, and the /etc/audit/audit.rules files (if not a
symblic link):

# chown root /etc/audit/audit.rules.STIG
# chown root /etc/audit/audit.rules.ORIG
# if [ -f /etc/audit/audit.rules ]; then chown root /etc/audit/audit.rules; fi

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89531"" do
  title ""The SLES for vRealize must allow only the ISSM (or individuals or
roles appointed by the ISSM) to select which auditable events are to be audited
- ownership.""
  desc  ""Without the capability to restrict which roles and individuals can
select which events are audited, unauthorized personnel may be able to prevent
the auditing of critical events. Misconfigured audits may degrade the system's
performance by overwhelming the audit log. Misconfigured audits may also make
it more difficult to establish, correlate, and investigate the events relating
to an incident or identify those responsible for one.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000063-GPOS-00032""
  tag ""gid"": ""V-89531""
  tag ""rid"": ""SV-100181r1_rule""
  tag ""stig_id"": ""VRAU-SL-000245""
  tag ""fix_id"": ""F-96273r1_fix""
  tag ""cci"": [""CCI-000171""]
  tag ""nist"": [""AU-12 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the permissions of the rules files in /etc/audit:

# ls -l /etc/audit/

NOTE: If /etc/audit/audit.rules is a symblic link to
/etc/audit/audit.rules.STIG, then the check is only applicable to
/etc/audit/audit.rules.STIG

If the ownership is not set to \""root\"", this is a finding.""
  tag ""fix"": ""Change the ownership of the /etc/audit/audit.rules.STIG, the
/etc/audit/audit.rules.ORIG, and the /etc/audit/audit.rules files (if not a
symblic link):

# chown root /etc/audit/audit.rules.STIG
# chown root /etc/audit/audit.rules.ORIG
# if [ -f /etc/audit/audit.rules ]; then chown root /etc/audit/audit.rules; fi

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file('/etc/audit/audit.rules.STIG') do
  its('owner') {should cmp 'root'}
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89531.rb""}",passed,"File /etc/audit/audit.rules.STIG owner should cmp == ""root""",0.0002781,2019-08-01T08:47:26-07:00,""
V-89533,"The SLES for vRealize must allow only the ISSM (or individuals or
roles appointed by the ISSM) to select which auditable events are to be audited
- group-ownership.","Without the capability to restrict which roles and individuals can
select which events are audited, unauthorized personnel may be able to prevent
the auditing of critical events. Misconfigured audits may degrade the system's
performance by overwhelming the audit log. Misconfigured audits may also make
it more difficult to establish, correlate, and investigate the events relating
to an incident or identify those responsible for one.","[{""label""=>""default"", ""data""=>""Without the capability to restrict which roles and individuals can\nselect which events are audited, unauthorized personnel may be able to prevent\nthe auditing of critical events. Misconfigured audits may degrade the system's\nperformance by overwhelming the audit log. Misconfigured audits may also make\nit more difficult to establish, correlate, and investigate the events relating\nto an incident or identify those responsible for one.""}]",0.5,[],"",SRG-OS-000063-GPOS-00032,V-89533,SV-100183r1_rule,VRAU-SL-000250,F-96275r1_fix,"[""CCI-000171""]","[""AU-12 b"", ""Rev_4""]","","","","","","","","","","","Check the permissions of the rules files in /etc/audit:

# ls -l /etc/audit/

NOTE: If /etc/audit/audit.rules is a symblic link to
/etc/audit/audit.rules.STIG, then the check is only applicable to
/etc/audit/audit.rules.STIG.

If the group-owner is not set to ""root"", this is a finding.","Change the group-ownership of the /etc/audit/audit.rules.STIG,
the /etc/audit/audit.rules.ORIG, and the /etc/audit/audit.rules files (if not a
symblic link):

# chgrp root /etc/audit/audit.rules.STIG
# chgrp root /etc/audit/audit.rules.ORIG
# if [ -f /etc/audit/audit.rules ]; then chgrp root /etc/audit/audit.rules; fi

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89533"" do
  title ""The SLES for vRealize must allow only the ISSM (or individuals or
roles appointed by the ISSM) to select which auditable events are to be audited
- group-ownership.""
  desc  ""Without the capability to restrict which roles and individuals can
select which events are audited, unauthorized personnel may be able to prevent
the auditing of critical events. Misconfigured audits may degrade the system's
performance by overwhelming the audit log. Misconfigured audits may also make
it more difficult to establish, correlate, and investigate the events relating
to an incident or identify those responsible for one.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000063-GPOS-00032""
  tag ""gid"": ""V-89533""
  tag ""rid"": ""SV-100183r1_rule""
  tag ""stig_id"": ""VRAU-SL-000250""
  tag ""fix_id"": ""F-96275r1_fix""
  tag ""cci"": [""CCI-000171""]
  tag ""nist"": [""AU-12 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the permissions of the rules files in /etc/audit:

# ls -l /etc/audit/

NOTE: If /etc/audit/audit.rules is a symblic link to
/etc/audit/audit.rules.STIG, then the check is only applicable to
/etc/audit/audit.rules.STIG.

If the group-owner is not set to \""root\"", this is a finding.""
  tag ""fix"": ""Change the group-ownership of the /etc/audit/audit.rules.STIG,
the /etc/audit/audit.rules.ORIG, and the /etc/audit/audit.rules files (if not a
symblic link):

# chgrp root /etc/audit/audit.rules.STIG
# chgrp root /etc/audit/audit.rules.ORIG
# if [ -f /etc/audit/audit.rules ]; then chgrp root /etc/audit/audit.rules; fi

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file('/etc/audit/audit.rules.STIG') do
  its('group') {should cmp 'root'}
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89533.rb""}",passed,"File /etc/audit/audit.rules.STIG group should cmp == ""root""",0.0002294,2019-08-01T08:47:26-07:00,""
V-89535,"The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using chmod.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000064-GPOS-00033,V-89535,SV-100185r1_rule,VRAU-SL-000255,F-96277r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","To determine if the system is configured to audit calls to the
""chmod"" system call, run the following command:

# auditctl -l | grep syscall | grep chmod

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid=0
syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat
LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid>=500 (0x1f4) auid!=-1
(0xffffffff) syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat

If no lines are returned, this is a finding.","At a minimum, the audit system should collect file permission
changes for all users and ""root"". Add the following to
""/etc/audit/audit.rules"":

-a always,exit -F arch=b64 -S chmod -F auid=0
-a always,exit -F arch=b64 -S chmod -F auid>=500 -F auid!=4294967295

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89535"" do
  title ""The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using chmod.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000064-GPOS-00033""
  tag ""gid"": ""V-89535""
  tag ""rid"": ""SV-100185r1_rule""
  tag ""stig_id"": ""VRAU-SL-000255""
  tag ""fix_id"": ""F-96277r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To determine if the system is configured to audit calls to the
\""chmod\"" system call, run the following command:

# auditctl -l | grep syscall | grep chmod

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid=0
syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat
LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid>=500 (0x1f4) auid!=-1
(0xffffffff) syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat

If no lines are returned, this is a finding.""
  tag ""fix"": ""At a minimum, the audit system should collect file permission
changes for all users and \""root\"". Add the following to
\""/etc/audit/audit.rules\"":

-a always,exit -F arch=b64 -S chmod -F auid=0
-a always,exit -F arch=b64 -S chmod -F auid>=500 -F auid!=4294967295

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-S chmod} } #this may be too exclusive, and might need to be expanded.
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89535.rb""}",passed,File /etc/audit/audit.rules content should match /-S chmod/,0.0001733,2019-08-01T08:47:26-07:00,""
V-89537,"The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using chown.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000064-GPOS-00033,V-89537,SV-100187r1_rule,VRAU-SL-000260,F-96279r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","To determine if the system is configured to audit calls to the
""chown"" system call, run the following command:

# auditctl -l | grep syscall | grep chown

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid=0
syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat
LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid>=500 (0x1f4) auid!=-1
(0xffffffff) syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat

If no lines are returned, this is a finding.","At a minimum, the audit system should collect file permission
changes for all users and ""root"". Add the following to
""/etc/audit/audit.rules"":

-a always,exit -F arch=b64 -S chown -F auid=0
-a always,exit -F arch=b64 -S chown -F auid>=500 -F auid!=4294967295

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89537"" do
  title ""The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using chown.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000064-GPOS-00033""
  tag ""gid"": ""V-89537""
  tag ""rid"": ""SV-100187r1_rule""
  tag ""stig_id"": ""VRAU-SL-000260""
  tag ""fix_id"": ""F-96279r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To determine if the system is configured to audit calls to the
\""chown\"" system call, run the following command:

# auditctl -l | grep syscall | grep chown

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid=0
syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat
LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid>=500 (0x1f4) auid!=-1
(0xffffffff) syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat

If no lines are returned, this is a finding.""
  tag ""fix"": ""At a minimum, the audit system should collect file permission
changes for all users and \""root\"". Add the following to
\""/etc/audit/audit.rules\"":

-a always,exit -F arch=b64 -S chown -F auid=0
-a always,exit -F arch=b64 -S chown -F auid>=500 -F auid!=4294967295

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-S chown} } #this may be too exclusive, and might need to be expanded.
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89537.rb""}",passed,File /etc/audit/audit.rules content should match /-S chown/,0.0002259,2019-08-01T08:47:26-07:00,""
V-89539,"The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using fchmod.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000064-GPOS-00033,V-89539,SV-100189r1_rule,VRAU-SL-000265,F-96281r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","To determine if the system is configured to audit calls to the
""fchmod"" system call, run the following command:

# auditctl -l | grep syscall | grep fchmod

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid=0
syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat
LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid>=500 (0x1f4) auid!=-1
(0xffffffff) syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat

If no lines are returned, this is a finding.","At a minimum, the SLES for vRealize audit system should collect
file permission changes for all users and ""root"". Add the following to
""/etc/audit/audit.rules"":

-a always,exit -F arch=b64 -S fchmod -F auid=0
-a always,exit -F arch=b64 -S fchmod -F auid>=500 -F auid!=4294967295

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89539"" do
  title ""The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using fchmod.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000064-GPOS-00033""
  tag ""gid"": ""V-89539""
  tag ""rid"": ""SV-100189r1_rule""
  tag ""stig_id"": ""VRAU-SL-000265""
  tag ""fix_id"": ""F-96281r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To determine if the system is configured to audit calls to the
\""fchmod\"" system call, run the following command:

# auditctl -l | grep syscall | grep fchmod

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid=0
syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat
LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid>=500 (0x1f4) auid!=-1
(0xffffffff) syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat

If no lines are returned, this is a finding.""
  tag ""fix"": ""At a minimum, the SLES for vRealize audit system should collect
file permission changes for all users and \""root\"". Add the following to
\""/etc/audit/audit.rules\"":

-a always,exit -F arch=b64 -S fchmod -F auid=0
-a always,exit -F arch=b64 -S fchmod -F auid>=500 -F auid!=4294967295

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-S fchmod} } #this may be too exclusive, and might need to be expanded.
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89539.rb""}",passed,File /etc/audit/audit.rules content should match /-S fchmod/,0.0001284,2019-08-01T08:47:26-07:00,""
V-89541,"The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using fchmodat.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000064-GPOS-00033,V-89541,SV-100191r1_rule,VRAU-SL-000270,F-96283r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","To determine if the system is configured to audit calls to the
""fchmodat"" system call, run the following command:

# auditctl -l | grep syscall | grep fchmodat

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid=0
syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat
LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid>=500 (0x1f4) auid!=-1
(0xffffffff) syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat

If no lines are returned, this is a finding.","At a minimum, the SLES for vRealize audit system should collect
file permission changes for all users and ""root"". Add the following to
""/etc/audit/audit.rules"":

-a always,exit -F arch=b64 -S fchmodat -F auid=0
-a always,exit -F arch=b64 -S fchmodat -F auid>=500 -F auid!=4294967295

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89541"" do
  title ""The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using fchmodat.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000064-GPOS-00033""
  tag ""gid"": ""V-89541""
  tag ""rid"": ""SV-100191r1_rule""
  tag ""stig_id"": ""VRAU-SL-000270""
  tag ""fix_id"": ""F-96283r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To determine if the system is configured to audit calls to the
\""fchmodat\"" system call, run the following command:

# auditctl -l | grep syscall | grep fchmodat

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid=0
syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat
LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid>=500 (0x1f4) auid!=-1
(0xffffffff) syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat

If no lines are returned, this is a finding.""
  tag ""fix"": ""At a minimum, the SLES for vRealize audit system should collect
file permission changes for all users and \""root\"". Add the following to
\""/etc/audit/audit.rules\"":

-a always,exit -F arch=b64 -S fchmodat -F auid=0
-a always,exit -F arch=b64 -S fchmodat -F auid>=500 -F auid!=4294967295

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-S fchmodat} } #this may be too exclusive, and might need to be expanded.
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89541.rb""}",passed,File /etc/audit/audit.rules content should match /-S fchmodat/,0.0001246,2019-08-01T08:47:26-07:00,""
V-89543,"The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using fchown.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],",
",SRG-OS-000064-GPOS-00033,V-89543,SV-100193r1_rule,VRAU-SL-000275,F-96285r2_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]",",
",",
",",
",",
",",
",",
",",
",",
",",
",",
","To determine if the system is configured to audit calls to the
""fchown"" system call, run the following command:

# auditctl -l | grep syscall | grep fchown

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid=0
syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat
LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid>=500 (0x1f4) auid!=-1
(0xffffffff) syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat

If no lines are returned, this is a finding.","At a minimum, the SLES for vRealize audit system should collect
file permission changes for all users and ""root"". Add the following to
""/etc/audit/audit.rules"":

-a always,exit -F arch=b64 -S fchown -F auid=0
-a always,exit -F arch=b64 -S fchown -F auid>=500 -F auid!=4294967295
-a always,exit -F arch=b32 -S fchown
-a always,exit -F arch=b32 -S fchown32

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89543"" do
  title ""The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using fchown.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000064-GPOS-00033""
  tag ""gid"": ""V-89543""
  tag ""rid"": ""SV-100193r1_rule""
  tag ""stig_id"": ""VRAU-SL-000275""
  tag ""fix_id"": ""F-96285r2_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To determine if the system is configured to audit calls to the
\""fchown\"" system call, run the following command:

# auditctl -l | grep syscall | grep fchown

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid=0
syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat
LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid>=500 (0x1f4) auid!=-1
(0xffffffff) syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat

If no lines are returned, this is a finding.""
  tag ""fix"": ""At a minimum, the SLES for vRealize audit system should collect
file permission changes for all users and \""root\"". Add the following to
\""/etc/audit/audit.rules\"":

-a always,exit -F arch=b64 -S fchown -F auid=0
-a always,exit -F arch=b64 -S fchown -F auid>=500 -F auid!=4294967295
-a always,exit -F arch=b32 -S fchown
-a always,exit -F arch=b32 -S fchown32

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-S fchown} } #this may be too exclusive, and might need to be expanded.
  its(""content"") { should match %r{-S fchown32} } #this may be too exclusive, and might need to be expanded.
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89543.rb""}","passed,
passed","File /etc/audit/audit.rules content should match /-S fchown/,
File /etc/audit/audit.rules content should match /-S fchown32/","0.0001465,
0.0001216","2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00",",
"
V-89545,"The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using fchownat.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000064-GPOS-00033,V-89545,SV-100195r1_rule,VRAU-SL-000280,F-96287r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","To determine if the system is configured to audit calls to the
""fchownat"" system call, run the following command:

# auditctl -l | grep syscall | grep fchownat

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid=0
syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat
LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid>=500 (0x1f4) auid!=-1
(0xffffffff) syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat

If no lines are returned, this is a finding.","At a minimum, the SLES for vRealize audit system should collect
file permission changes for all users and ""root"". Add the following to
""/etc/audit/audit.rules"":

-a always,exit -F arch=b64 -S fchownat -F auid=0
-a always,exit -F arch=b64 -S fchownat -F auid>=500 -F auid!=4294967295

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89545"" do
  title ""The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using fchownat.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000064-GPOS-00033""
  tag ""gid"": ""V-89545""
  tag ""rid"": ""SV-100195r1_rule""
  tag ""stig_id"": ""VRAU-SL-000280""
  tag ""fix_id"": ""F-96287r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To determine if the system is configured to audit calls to the
\""fchownat\"" system call, run the following command:

# auditctl -l | grep syscall | grep fchownat

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid=0
syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat
LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid>=500 (0x1f4) auid!=-1
(0xffffffff) syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat

If no lines are returned, this is a finding.""
  tag ""fix"": ""At a minimum, the SLES for vRealize audit system should collect
file permission changes for all users and \""root\"". Add the following to
\""/etc/audit/audit.rules\"":

-a always,exit -F arch=b64 -S fchownat -F auid=0
-a always,exit -F arch=b64 -S fchownat -F auid>=500 -F auid!=4294967295

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-S fchownat} } #this may be too exclusive, and might need to be expanded.
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89545.rb""}",passed,File /etc/audit/audit.rules content should match /-S fchownat/,0.0001212,2019-08-01T08:47:26-07:00,""
V-89547,"The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using fremovexattr.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000064-GPOS-00033,V-89547,SV-100197r1_rule,VRAU-SL-000285,F-96289r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","To determine if the system is configured to audit calls to the
""fremovexattr"" system call, run the following command:

# auditctl -l | grep syscall | grep fremovexattr

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e)
syscall=lchown,sethostname,init_module,delete_module,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,clock_settime

If no lines are returned, this is a finding.","At a minimum, the SLES for vRealize audit system should collect
file permission changes for all users and ""root"". Add the following to
""/etc/audit/audit.rules"":

-a always,exit -F arch=b64 -S fremovexattr

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89547"" do
  title ""The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using fremovexattr.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000064-GPOS-00033""
  tag ""gid"": ""V-89547""
  tag ""rid"": ""SV-100197r1_rule""
  tag ""stig_id"": ""VRAU-SL-000285""
  tag ""fix_id"": ""F-96289r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To determine if the system is configured to audit calls to the
\""fremovexattr\"" system call, run the following command:

# auditctl -l | grep syscall | grep fremovexattr

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e)
syscall=lchown,sethostname,init_module,delete_module,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,clock_settime

If no lines are returned, this is a finding.""
  tag ""fix"": ""At a minimum, the SLES for vRealize audit system should collect
file permission changes for all users and \""root\"". Add the following to
\""/etc/audit/audit.rules\"":

-a always,exit -F arch=b64 -S fremovexattr

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-S fremovexattr} } #this may be too exclusive, and might need to be expanded.
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89547.rb""}",passed,File /etc/audit/audit.rules content should match /-S fremovexattr/,0.0001471,2019-08-01T08:47:26-07:00,""
V-89549,"The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using fsetxattr.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000064-GPOS-00033,V-89549,SV-100199r1_rule,VRAU-SL-000290,F-96291r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","To determine if the system is configured to audit calls to the
""fsetxattr"" system call, run the following command:

# auditctl -l | grep syscall | grep fsetxattr

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e)
syscall=lchown,sethostname,init_module,delete_module,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,clock_settime

If no lines are returned, this is a finding.","At a minimum, the SLES for vRealize audit system should collect
file permission changes for all users and ""root"". Add the following to
""/etc/audit/audit.rules"":

-a always,exit -F arch=b64 -S fsetxattr

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89549"" do
  title ""The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using fsetxattr.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000064-GPOS-00033""
  tag ""gid"": ""V-89549""
  tag ""rid"": ""SV-100199r1_rule""
  tag ""stig_id"": ""VRAU-SL-000290""
  tag ""fix_id"": ""F-96291r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To determine if the system is configured to audit calls to the
\""fsetxattr\"" system call, run the following command:

# auditctl -l | grep syscall | grep fsetxattr

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e)
syscall=lchown,sethostname,init_module,delete_module,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,clock_settime

If no lines are returned, this is a finding.""
  tag ""fix"": ""At a minimum, the SLES for vRealize audit system should collect
file permission changes for all users and \""root\"". Add the following to
\""/etc/audit/audit.rules\"":

-a always,exit -F arch=b64 -S fsetxattr

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-S fsetxattr} } #this may be too exclusive, and might need to be expanded.
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89549.rb""}",passed,File /etc/audit/audit.rules content should match /-S fsetxattr/,0.0001209,2019-08-01T08:47:26-07:00,""
V-89551,"The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using lchown.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000064-GPOS-00033,V-89551,SV-100201r1_rule,VRAU-SL-000295,F-96293r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","To determine if the system is configured to audit calls to the
""lchown"" system call, run the following command:

# auditctl -l | grep syscall | grep lchown

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e)
syscall=lchown,sethostname,init_module,delete_module,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,clock_settime

If no lines are returned, this is a finding.","At a minimum, the SLES for vRealize audit system should collect
file permission changes for all users and ""root"". Add the following to
""/etc/audit/audit.rules"":

-a always,exit -F arch=b64 -S lchown

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89551"" do
  title ""The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using lchown.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000064-GPOS-00033""
  tag ""gid"": ""V-89551""
  tag ""rid"": ""SV-100201r1_rule""
  tag ""stig_id"": ""VRAU-SL-000295""
  tag ""fix_id"": ""F-96293r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To determine if the system is configured to audit calls to the
\""lchown\"" system call, run the following command:

# auditctl -l | grep syscall | grep lchown

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e)
syscall=lchown,sethostname,init_module,delete_module,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,clock_settime

If no lines are returned, this is a finding.""
  tag ""fix"": ""At a minimum, the SLES for vRealize audit system should collect
file permission changes for all users and \""root\"". Add the following to
\""/etc/audit/audit.rules\"":

-a always,exit -F arch=b64 -S lchown

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-S lchown} } #this may be too exclusive, and might need to be expanded.
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89551.rb""}",passed,File /etc/audit/audit.rules content should match /-S lchown/,0.0001272,2019-08-01T08:47:26-07:00,""
V-89553,"The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using lremovexattr.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000064-GPOS-00033,V-89553,SV-100203r1_rule,VRAU-SL-000300,F-96295r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","To determine if the system is configured to audit calls to the
""lremovexattr"" system call, run the following command:

# auditctl -l | grep syscall | grep lremovexattr

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e)
syscall=lchown,sethostname,init_module,delete_module,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,clock_settime

If no lines are returned, this is a finding.","At a minimum, the SLES for vRealize audit system should collect
file permission changes for all users and ""root"". Add the following to
""/etc/audit/audit.rules"":

-a always,exit -F arch=b64 -S lremovexattr

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89553"" do
  title ""The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using lremovexattr.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000064-GPOS-00033""
  tag ""gid"": ""V-89553""
  tag ""rid"": ""SV-100203r1_rule""
  tag ""stig_id"": ""VRAU-SL-000300""
  tag ""fix_id"": ""F-96295r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To determine if the system is configured to audit calls to the
\""lremovexattr\"" system call, run the following command:

# auditctl -l | grep syscall | grep lremovexattr

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e)
syscall=lchown,sethostname,init_module,delete_module,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,clock_settime

If no lines are returned, this is a finding.""
  tag ""fix"": ""At a minimum, the SLES for vRealize audit system should collect
file permission changes for all users and \""root\"". Add the following to
\""/etc/audit/audit.rules\"":

-a always,exit -F arch=b64 -S lremovexattr

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-S lremovexattr} } #this may be too exclusive, and might need to be expanded.
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89553.rb""}",passed,File /etc/audit/audit.rules content should match /-S lremovexattr/,0.0001272,2019-08-01T08:47:26-07:00,""
V-89555,"The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using lsetxattr.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000064-GPOS-00033,V-89555,SV-100205r1_rule,VRAU-SL-000305,F-96297r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","To determine if the system is configured to audit calls to the
""lsetxattr"" system call, run the following command:

# auditctl -l | grep syscall | grep lsetxattr

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e)
syscall=lchown,sethostname,init_module,delete_module,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,clock_settime

If no lines are returned, this is a finding.","At a minimum, the SLES for vRealize audit system should collect
file permission changes for all users and ""root"". Add the following to
""/etc/audit/audit.rules"":

-a always,exit -F arch=b64 -S lsetxattr

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89555"" do
  title ""The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using lsetxattr.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000064-GPOS-00033""
  tag ""gid"": ""V-89555""
  tag ""rid"": ""SV-100205r1_rule""
  tag ""stig_id"": ""VRAU-SL-000305""
  tag ""fix_id"": ""F-96297r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To determine if the system is configured to audit calls to the
\""lsetxattr\"" system call, run the following command:

# auditctl -l | grep syscall | grep lsetxattr

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e)
syscall=lchown,sethostname,init_module,delete_module,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,clock_settime

If no lines are returned, this is a finding.""
  tag ""fix"": ""At a minimum, the SLES for vRealize audit system should collect
file permission changes for all users and \""root\"". Add the following to
\""/etc/audit/audit.rules\"":

-a always,exit -F arch=b64 -S lsetxattr

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-S lsetxattr} } #this may be too exclusive, and might need to be expanded.
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89555.rb""}",passed,File /etc/audit/audit.rules content should match /-S lsetxattr/,0.0001228,2019-08-01T08:47:26-07:00,""
V-89557,"The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using removexattr.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000064-GPOS-00033,V-89557,SV-100207r1_rule,VRAU-SL-000310,F-96299r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","To determine if the system is configured to audit calls to the
""removexattr"" system call, run the following command:

# auditctl -l | grep syscall | grep removexattr

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e)
syscall=lchown,sethostname,init_module,delete_module,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,clock_settime

If no lines are returned, this is a finding.","At a minimum, the SLES for vRealize audit system should collect
file permission changes for all users and ""root"". Add the following to ""/etc/audit/audit.rules"":

-a always,exit -F arch=b64 -S removexattr

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89557"" do
  title ""The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using removexattr.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000064-GPOS-00033""
  tag ""gid"": ""V-89557""
  tag ""rid"": ""SV-100207r1_rule""
  tag ""stig_id"": ""VRAU-SL-000310""
  tag ""fix_id"": ""F-96299r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To determine if the system is configured to audit calls to the
\""removexattr\"" system call, run the following command:

# auditctl -l | grep syscall | grep removexattr

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e)
syscall=lchown,sethostname,init_module,delete_module,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,clock_settime

If no lines are returned, this is a finding.""
  tag ""fix"": ""At a minimum, the SLES for vRealize audit system should collect
file permission changes for all users and \""root\"". Add the following to \""/etc/audit/audit.rules\"":

-a always,exit -F arch=b64 -S removexattr

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-S removexattr} } #this may be too exclusive, and might need to be expanded.
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89557.rb""}",passed,File /etc/audit/audit.rules content should match /-S removexattr/,0.0001261,2019-08-01T08:47:26-07:00,""
V-89559,"The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using setxattr.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000064-GPOS-00033,V-89559,SV-100209r1_rule,VRAU-SL-000315,F-96301r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","To determine if the system is configured to audit calls to the
""setxattr"" system call, run the following command:

# auditctl -l | grep syscall | grep setxattr

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e)
syscall=lchown,sethostname,init_module,delete_module,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,clock_settime

If no lines are returned, this is a finding.","At a minimum, the SLES for vRealize audit system should collect
file permission changes for all users and ""root"". Add the following to
""/etc/audit/audit.rules"":

-a always,exit -F arch=b64 -S setxattr

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89559"" do
  title ""The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all discretionary access control
permission modifications using setxattr.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000064-GPOS-00033""
  tag ""gid"": ""V-89559""
  tag ""rid"": ""SV-100209r1_rule""
  tag ""stig_id"": ""VRAU-SL-000315""
  tag ""fix_id"": ""F-96301r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To determine if the system is configured to audit calls to the
\""setxattr\"" system call, run the following command:

# auditctl -l | grep syscall | grep setxattr

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e)
syscall=lchown,sethostname,init_module,delete_module,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,clock_settime

If no lines are returned, this is a finding.""
  tag ""fix"": ""At a minimum, the SLES for vRealize audit system should collect
file permission changes for all users and \""root\"". Add the following to
\""/etc/audit/audit.rules\"":

-a always,exit -F arch=b64 -S setxattr

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-S setxattr} } #this may be too exclusive, and might need to be expanded.
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89559.rb""}",passed,File /etc/audit/audit.rules content should match /-S setxattr/,0.0002317,2019-08-01T08:47:26-07:00,""
V-89561,"The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all failed attempts to access files
and programs.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],",
,
,
,
,
",SRG-OS-000064-GPOS-00033,V-89561,SV-100211r1_rule,VRAU-SL-000320,F-96303r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]",",
,
,
,
,
",",
,
,
,
,
",",
,
,
,
,
",",
,
,
,
,
",",
,
,
,
,
",",
,
,
,
,
",",
,
,
,
,
",",
,
,
,
,
",",
,
,
,
,
",",
,
,
,
,
","To check that the audit system collects unauthorized file
accesses, run the following commands:

# grep EACCES /etc/audit/audit.rules

-a exit,always -F arch=b64 -S swapon -F exit=-EACCES
-a exit,always -F arch=b64 -S creat -F exit=-EACCES
-a exit,always -F arch=b64 -S open -F exit=-EACCES

# grep EPERM /etc/audit/audit.rules

-a exit,always -F arch=b64 -S swapon -F exit=-EPERM
-a exit,always -F arch=b64 -S creat -F exit=-EPERM
-a exit,always -F arch=b64 -S open -F exit=-EPERM

If either command lacks output, this is a finding.","Add the following to ""/etc/audit/audit.rules"":

-a exit,always -F arch=b64 -S swapon -F exit=-EACCES
-a exit,always -F arch=b64 -S creat -F exit=-EACCES
-a exit,always -F arch=b64 -S open -F exit=-EACCES

-a exit,always -F arch=b64 -S swapon -F exit=-EPERM
-a exit,always -F arch=b64 -S creat -F exit=-EPERM
-a exit,always -F arch=b64 -S open -F exit=-EPERM

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh","control ""V-89561"" do
  title ""The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access privileges occur. The SLES for
vRealize must generate audit records for all failed attempts to access files
and programs.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000064-GPOS-00033""
  tag ""gid"": ""V-89561""
  tag ""rid"": ""SV-100211r1_rule""
  tag ""stig_id"": ""VRAU-SL-000320""
  tag ""fix_id"": ""F-96303r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To check that the audit system collects unauthorized file
accesses, run the following commands:

# grep EACCES /etc/audit/audit.rules

-a exit,always -F arch=b64 -S swapon -F exit=-EACCES
-a exit,always -F arch=b64 -S creat -F exit=-EACCES
-a exit,always -F arch=b64 -S open -F exit=-EACCES

# grep EPERM /etc/audit/audit.rules

-a exit,always -F arch=b64 -S swapon -F exit=-EPERM
-a exit,always -F arch=b64 -S creat -F exit=-EPERM
-a exit,always -F arch=b64 -S open -F exit=-EPERM

If either command lacks output, this is a finding.""
  tag ""fix"": ""Add the following to \""/etc/audit/audit.rules\"":

-a exit,always -F arch=b64 -S swapon -F exit=-EACCES
-a exit,always -F arch=b64 -S creat -F exit=-EACCES
-a exit,always -F arch=b64 -S open -F exit=-EACCES

-a exit,always -F arch=b64 -S swapon -F exit=-EPERM
-a exit,always -F arch=b64 -S creat -F exit=-EPERM
-a exit,always -F arch=b64 -S open -F exit=-EPERM

Or run the following command to implement all logging requirements:

# /etc/dodscript.sh""

describe file(""/etc/audit/audit.rules"") do
  its(""content"") { should match %r{-a exit,always -F arch=b64 -S swapon -F exit=-EACCES} }
  its(""content"") { should match %r{-a exit,always -F arch=b64 -S creat -F exit=-EACCES} }
  its(""content"") { should match %r{-a exit,always -F arch=b64 -S open -F exit=-EACCES} }
  its(""content"") { should match %r{-a exit,always -F arch=b64 -S swapon -F exit=-EPERM} }
  its(""content"") { should match %r{-a exit,always -F arch=b64 -S creat -F exit=-EPERM} }
  its(""content"") { should match %r{-a exit,always -F arch=b64 -S open -F exit=-EPERM} }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89561.rb""}","passed,
passed,
passed,
passed,
passed,
passed","File /etc/audit/audit.rules content should match /-a exit,always -F arch=b64 -S swapon -F exit=-EACCES/,
File /etc/audit/audit.rules content should match /-a exit,always -F arch=b64 -S creat -F exit=-EACCES/,
File /etc/audit/audit.rules content should match /-a exit,always -F arch=b64 -S open -F exit=-EACCES/,
File /etc/audit/audit.rules content should match /-a exit,always -F arch=b64 -S swapon -F exit=-EPERM/,
File /etc/audit/audit.rules content should match /-a exit,always -F arch=b64 -S creat -F exit=-EPERM/,
File /etc/audit/audit.rules content should match /-a exit,always -F arch=b64 -S open -F exit=-EPERM/","0.0001318,
0.0001305,
0.0001289,
0.000151,
0.0001236,
0.00012","2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00,
2019-08-01T08:47:26-07:00",",
,
,
,
,
"
V-89563,"The SLES for vRealize must enforce password complexity by requiring
that at least one upper-case character be used.","Use of a complex password helps to increase the time and resources
required to compromise the password. Password complexity, or strength, is a
measure of the effectiveness of a password in resisting attempts at guessing
and brute-force attacks.

    Password complexity is one factor of several that determines how long it
takes to crack a password. The more complex the password, the greater the
number of possible combinations that need to be tested before the password is
compromised.","[{""label""=>""default"", ""data""=>""Use of a complex password helps to increase the time and resources\nrequired to compromise the password. Password complexity, or strength, is a\nmeasure of the effectiveness of a password in resisting attempts at guessing\nand brute-force attacks.\n\n    Password complexity is one factor of several that determines how long it\ntakes to crack a password. The more complex the password, the greater the\nnumber of possible combinations that need to be tested before the password is\ncompromised.""}]",0.5,[],"",SRG-OS-000069-GPOS-00037,V-89563,SV-100213r1_rule,VRAU-SL-000340,F-96305r1_fix,"[""CCI-000192""]","[""IA-5 (1) (a)"", ""Rev_4""]","","","","","","","","","","","Check the SLES for vRealize enforces password complexity by
requiring that at least one upper-case character be used by using the following
command:

# grep ucredit /etc/pam.d/common-password-vmware.local

If ""ucredit"" is not set to ""-1"" or not at all, this is a finding.

Expected Result:
password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=14 difok=4 retry=3","If ""ucredit"" was not set at all in
/etc/pam.d/common-password-vmware.local then run the following command:

# sed -i '/pam_cracklib.so/ s/$/ ucredit=-1/'
/etc/pam.d/common-password-vmware.local

If ""ucredit"" was set incorrectly then run the following command to set it to
""-1"":

# sed -i '/pam_cracklib.so/ s/ucredit=../ucredit=-1/'
/etc/pam.d/common-password-vmware.local","control ""V-89563"" do
  title ""The SLES for vRealize must enforce password complexity by requiring
that at least one upper-case character be used.""
  desc  ""Use of a complex password helps to increase the time and resources
required to compromise the password. Password complexity, or strength, is a
measure of the effectiveness of a password in resisting attempts at guessing
and brute-force attacks.

    Password complexity is one factor of several that determines how long it
takes to crack a password. The more complex the password, the greater the
number of possible combinations that need to be tested before the password is
compromised.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000069-GPOS-00037""
  tag ""gid"": ""V-89563""
  tag ""rid"": ""SV-100213r1_rule""
  tag ""stig_id"": ""VRAU-SL-000340""
  tag ""fix_id"": ""F-96305r1_fix""
  tag ""cci"": [""CCI-000192""]
  tag ""nist"": [""IA-5 (1) (a)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the SLES for vRealize enforces password complexity by
requiring that at least one upper-case character be used by using the following
command:

# grep ucredit /etc/pam.d/common-password-vmware.local

If \""ucredit\"" is not set to \""-1\"" or not at all, this is a finding.

Expected Result:
password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=14 difok=4 retry=3""
  tag ""fix"": ""If \""ucredit\"" was not set at all in
/etc/pam.d/common-password-vmware.local then run the following command:

# sed -i '/pam_cracklib.so/ s/$/ ucredit=-1/'
/etc/pam.d/common-password-vmware.local

If \""ucredit\"" was set incorrectly then run the following command to set it to
\""-1\"":

# sed -i '/pam_cracklib.so/ s/ucredit=../ucredit=-1/'
/etc/pam.d/common-password-vmware.local""

describe file('/etc/pam.d/common-password-vmware.local') do
  its('content') {should match %r{ucredit=-1} }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89563.rb""}",passed,File /etc/pam.d/common-password-vmware.local content should match /ucredit=-1/,0.1765622,2019-08-01T08:47:26-07:00,""
V-89565,"Global settings defined in common- {account,auth,password,session}
must be applied in the pam.d definition files.","Pam global requirements are generally defined in the common-account,
common-auth, common- password and common-session files located in the
/etc/pam.d directory. In order for the requirements to be applied the file(s)
containing them must be included directly or indirectly in each program's
definition file in /etc/pam.d","[{""label""=>""default"", ""data""=>""Pam global requirements are generally defined in the common-account,\ncommon-auth, common- password and common-session files located in the\n/etc/pam.d directory. In order for the requirements to be applied the file(s)\ncontaining them must be included directly or indirectly in each program's\ndefinition file in /etc/pam.d""}]",0.5,[],"",SRG-OS-000069-GPOS-00037,V-89565,SV-100215r1_rule,VRAU-SL-000345,F-96307r1_fix,"[""CCI-000192""]","[""IA-5 (1) (a)"", ""Rev_4""]","","","","","","","","","","","Verify that common-{account,auth,password,session} settings are
being applied.

Verify that local customization has occurred in the common-
{account,auth,password,session}-pc file(s) by some method other than the use of
the pam-config utility.

The files ""/etc/pam.d/common-{account,auth,password,session} -pc "" are
auto-generated by ""pam-config"". Any manual changes made to them will be lost
if ""pam-config"" is allowed to run.

# ls -l /etc/pam.d/common-{account,auth,password,session}

If the symlinks point to ""/etc/pam.d/common-
{account,auth,password,session}-pc"" and manual updates have been made in these
files, the updates cannot be protected if pam-config is enabled.

# ls -l /usr/sbin/pam-config

If the setting for ""pam-config"" is not ""000"", this is a finding.","In the default distribution of SLES 11, ""/etc/pam.d/common-
{account,auth,password,session}"" are symlinks to their respective
""/etc/pam.d/common- {account,auth,password,session}-pc"" files. These common-
{account,auth,password,session}-pc files are auto-generated by the pam-config
utility.

Edit /usr/sbin/pam-config permissions to prevent its use:

# chmod 000 /usr/sbin/pam-config","control ""V-89565"" do
  title ""Global settings defined in common- {account,auth,password,session}
must be applied in the pam.d definition files.""
  desc  ""Pam global requirements are generally defined in the common-account,
common-auth, common- password and common-session files located in the
/etc/pam.d directory. In order for the requirements to be applied the file(s)
containing them must be included directly or indirectly in each program's
definition file in /etc/pam.d""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000069-GPOS-00037""
  tag ""gid"": ""V-89565""
  tag ""rid"": ""SV-100215r1_rule""
  tag ""stig_id"": ""VRAU-SL-000345""
  tag ""fix_id"": ""F-96307r1_fix""
  tag ""cci"": [""CCI-000192""]
  tag ""nist"": [""IA-5 (1) (a)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that common-{account,auth,password,session} settings are
being applied.

Verify that local customization has occurred in the common-
{account,auth,password,session}-pc file(s) by some method other than the use of
the pam-config utility.

The files \""/etc/pam.d/common-{account,auth,password,session} -pc \"" are
auto-generated by \""pam-config\"". Any manual changes made to them will be lost
if \""pam-config\"" is allowed to run.

# ls -l /etc/pam.d/common-{account,auth,password,session}

If the symlinks point to \""/etc/pam.d/common-
{account,auth,password,session}-pc\"" and manual updates have been made in these
files, the updates cannot be protected if pam-config is enabled.

# ls -l /usr/sbin/pam-config

If the setting for \""pam-config\"" is not \""000\"", this is a finding.""
  tag ""fix"": ""In the default distribution of SLES 11, \""/etc/pam.d/common-
{account,auth,password,session}\"" are symlinks to their respective
\""/etc/pam.d/common- {account,auth,password,session}-pc\"" files. These common-
{account,auth,password,session}-pc files are auto-generated by the pam-config
utility.

Edit /usr/sbin/pam-config permissions to prevent its use:

# chmod 000 /usr/sbin/pam-config""

#pam-config must be 000
describe file('/usr/sbin/pam-config') do
  it { should_not be_more_permissive_than('0000') }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89565.rb""}",passed,"File /usr/sbin/pam-config should not be more permissive than ""0000""",0.3227786,2019-08-01T08:47:27-07:00,""
V-89567,"The SLES for vRealize must enforce password complexity by requiring
that at least one lower-case character be used.","Use of a complex password helps to increase the time and resources
required to compromise the password. Password complexity, or strength, is a
measure of the effectiveness of a password in resisting attempts at guessing
and brute-force attacks.

    Password complexity is one factor of several that determines how long it
takes to crack a password. The more complex the password, the greater the
number of possible combinations that need to be tested before the password is
compromised.","[{""label""=>""default"", ""data""=>""Use of a complex password helps to increase the time and resources\nrequired to compromise the password. Password complexity, or strength, is a\nmeasure of the effectiveness of a password in resisting attempts at guessing\nand brute-force attacks.\n\n    Password complexity is one factor of several that determines how long it\ntakes to crack a password. The more complex the password, the greater the\nnumber of possible combinations that need to be tested before the password is\ncompromised.""}]",0.5,[],"",SRG-OS-000070-GPOS-00038,V-89567,SV-100217r1_rule,VRAU-SL-000350,F-96309r1_fix,"[""CCI-000193""]","[""IA-5 (1) (a)"", ""Rev_4""]","","","","","","","","","","","Verify the SLES for vRealize enforces password complexity by
requiring that at least one lower-case character be used by using the following
command:

# grep lcredit /etc/pam.d/common-password-vmware.local

If ""lcredit"" is not set to ""-1"" or not at all, this is a finding.

Expected Result:
password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1
minlen=14 difok=4 retry=3","If ""lcredit"" was not set at all in
/etc/pam.d/common-password-vmware.local then run the following command:

# sed -i '/pam_cracklib.so/ s/$/ lcredit=-1/'
/etc/pam.d/common-password-vmware.local

If ""lcredit"" was set incorrectly then run the following command to set it to
""-1"":

# sed -i '/pam_cracklib.so/ s/lcredit=../lcredit=-1/'
/etc/pam.d/common-password-vmware.local","control ""V-89567"" do
  title ""The SLES for vRealize must enforce password complexity by requiring
that at least one lower-case character be used.""
  desc  ""Use of a complex password helps to increase the time and resources
required to compromise the password. Password complexity, or strength, is a
measure of the effectiveness of a password in resisting attempts at guessing
and brute-force attacks.

    Password complexity is one factor of several that determines how long it
takes to crack a password. The more complex the password, the greater the
number of possible combinations that need to be tested before the password is
compromised.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000070-GPOS-00038""
  tag ""gid"": ""V-89567""
  tag ""rid"": ""SV-100217r1_rule""
  tag ""stig_id"": ""VRAU-SL-000350""
  tag ""fix_id"": ""F-96309r1_fix""
  tag ""cci"": [""CCI-000193""]
  tag ""nist"": [""IA-5 (1) (a)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the SLES for vRealize enforces password complexity by
requiring that at least one lower-case character be used by using the following
command:

# grep lcredit /etc/pam.d/common-password-vmware.local

If \""lcredit\"" is not set to \""-1\"" or not at all, this is a finding.

Expected Result:
password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1
minlen=14 difok=4 retry=3""
  tag ""fix"": ""If \""lcredit\"" was not set at all in
/etc/pam.d/common-password-vmware.local then run the following command:

# sed -i '/pam_cracklib.so/ s/$/ lcredit=-1/'
/etc/pam.d/common-password-vmware.local

If \""lcredit\"" was set incorrectly then run the following command to set it to
\""-1\"":

# sed -i '/pam_cracklib.so/ s/lcredit=../lcredit=-1/'
/etc/pam.d/common-password-vmware.local""

describe file('/etc/pam.d/common-password-vmware.local') do
  its('content') {should match %r{lcredit=-1} }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89567.rb""}",passed,File /etc/pam.d/common-password-vmware.local content should match /lcredit=-1/,0.0004136,2019-08-01T08:47:27-07:00,""
V-89569,"The SLES for vRealize must enforce password complexity by requiring
that at least one numeric character be used.","Use of a complex password helps to increase the time and resources
required to compromise the password. Password complexity, or strength, is a
measure of the effectiveness of a password in resisting attempts at guessing
and brute-force attacks.

    Password complexity is one factor of several that determines how long it
takes to crack a password. The more complex the password, the greater the
number of possible combinations that need to be tested before the password is
compromised.","[{""label""=>""default"", ""data""=>""Use of a complex password helps to increase the time and resources\nrequired to compromise the password. Password complexity, or strength, is a\nmeasure of the effectiveness of a password in resisting attempts at guessing\nand brute-force attacks.\n\n    Password complexity is one factor of several that determines how long it\ntakes to crack a password. The more complex the password, the greater the\nnumber of possible combinations that need to be tested before the password is\ncompromised.""}]",0.5,[],"",SRG-OS-000071-GPOS-00039,V-89569,SV-100219r1_rule,VRAU-SL-000355,F-96311r1_fix,"[""CCI-000194""]","[""IA-5 (1) (a)"", ""Rev_4""]","","","","","","","","","","","Check that the SLES for vRealize enforces password complexity
by requiring that at least one numeric character be used by running the
following command:

# grep dcredit /etc/pam.d/common-password-vmware.local

If ""dcredit"" is not set to ""-1"" or is not set at all, this is a finding.

Expected Result:
password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1
minlen=14 difok=4 retry=3","If ""dcredit"" was not set at all in
/etc/pam.d/common-password-vmware.local, run the following command:

# sed -i '/pam_cracklib.so/ s/$/ dcredit=-1/'
/etc/pam.d/common-password-vmware.local

If ""dcredit"" was set incorrectly, run the following command:

# sed -i '/pam_cracklib.so/ s/dcredit=../dcredit=-1/'
/etc/pam.d/common-password-vmware.local","control ""V-89569"" do
  title ""The SLES for vRealize must enforce password complexity by requiring
that at least one numeric character be used.""
  desc  ""Use of a complex password helps to increase the time and resources
required to compromise the password. Password complexity, or strength, is a
measure of the effectiveness of a password in resisting attempts at guessing
and brute-force attacks.

    Password complexity is one factor of several that determines how long it
takes to crack a password. The more complex the password, the greater the
number of possible combinations that need to be tested before the password is
compromised.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000071-GPOS-00039""
  tag ""gid"": ""V-89569""
  tag ""rid"": ""SV-100219r1_rule""
  tag ""stig_id"": ""VRAU-SL-000355""
  tag ""fix_id"": ""F-96311r1_fix""
  tag ""cci"": [""CCI-000194""]
  tag ""nist"": [""IA-5 (1) (a)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check that the SLES for vRealize enforces password complexity
by requiring that at least one numeric character be used by running the
following command:

# grep dcredit /etc/pam.d/common-password-vmware.local

If \""dcredit\"" is not set to \""-1\"" or is not set at all, this is a finding.

Expected Result:
password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1
minlen=14 difok=4 retry=3""
  tag ""fix"": ""If \""dcredit\"" was not set at all in
/etc/pam.d/common-password-vmware.local, run the following command:

# sed -i '/pam_cracklib.so/ s/$/ dcredit=-1/'
/etc/pam.d/common-password-vmware.local

If \""dcredit\"" was set incorrectly, run the following command:

# sed -i '/pam_cracklib.so/ s/dcredit=../dcredit=-1/'
/etc/pam.d/common-password-vmware.local""

describe file('/etc/pam.d/common-password-vmware.local') do
  its('content') {should match %r{dcredit=-1} }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89569.rb""}",passed,File /etc/pam.d/common-password-vmware.local content should match /dcredit=-1/,0.000154,2019-08-01T08:47:27-07:00,""
V-89571,"The SLES for vRealize must require the change of at least eight of the
total number of characters when passwords are changed.","If the operating system allows the user to consecutively reuse
extensive portions of passwords, this increases the chances of password
compromise by increasing the window of opportunity for attempts at guessing and
brute-force attacks.

    The number of changed characters refers to the number of changes required
with respect to the total number of positions in the current password. In other
words, characters may be the same within the two passwords; however, the
positions of the like characters must be different.","[{""label""=>""default"", ""data""=>""If the operating system allows the user to consecutively reuse\nextensive portions of passwords, this increases the chances of password\ncompromise by increasing the window of opportunity for attempts at guessing and\nbrute-force attacks.\n\n    The number of changed characters refers to the number of changes required\nwith respect to the total number of positions in the current password. In other\nwords, characters may be the same within the two passwords; however, the\npositions of the like characters must be different.""}]",0.7,[],"",SRG-OS-000072-GPOS-00040,V-89571,SV-100221r1_rule,VRAU-SL-000360,F-96313r2_fix,"[""CCI-000195""]","[""IA-5 (1) (b)"", ""Rev_4""]","","","","","","","","","","","Check that at least eight characters need to be changed between
old and new passwords during a password change by running the following command:

# grep pam_cracklib /etc/pam.d/common-password-vmware.local

The ""difok"" parameter indicates how many characters must be different. The
DoD requires at least eight characters to be different during a password
change. This would appear as ""difok=8"". If difok is not found or not set to
at least ""8"", this is a finding.

Expected Result:
password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1
minlen=14 difok=8 retry=3","If ""difok"" was not set at all in
/etc/pam.d/common-password-vmware.local then run the following command:

# sed -i '/pam_cracklib.so/ s/$/ difok-8/'
/etc/pam.d/common-password-vmware.local

If ""difok"" was set incorrectly then run the following command to set it to
""8"":

# sed -i '/pam_cracklib.so/ s/difok=./difok=8/' /etc/pam.d/common-password-vmware.local","control ""V-89571"" do
  title ""The SLES for vRealize must require the change of at least eight of the
total number of characters when passwords are changed.""
  desc  "" If the operating system allows the user to consecutively reuse
extensive portions of passwords, this increases the chances of password
compromise by increasing the window of opportunity for attempts at guessing and
brute-force attacks.

    The number of changed characters refers to the number of changes required
with respect to the total number of positions in the current password. In other
words, characters may be the same within the two passwords; however, the
positions of the like characters must be different.
  ""
  impact 0.7
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000072-GPOS-00040""
  tag ""gid"": ""V-89571""
  tag ""rid"": ""SV-100221r1_rule""
  tag ""stig_id"": ""VRAU-SL-000360""
  tag ""fix_id"": ""F-96313r2_fix""
  tag ""cci"": [""CCI-000195""]
  tag ""nist"": [""IA-5 (1) (b)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check that at least eight characters need to be changed between
old and new passwords during a password change by running the following command:

# grep pam_cracklib /etc/pam.d/common-password-vmware.local

The \""difok\"" parameter indicates how many characters must be different. The
DoD requires at least eight characters to be different during a password
change. This would appear as \""difok=8\"". If difok is not found or not set to
at least \""8\"", this is a finding.

Expected Result:
password requisite pam_cracklib.so dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1
minlen=14 difok=8 retry=3""
  tag ""fix"": ""If \""difok\"" was not set at all in
/etc/pam.d/common-password-vmware.local then run the following command:

# sed -i '/pam_cracklib.so/ s/$/ difok-8/'
/etc/pam.d/common-password-vmware.local

If \""difok\"" was set incorrectly then run the following command to set it to
\""8\"":

# sed -i '/pam_cracklib.so/ s/difok=./difok=8/' /etc/pam.d/common-password-vmware.local""

describe file('/etc/pam.d/common-password-vmware.local') do
  its('content') {should match %r{difok=8} }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89571.rb""}",passed,File /etc/pam.d/common-password-vmware.local content should match /difok=8/,0.0001274,2019-08-01T08:47:27-07:00,""
V-89573,"The SLES for vRealize must store only encrypted representations of
passwords.","Passwords need to be protected at all times, and encryption is the
standard method for protecting passwords. If passwords are not encrypted, they
can be plainly read (i.e., clear text) and easily compromised.","[{""label""=>""default"", ""data""=>""Passwords need to be protected at all times, and encryption is the\nstandard method for protecting passwords. If passwords are not encrypted, they\ncan be plainly read (i.e., clear text) and easily compromised.""}]",0.7,[],"",SRG-OS-000073-GPOS-00041,V-89573,SV-100223r1_rule,VRAU-SL-000365,F-96315r1_fix,"[""CCI-000196""]","[""IA-5 (1) (c)"", ""Rev_4""]","","","","","","","","","","","Check that the user account passwords are stored hashed using
sha512 by running the following command:

# more /etc/shadow

If the password hash does not begins with ""$6$"" for user accounts such as
""root"" or ""admin"", this is a finding.","Reset the user password using the following command:

# passwd [user account]","control ""V-89573"" do
  title ""The SLES for vRealize must store only encrypted representations of
passwords.""
  desc  ""Passwords need to be protected at all times, and encryption is the
standard method for protecting passwords. If passwords are not encrypted, they
can be plainly read (i.e., clear text) and easily compromised.""
  impact 0.7
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000073-GPOS-00041""
  tag ""gid"": ""V-89573""
  tag ""rid"": ""SV-100223r1_rule""
  tag ""stig_id"": ""VRAU-SL-000365""
  tag ""fix_id"": ""F-96315r1_fix""
  tag ""cci"": [""CCI-000196""]
  tag ""nist"": [""IA-5 (1) (c)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check that the user account passwords are stored hashed using
sha512 by running the following command:

# more /etc/shadow

If the password hash does not begins with \""$6$\"" for user accounts such as
\""root\"" or \""admin\"", this is a finding.""
  tag ""fix"": ""Reset the user password using the following command:

# passwd [user account]""

#Get all users where password is not !, *, or $6$...
bad_users = inspec.shadow.where { password != ""*"" && password != ""!"" && password !~ /^\$6\$/ }.users

describe 'Password hashes in /etc/shadow' do
  it 'should only contain SHA512 hashes' do
    failure_message = ""Users without SHA512 hashes: #{bad_users.join(', ')}""
    expect(bad_users).to be_empty, failure_message
  end
end


end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89573.rb""}",passed,Password hashes in /etc/shadow should only contain SHA512 hashes,0.0001756,2019-08-01T08:47:27-07:00,""
V-89575,"The SLES for vRealize must store only encrypted representations of
passwords.","Passwords need to be protected at all times, and encryption is the
standard method for protecting passwords. If passwords are not encrypted, they
can be plainly read (i.e., clear text) and easily compromised.","[{""label""=>""default"", ""data""=>""Passwords need to be protected at all times, and encryption is the\nstandard method for protecting passwords. If passwords are not encrypted, they\ncan be plainly read (i.e., clear text) and easily compromised.""}]",0.7,[],"",SRG-OS-000073-GPOS-00041,V-89575,SV-100225r1_rule,VRAU-SL-000370,F-96317r1_fix,"[""CCI-000196""]","[""IA-5 (1) (c)"", ""Rev_4""]","","","","","","","","","","","Check that the user account passwords are stored hashed using
sha512 by running the following command:

# cat /etc/default/passwd | grep CRYPT=sha512

If  ""CRYPT=sha512"" is not listed, this is a finding.","Ensure password are being encrypted with hash sha512 with the
following command:

# echo 'CRYPT=sha512'>>/etc/default/passwd","control ""V-89575"" do
  title ""The SLES for vRealize must store only encrypted representations of
passwords.""
  desc  ""Passwords need to be protected at all times, and encryption is the
standard method for protecting passwords. If passwords are not encrypted, they
can be plainly read (i.e., clear text) and easily compromised.""
  impact 0.7
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000073-GPOS-00041""
  tag ""gid"": ""V-89575""
  tag ""rid"": ""SV-100225r1_rule""
  tag ""stig_id"": ""VRAU-SL-000370""
  tag ""fix_id"": ""F-96317r1_fix""
  tag ""cci"": [""CCI-000196""]
  tag ""nist"": [""IA-5 (1) (c)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check that the user account passwords are stored hashed using
sha512 by running the following command:

# cat /etc/default/passwd | grep CRYPT=sha512

If  \""CRYPT=sha512\"" is not listed, this is a finding.""
  tag ""fix"": ""Ensure password are being encrypted with hash sha512 with the
following command:

# echo 'CRYPT=sha512'>>/etc/default/passwd""

describe parse_config_file('/etc/default/passwd') do
  its('CRYPT') { should cmp 'sha512' }
end


end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89575.rb""}",passed,"Parse Config File /etc/default/passwd CRYPT should cmp == ""sha512""",0.0002446,2019-08-01T08:47:27-07:00,""
V-89577,"SLES for vRealize must enforce 24 hours/1 day as the minimum password
lifetime.","Enforcing a minimum password lifetime helps to prevent repeated
password changes to defeat the password reuse or history enforcement
requirement. If users are allowed to immediately and continually change their
password, then the password could be repeatedly changed in a short period of
time to defeat the organization's policy regarding password reuse.","[{""label""=>""default"", ""data""=>""Enforcing a minimum password lifetime helps to prevent repeated\npassword changes to defeat the password reuse or history enforcement\nrequirement. If users are allowed to immediately and continually change their\npassword, then the password could be repeatedly changed in a short period of\ntime to defeat the organization's policy regarding password reuse.""}]",0.5,[],"",SRG-OS-000075-GPOS-00043,V-89577,SV-100227r1_rule,VRAU-SL-000380,F-96319r1_fix,"[""CCI-000198""]","[""IA-5 (1) (d)"", ""Rev_4""]","","","","","","","","","","","To check that the SLES for vRealize enforces 24 hours/1 day as
the minimum password age, run the following command:

# grep PASS_MIN_DAYS /etc/login.defs | grep -v '#'

The DoD requirement is ""1"".

If ""PASS_MIN_DAYS"" is not set to the required value, this is a finding.","To configure the SLES for vRealize to enforce 24 hours/1 day as
the minimum password age, edit the file ""/etc/login.defs"" with the following
command:

# sed -i ""/^[^#]*PASS_MIN_DAYS/ c\PASS_MIN_DAYS 1"" /etc/login.defs","control ""V-89577"" do
  title ""SLES for vRealize must enforce 24 hours/1 day as the minimum password
lifetime.""
  desc  ""Enforcing a minimum password lifetime helps to prevent repeated
password changes to defeat the password reuse or history enforcement
requirement. If users are allowed to immediately and continually change their
password, then the password could be repeatedly changed in a short period of
time to defeat the organization's policy regarding password reuse.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000075-GPOS-00043""
  tag ""gid"": ""V-89577""
  tag ""rid"": ""SV-100227r1_rule""
  tag ""stig_id"": ""VRAU-SL-000380""
  tag ""fix_id"": ""F-96319r1_fix""
  tag ""cci"": [""CCI-000198""]
  tag ""nist"": [""IA-5 (1) (d)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To check that the SLES for vRealize enforces 24 hours/1 day as
the minimum password age, run the following command:

# grep PASS_MIN_DAYS /etc/login.defs | grep -v '#'

The DoD requirement is \""1\"".

If \""PASS_MIN_DAYS\"" is not set to the required value, this is a finding.""
  tag ""fix"": ""To configure the SLES for vRealize to enforce 24 hours/1 day as
the minimum password age, edit the file \""/etc/login.defs\"" with the following
command:

# sed -i \""/^[^#]*PASS_MIN_DAYS/ c\\PASS_MIN_DAYS 1\"" /etc/login.defs""

describe login_defs do
  its('PASS_MIN_DAYS') { should cmp 1 }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89577.rb""}",passed,login.defs PASS_MIN_DAYS should cmp == 1,0.0009022,2019-08-01T08:47:27-07:00,""
V-89579,"Users must not be able to change passwords more than once every 24
hours.","Enforcing a minimum password lifetime helps to prevent repeated
password changes to defeat the password reuse or history enforcement
requirement. If users are allowed to immediately and continually change their
password, then the password could be repeatedly changed in a short period of
time to defeat the organization's policy regarding password reuse.","[{""label""=>""default"", ""data""=>""Enforcing a minimum password lifetime helps to prevent repeated\npassword changes to defeat the password reuse or history enforcement\nrequirement. If users are allowed to immediately and continually change their\npassword, then the password could be repeatedly changed in a short period of\ntime to defeat the organization's policy regarding password reuse.""}]",0.5,[],"",SRG-OS-000075-GPOS-00043,V-89579,SV-100229r1_rule,VRAU-SL-000385,F-96321r1_fix,"[""CCI-000198""]","[""IA-5 (1) (d)"", ""Rev_4""]","","","","","","","","","","","Check the minimum time period between password changes for each
user account is 1 day.

# cat /etc/shadow | cut -d ':' -f1,4 | grep -v 1 | grep -v "":$""

If any results are returned, this is a finding.","Change the minimum time period between password changes for each
[USER] account to 1 day. The command in the check text will give you a list of
users that need to be updated to be in compliance.

# passwd -n 1 [USER]","control ""V-89579"" do
  title ""Users must not be able to change passwords more than once every 24
hours.""
  desc  ""Enforcing a minimum password lifetime helps to prevent repeated
password changes to defeat the password reuse or history enforcement
requirement. If users are allowed to immediately and continually change their
password, then the password could be repeatedly changed in a short period of
time to defeat the organization's policy regarding password reuse.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000075-GPOS-00043""
  tag ""gid"": ""V-89579""
  tag ""rid"": ""SV-100229r1_rule""
  tag ""stig_id"": ""VRAU-SL-000385""
  tag ""fix_id"": ""F-96321r1_fix""
  tag ""cci"": [""CCI-000198""]
  tag ""nist"": [""IA-5 (1) (d)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the minimum time period between password changes for each
user account is 1 day.

# cat /etc/shadow | cut -d ':' -f1,4 | grep -v 1 | grep -v \"":$\""

If any results are returned, this is a finding.""
  tag ""fix"": ""Change the minimum time period between password changes for each
[USER] account to 1 day. The command in the check text will give you a list of
users that need to be updated to be in compliance.

# passwd -n 1 [USER]""

describe shadow.where { min_days != 1 } do
  its('users') { should be_empty }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89579.rb""}",failed,/etc/shadow with min_days != 1 users should be empty,0.0004831,2019-08-01T08:47:27-07:00,"expected `[""bin"", ""daemon"", ""haldaemon"", ""mail"", ""man"", ""messagebus"", ""nobody"", ""polkituser"", ""postfix"", ""root""...wrun"", ""postgres"", ""tcserver"", ""rabbitmq"", ""ntp"", ""vcac"", ""vco"", ""horizon"", ""epmd"", ""elasticsearch""].empty?` to return true, got false"
V-89581,"SLES for vRealize must enforce a 60-day maximum password lifetime
restriction.","Any password, no matter how complex, can eventually be cracked.
Therefore, passwords need to be changed periodically. If the operating system
does not limit the lifetime of passwords and force users to change their
passwords, there is the risk that the operating system passwords could be
compromised.","[{""label""=>""default"", ""data""=>""Any password, no matter how complex, can eventually be cracked.\nTherefore, passwords need to be changed periodically. If the operating system\ndoes not limit the lifetime of passwords and force users to change their\npasswords, there is the risk that the operating system passwords could be\ncompromised.""}]",0.5,[],"",SRG-OS-000076-GPOS-00044,V-89581,SV-100231r1_rule,VRAU-SL-000390,F-96323r1_fix,"[""CCI-000199""]","[""IA-5 (1) (d)"", ""Rev_4""]","","","","","","","","","","","To check that the SLES for vRealize enforces a 60-days or less
maximum password age, run the following command:

# grep PASS_MAX_DAYS /etc/login.defs | grep -v ""#""

The DoD requirement is ""60"" days or less (greater than zero, as zero days
will lock the account immediately).

If ""PASS_MAX_DAYS"" is not set to the required value, this is a finding.","To configure the SLES for vRealize to enforce a 60-day or less
maximum password age, edit the file ""/etc/login.defs"" and add or correct the
following line. Replace [DAYS] with the appropriate amount of days.

# sed -i ""/^[^#]*PASS_MAX_DAYS/ c\PASS_MAX_DAYS 60"" /etc/login.defs

The DoD requirement is ""60"" days or less (greater than zero, as zero days
will lock the account immediately).","control ""V-89581"" do
  title ""SLES for vRealize must enforce a 60-day maximum password lifetime
restriction.""
  desc  ""Any password, no matter how complex, can eventually be cracked.
Therefore, passwords need to be changed periodically. If the operating system
does not limit the lifetime of passwords and force users to change their
passwords, there is the risk that the operating system passwords could be
compromised.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000076-GPOS-00044""
  tag ""gid"": ""V-89581""
  tag ""rid"": ""SV-100231r1_rule""
  tag ""stig_id"": ""VRAU-SL-000390""
  tag ""fix_id"": ""F-96323r1_fix""
  tag ""cci"": [""CCI-000199""]
  tag ""nist"": [""IA-5 (1) (d)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To check that the SLES for vRealize enforces a 60-days or less
maximum password age, run the following command:

# grep PASS_MAX_DAYS /etc/login.defs | grep -v \""#\""

The DoD requirement is \""60\"" days or less (greater than zero, as zero days
will lock the account immediately).

If \""PASS_MAX_DAYS\"" is not set to the required value, this is a finding.""
  tag ""fix"": ""To configure the SLES for vRealize to enforce a 60-day or less
maximum password age, edit the file \""/etc/login.defs\"" and add or correct the
following line. Replace [DAYS] with the appropriate amount of days.

# sed -i \""/^[^#]*PASS_MAX_DAYS/ c\\PASS_MAX_DAYS 60\"" /etc/login.defs

The DoD requirement is \""60\"" days or less (greater than zero, as zero days
will lock the account immediately).""

describe login_defs do
  its('PASS_MAX_DAYS') { should cmp 60 }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89581.rb""}",passed,login.defs PASS_MAX_DAYS should cmp == 60,0.0008055,2019-08-01T08:47:27-07:00,""
V-89583,User passwords must be changed at least every 60 days.,"Any password, no matter how complex, can eventually be cracked.
Therefore, passwords need to be changed periodically. If the operating system
does not limit the lifetime of passwords and force users to change their
passwords, there is the risk that the operating system passwords could be
compromised.","[{""label""=>""default"", ""data""=>""Any password, no matter how complex, can eventually be cracked.\nTherefore, passwords need to be changed periodically. If the operating system\ndoes not limit the lifetime of passwords and force users to change their\npasswords, there is the risk that the operating system passwords could be\ncompromised.""}]",0.5,[],"",SRG-OS-000076-GPOS-00044,V-89583,SV-100233r1_rule,VRAU-SL-000395,F-96325r1_fix,"[""CCI-000199""]","[""IA-5 (1) (d)"", ""Rev_4""]","","","","","","","","","","","Check the max days field of /etc/shadow by running the
following command:

# cat /etc/shadow | cut -d':' -f1,5 | egrep -v ""([0|60])"" | grep -v "":$""

If any results are returned, this is a finding.","Set the maximum time period between password changes for each
[USER] account to ""60"" days. The command in the check text will give you a
list of users that need to be updated to be in compliance.

# passwd -x 60 [USER]

The DoD requirement is ""60"" days.","control ""V-89583"" do
  title ""User passwords must be changed at least every 60 days.""
  desc  ""Any password, no matter how complex, can eventually be cracked.
Therefore, passwords need to be changed periodically. If the operating system
does not limit the lifetime of passwords and force users to change their
passwords, there is the risk that the operating system passwords could be
compromised.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000076-GPOS-00044""
  tag ""gid"": ""V-89583""
  tag ""rid"": ""SV-100233r1_rule""
  tag ""stig_id"": ""VRAU-SL-000395""
  tag ""fix_id"": ""F-96325r1_fix""
  tag ""cci"": [""CCI-000199""]
  tag ""nist"": [""IA-5 (1) (d)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the max days field of /etc/shadow by running the
following command:

# cat /etc/shadow | cut -d':' -f1,5 | egrep -v \""([0|60])\"" | grep -v \"":$\""

If any results are returned, this is a finding.""
  tag ""fix"": ""Set the maximum time period between password changes for each
[USER] account to \""60\"" days. The command in the check text will give you a
list of users that need to be updated to be in compliance.

# passwd -x 60 [USER]

The DoD requirement is \""60\"" days.""

describe shadow.where { max_days != 60 } do
  its('users') { should be_empty }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89583.rb""}",failed,/etc/shadow with max_days != 60 users should be empty,0.000354,2019-08-01T08:47:27-07:00,"expected `[""bin"", ""daemon"", ""haldaemon"", ""mail"", ""man"", ""messagebus"", ""nobody"", ""polkituser"", ""postfix"", ""root""...wrun"", ""postgres"", ""tcserver"", ""rabbitmq"", ""ntp"", ""vcac"", ""vco"", ""horizon"", ""epmd"", ""elasticsearch""].empty?` to return true, got false"
V-89585,"The SLES for vRealize must prohibit password reuse for a minimum of
five generations.","Password complexity, or strength, is a measure of the effectiveness of
a password in resisting attempts at guessing and brute-force attacks. If the
information system or application allows the user to consecutively reuse their
password when that password has exceeded its defined lifetime, the end result
is a password that is not changed as per policy requirements.","[{""label""=>""default"", ""data""=>""Password complexity, or strength, is a measure of the effectiveness of\na password in resisting attempts at guessing and brute-force attacks. If the\ninformation system or application allows the user to consecutively reuse their\npassword when that password has exceeded its defined lifetime, the end result\nis a password that is not changed as per policy requirements.""}]",0.5,[],"",SRG-OS-000077-GPOS-00045,V-89585,SV-100235r1_rule,VRAU-SL-000400,F-96327r1_fix,"[""CCI-000200""]","[""IA-5 (1) (e)"", ""Rev_4""]","","","","","","","","","","","Verify that the SLES for vRealize prohibits the reuse of a
password for a minimum of five generations by running the following commands:

# grep pam_pwhistory.so /etc/pam.d/common-password-vmware.local

If the ""remember"" option in /etc/pam.d/common-password-vmware.local is not
""5"" or greater, this is a finding.","Configure pam to use password history.

If ""remember"" was not set at all in /etc/pam.d/common-password-vmware.local,
run the following command:

# sed -i '/pam_cracklib.so/ s/$/ remember=5/'
/etc/pam.d/common-password-vmware.local

If ""remember"" was set incorrectly, run the following command to set it to
""5"":

# sed -i '/pam_cracklib.so/ s/remember=./remember=5/'
/etc/pam.d/common-password-vmware.local","control ""V-89585"" do
  title ""The SLES for vRealize must prohibit password reuse for a minimum of
five generations.""
  desc  ""Password complexity, or strength, is a measure of the effectiveness of
a password in resisting attempts at guessing and brute-force attacks. If the
information system or application allows the user to consecutively reuse their
password when that password has exceeded its defined lifetime, the end result
is a password that is not changed as per policy requirements.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000077-GPOS-00045""
  tag ""gid"": ""V-89585""
  tag ""rid"": ""SV-100235r1_rule""
  tag ""stig_id"": ""VRAU-SL-000400""
  tag ""fix_id"": ""F-96327r1_fix""
  tag ""cci"": [""CCI-000200""]
  tag ""nist"": [""IA-5 (1) (e)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that the SLES for vRealize prohibits the reuse of a
password for a minimum of five generations by running the following commands:

# grep pam_pwhistory.so /etc/pam.d/common-password-vmware.local

If the \""remember\"" option in /etc/pam.d/common-password-vmware.local is not
\""5\"" or greater, this is a finding.""
  tag ""fix"": ""Configure pam to use password history.

If \""remember\"" was not set at all in /etc/pam.d/common-password-vmware.local,
run the following command:

# sed -i '/pam_cracklib.so/ s/$/ remember=5/'
/etc/pam.d/common-password-vmware.local

If \""remember\"" was set incorrectly, run the following command to set it to
\""5\"":

# sed -i '/pam_cracklib.so/ s/remember=./remember=5/'
/etc/pam.d/common-password-vmware.local""

describe file('/etc/pam.d/common-password-vmware.local') do
  its('content') {should match %r{remember=5} }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89585.rb""}",passed,File /etc/pam.d/common-password-vmware.local content should match /remember=5/,0.0001364,2019-08-01T08:47:27-07:00,""
V-89587,"The SLES for vRealize must prohibit password reuse for a minimum of
five generations - old passwords are being stored.","Password complexity, or strength, is a measure of the effectiveness of
a password in resisting attempts at guessing and brute-force attacks. If the
information system or application allows the user to consecutively reuse their
password when that password has exceeded its defined lifetime, the end result
is a password that is not changed as per policy requirements.","[{""label""=>""default"", ""data""=>""Password complexity, or strength, is a measure of the effectiveness of\na password in resisting attempts at guessing and brute-force attacks. If the\ninformation system or application allows the user to consecutively reuse their\npassword when that password has exceeded its defined lifetime, the end result\nis a password that is not changed as per policy requirements.""}]",0.5,[],"",SRG-OS-000077-GPOS-00045,V-89587,SV-100237r1_rule,VRAU-SL-000405,F-96329r2_fix,"[""CCI-000200""]","[""IA-5 (1) (e)"", ""Rev_4""]","","","","","","","","","","","Verify that the old password file ""opasswd"" exists, by
running the following command:

# ls /etc/security/opasswd

If ""/etc/security/opasswd"" does not exist, this is a finding.","Create the password history file.

# touch /etc/security/opasswd
# chown root:root /etc/security/opasswd
# chmod 0600 /etc/security/opasswd","control ""V-89587"" do
  title ""The SLES for vRealize must prohibit password reuse for a minimum of
five generations - old passwords are being stored.""
  desc  ""Password complexity, or strength, is a measure of the effectiveness of
a password in resisting attempts at guessing and brute-force attacks. If the
information system or application allows the user to consecutively reuse their
password when that password has exceeded its defined lifetime, the end result
is a password that is not changed as per policy requirements.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000077-GPOS-00045""
  tag ""gid"": ""V-89587""
  tag ""rid"": ""SV-100237r1_rule""
  tag ""stig_id"": ""VRAU-SL-000405""
  tag ""fix_id"": ""F-96329r2_fix""
  tag ""cci"": [""CCI-000200""]
  tag ""nist"": [""IA-5 (1) (e)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that the old password file \""opasswd\"" exists, by
running the following command:

# ls /etc/security/opasswd

If \""/etc/security/opasswd\"" does not exist, this is a finding.""
  tag ""fix"": ""Create the password history file.

# touch /etc/security/opasswd
# chown root:root /etc/security/opasswd
# chmod 0600 /etc/security/opasswd""

describe file('/etc/security/opasswd') do
  it { should exist }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89587.rb""}",passed,File /etc/security/opasswd should exist,0.1655676,2019-08-01T08:47:27-07:00,""
V-89589,"The SLES for vRealize must enforce a minimum 15-character password
length.","The shorter the password, the lower the number of possible
combinations that need to be tested before the password is compromised.

    Password complexity, or strength, is a measure of the effectiveness of a
password in resisting attempts at guessing and brute-force attacks. Password
length is one factor of several that helps to determine strength and how long
it takes to crack a password. Use of more characters in a password helps to
exponentially increase the time and/or resources required to compromise the
password.","[{""label""=>""default"", ""data""=>""The shorter the password, the lower the number of possible\ncombinations that need to be tested before the password is compromised.\n\n    Password complexity, or strength, is a measure of the effectiveness of a\npassword in resisting attempts at guessing and brute-force attacks. Password\nlength is one factor of several that helps to determine strength and how long\nit takes to crack a password. Use of more characters in a password helps to\nexponentially increase the time and/or resources required to compromise the\npassword.""}]",0.5,[],"",SRG-OS-000078-GPOS-00046,V-89589,SV-100239r1_rule,VRAU-SL-000410,F-96331r1_fix,"[""CCI-000205""]","[""IA-5 (1) (a)"", ""Rev_4""]","","","","","","","","","","","Verify that the SLES for vRealize enforces a minimum
15-character password length by running the following command:

# grep pam_cracklib /etc/pam.d/common-password-vmware.local

# grep pam_cracklib /etc/pam.d/common-password

If ""minlen"" is not set to ""15"" or higher, this is a finding.","If ""minlen"" was not set at all in
/etc/pam.d/common-password-vmware.local, run the following command:

# sed -i '/pam_cracklib.so/ s/$/ minlen=15/'
/etc/pam.d/common-password-vmware.local

If ""minlen"" was set incorrectly then run the following command to set it to
""15"":

# sed -i '/pam_cracklib.so/ s/minlen=../minlen=15/'
/etc/pam.d/common-password-vmware.local","control ""V-89589"" do
  title ""The SLES for vRealize must enforce a minimum 15-character password
length.""
  desc  ""The shorter the password, the lower the number of possible
combinations that need to be tested before the password is compromised.

    Password complexity, or strength, is a measure of the effectiveness of a
password in resisting attempts at guessing and brute-force attacks. Password
length is one factor of several that helps to determine strength and how long
it takes to crack a password. Use of more characters in a password helps to
exponentially increase the time and/or resources required to compromise the
password.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000078-GPOS-00046""
  tag ""gid"": ""V-89589""
  tag ""rid"": ""SV-100239r1_rule""
  tag ""stig_id"": ""VRAU-SL-000410""
  tag ""fix_id"": ""F-96331r1_fix""
  tag ""cci"": [""CCI-000205""]
  tag ""nist"": [""IA-5 (1) (a)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that the SLES for vRealize enforces a minimum
15-character password length by running the following command:

# grep pam_cracklib /etc/pam.d/common-password-vmware.local

# grep pam_cracklib /etc/pam.d/common-password

If \""minlen\"" is not set to \""15\"" or higher, this is a finding.""
  tag ""fix"": ""If \""minlen\"" was not set at all in
/etc/pam.d/common-password-vmware.local, run the following command:

# sed -i '/pam_cracklib.so/ s/$/ minlen=15/'
/etc/pam.d/common-password-vmware.local

If \""minlen\"" was set incorrectly then run the following command to set it to
\""15\"":

# sed -i '/pam_cracklib.so/ s/minlen=../minlen=15/'
/etc/pam.d/common-password-vmware.local""

describe file('/etc/pam.d/common-password-vmware.local') do
  its('content') {should match %r{minlen=15} }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89589.rb""}",passed,File /etc/pam.d/common-password-vmware.local content should match /minlen=15/,0.0002347,2019-08-01T08:47:27-07:00,""
V-89591,"The system must require root password authentication upon booting into
single-user mode.","To mitigate the risk of unauthorized access to sensitive information
by entities that have been issued certificates by DoD-approved PKIs, all DoD
systems (e.g., web servers and web portals) must be properly configured to
incorporate access control methods that do not rely solely on the possession of
a certificate for access. Successful authentication must not automatically give
an entity access to an asset or security boundary. Authorization procedures and
controls must be implemented to ensure each authenticated entity also has a
validated and current authorization. Authorization is the process of
determining whether an entity, once authenticated, is permitted to access a
specific asset. Information systems use access control policies and enforcement
mechanisms to implement this requirement.

    Access control policies include: identity-based policies, role-based
policies, and attribute-based policies. Access enforcement mechanisms include:
access control lists, access control matrices, and cryptography. These policies
and mechanisms must be employed by the application to control access between
users (or processes acting on behalf of users) and objects (e.g., devices,
files, records, processes, programs, and domains) in the information system.","[{""label""=>""default"", ""data""=>""To mitigate the risk of unauthorized access to sensitive information\nby entities that have been issued certificates by DoD-approved PKIs, all DoD\nsystems (e.g., web servers and web portals) must be properly configured to\nincorporate access control methods that do not rely solely on the possession of\na certificate for access. Successful authentication must not automatically give\nan entity access to an asset or security boundary. Authorization procedures and\ncontrols must be implemented to ensure each authenticated entity also has a\nvalidated and current authorization. Authorization is the process of\ndetermining whether an entity, once authenticated, is permitted to access a\nspecific asset. Information systems use access control policies and enforcement\nmechanisms to implement this requirement.\n\n    Access control policies include: identity-based policies, role-based\npolicies, and attribute-based policies. Access enforcement mechanisms include:\naccess control lists, access control matrices, and cryptography. These policies\nand mechanisms must be employed by the application to control access between\nusers (or processes acting on behalf of users) and objects (e.g., devices,\nfiles, records, processes, programs, and domains) in the information system.""}]",0.5,[],"",SRG-OS-000080-GPOS-00048,V-89591,SV-100241r1_rule,VRAU-SL-000420,F-96333r1_fix,"[""CCI-000213""]","[""AC-3"", ""Rev_4""]","","","","","","","","","","","Verify that root password is required for single user mode
login with the following command:

# grep sulogin /etc/inittab

Expected result:
~~:S:respawn:/sbin/sulogin

If the expected result is not displayed, this is a finding.","Configure the system to require root password login with single
user mode use the following command:

# echo '~~:S:respawn:/sbin/sulogin' >> /etc/inittab","control ""V-89591"" do
  title ""The system must require root password authentication upon booting into
single-user mode.""
  desc  ""To mitigate the risk of unauthorized access to sensitive information
by entities that have been issued certificates by DoD-approved PKIs, all DoD
systems (e.g., web servers and web portals) must be properly configured to
incorporate access control methods that do not rely solely on the possession of
a certificate for access. Successful authentication must not automatically give
an entity access to an asset or security boundary. Authorization procedures and
controls must be implemented to ensure each authenticated entity also has a
validated and current authorization. Authorization is the process of
determining whether an entity, once authenticated, is permitted to access a
specific asset. Information systems use access control policies and enforcement
mechanisms to implement this requirement.

    Access control policies include: identity-based policies, role-based
policies, and attribute-based policies. Access enforcement mechanisms include:
access control lists, access control matrices, and cryptography. These policies
and mechanisms must be employed by the application to control access between
users (or processes acting on behalf of users) and objects (e.g., devices,
files, records, processes, programs, and domains) in the information system.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000080-GPOS-00048""
  tag ""gid"": ""V-89591""
  tag ""rid"": ""SV-100241r1_rule""
  tag ""stig_id"": ""VRAU-SL-000420""
  tag ""fix_id"": ""F-96333r1_fix""
  tag ""cci"": [""CCI-000213""]
  tag ""nist"": [""AC-3"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that root password is required for single user mode
login with the following command:

# grep sulogin /etc/inittab

Expected result:
~~:S:respawn:/sbin/sulogin

If the expected result is not displayed, this is a finding.""
  tag ""fix"": ""Configure the system to require root password login with single
user mode use the following command:

# echo '~~:S:respawn:/sbin/sulogin' >> /etc/inittab""

describe file('/etc/inittab') do
  its ('content') {should match %r{~~:S:respawn:/sbin/sulogin} }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89591.rb""}",passed,File /etc/inittab content should match /~~:S:respawn:\/sbin\/sulogin/,0.166976,2019-08-01T08:47:27-07:00,""
V-89593,"Bootloader authentication must be enabled to prevent users without
privilege to gain access to restricted file system resources.","To mitigate the risk of unauthorized access to sensitive information
by entities that have been issued certificates by DoD-approved PKIs, all DoD
systems (e.g., web servers and web portals) must be properly configured to
incorporate access control methods that do not rely solely on the possession of
a certificate for access. Successful authentication must not automatically give
an entity access to an asset or security boundary. Authorization procedures and
controls must be implemented to ensure each authenticated entity also has a
validated and current authorization. Authorization is the process of
determining whether an entity, once authenticated, is permitted to access a
specific asset. Information systems use access control policies and enforcement
mechanisms to implement this requirement.

    Access control policies include identity-based policies, role-based
policies, and attribute-based policies. Access enforcement mechanisms include
access control lists, access control matrices, and cryptography. These policies
and mechanisms must be employed by the application to control access between
users (or processes acting on behalf of users) and objects (e.g., devices,
files, records, processes, programs, and domains) in the information system.","[{""label""=>""default"", ""data""=>""To mitigate the risk of unauthorized access to sensitive information\nby entities that have been issued certificates by DoD-approved PKIs, all DoD\nsystems (e.g., web servers and web portals) must be properly configured to\nincorporate access control methods that do not rely solely on the possession of\na certificate for access. Successful authentication must not automatically give\nan entity access to an asset or security boundary. Authorization procedures and\ncontrols must be implemented to ensure each authenticated entity also has a\nvalidated and current authorization. Authorization is the process of\ndetermining whether an entity, once authenticated, is permitted to access a\nspecific asset. Information systems use access control policies and enforcement\nmechanisms to implement this requirement.\n\n    Access control policies include identity-based policies, role-based\npolicies, and attribute-based policies. Access enforcement mechanisms include\naccess control lists, access control matrices, and cryptography. These policies\nand mechanisms must be employed by the application to control access between\nusers (or processes acting on behalf of users) and objects (e.g., devices,\nfiles, records, processes, programs, and domains) in the information system.""}]",0.5,[],"",SRG-OS-000080-GPOS-00048,V-89593,SV-100243r1_rule,VRAU-SL-000425,F-96335r1_fix,"[""CCI-000213""]","[""AC-3"", ""Rev_4""]","","","","","","","","","","","To verify a boot password exists, in /boot/grub/menu.lst run
the following command:

# grep password /boot/grub/menu.lst

The output should show the following:

password --encrypted $1$[rest-of-the-password-hash]

If it does not, this is a finding.","Run the following command:

# /usr/sbin/grub-md5-crypt

An MD5 password is generated. After the password is supplied, the command
supplies the md5 hash output.

Append the password to the ""menu.lst"" file by running the following command:

echo 'password --md5 <hash from grub-md5-crypt>' >> /boot/grub/menu.lst

Or use yast2 to set the bootloader password.

Open the Boot Loader Installation tab.

Click ""Boot Loader Options"".

Activate the Protect Boot Loader with Password option with a click and type in
the password twice.

Click ""OK"" twice to save the changes.","control ""V-89593"" do
  title ""Bootloader authentication must be enabled to prevent users without
privilege to gain access to restricted file system resources.""
  desc  ""To mitigate the risk of unauthorized access to sensitive information
by entities that have been issued certificates by DoD-approved PKIs, all DoD
systems (e.g., web servers and web portals) must be properly configured to
incorporate access control methods that do not rely solely on the possession of
a certificate for access. Successful authentication must not automatically give
an entity access to an asset or security boundary. Authorization procedures and
controls must be implemented to ensure each authenticated entity also has a
validated and current authorization. Authorization is the process of
determining whether an entity, once authenticated, is permitted to access a
specific asset. Information systems use access control policies and enforcement
mechanisms to implement this requirement.

    Access control policies include identity-based policies, role-based
policies, and attribute-based policies. Access enforcement mechanisms include
access control lists, access control matrices, and cryptography. These policies
and mechanisms must be employed by the application to control access between
users (or processes acting on behalf of users) and objects (e.g., devices,
files, records, processes, programs, and domains) in the information system.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000080-GPOS-00048""
  tag ""gid"": ""V-89593""
  tag ""rid"": ""SV-100243r1_rule""
  tag ""stig_id"": ""VRAU-SL-000425""
  tag ""fix_id"": ""F-96335r1_fix""
  tag ""cci"": [""CCI-000213""]
  tag ""nist"": [""AC-3"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To verify a boot password exists, in /boot/grub/menu.lst run
the following command:

# grep password /boot/grub/menu.lst

The output should show the following:

password --encrypted $1$[rest-of-the-password-hash]

If it does not, this is a finding.""
  tag ""fix"": ""Run the following command:

# /usr/sbin/grub-md5-crypt

An MD5 password is generated. After the password is supplied, the command
supplies the md5 hash output.

Append the password to the \""menu.lst\"" file by running the following command:

echo 'password --md5 <hash from grub-md5-crypt>' >> /boot/grub/menu.lst

Or use yast2 to set the bootloader password.

Open the Boot Loader Installation tab.

Click \""Boot Loader Options\"".

Activate the Protect Boot Loader with Password option with a click and type in
the password twice.

Click \""OK\"" twice to save the changes.""

describe file('/boot/grub/menu.lst') do
  its('content') { should match(%r{^password\s--md5\s\$1\$}) }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89593.rb""}",passed,File /boot/grub/menu.lst content should match /^password\s--md5\s\$1\$/,0.1910279,2019-08-01T08:47:27-07:00,""
V-89595,"The system boot loader configuration file(s) must have mode 0600 or
less permissive.","File permissions more permissive than 0600 on boot loader
configuration files could allow an unauthorized user to view or modify
sensitive information pertaining to system boot instructions.","[{""label""=>""default"", ""data""=>""File permissions more permissive than 0600 on boot loader\nconfiguration files could allow an unauthorized user to view or modify\nsensitive information pertaining to system boot instructions.""}]",0.5,[],"",SRG-OS-000080-GPOS-00048,V-89595,SV-100245r1_rule,VRAU-SL-000430,F-96337r1_fix,"[""CCI-000213""]","[""AC-3"", ""Rev_4""]","","","","","","","","","","","Check the /boot/grub/menu.lst file:

# stat /boot/grub/menu.lst

If /boot/grub/menu.lst has a mode more permissive than ""0600"", this is a
finding.","Change the mode of the menu.lst file to ""0600"":

# chmod 0600 /boot/grub/menu.lst","control ""V-89595"" do
  title ""The system boot loader configuration file(s) must have mode 0600 or
less permissive.""
  desc  ""File permissions more permissive than 0600 on boot loader
configuration files could allow an unauthorized user to view or modify
sensitive information pertaining to system boot instructions.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000080-GPOS-00048""
  tag ""gid"": ""V-89595""
  tag ""rid"": ""SV-100245r1_rule""
  tag ""stig_id"": ""VRAU-SL-000430""
  tag ""fix_id"": ""F-96337r1_fix""
  tag ""cci"": [""CCI-000213""]
  tag ""nist"": [""AC-3"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the /boot/grub/menu.lst file:

# stat /boot/grub/menu.lst

If /boot/grub/menu.lst has a mode more permissive than \""0600\"", this is a
finding.""
  tag ""fix"": ""Change the mode of the menu.lst file to \""0600\"":

# chmod 0600 /boot/grub/menu.lst""

describe file('/boot/grub/menu.lst') do
  it { should_not be_more_permissive_than('0600') }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89595.rb""}",passed,"File /boot/grub/menu.lst should not be more permissive than ""0600""",0.3426599,2019-08-01T08:47:28-07:00,""
V-89597,The system boot loader configuration files must be owned by root.,"The system's boot loader configuration files are critical to the
integrity of the system and must be protected. Unauthorized modification of
these files resulting from improper ownership could compromise the system's
boot loader configuration.","[{""label""=>""default"", ""data""=>""The system's boot loader configuration files are critical to the\nintegrity of the system and must be protected. Unauthorized modification of\nthese files resulting from improper ownership could compromise the system's\nboot loader configuration.""}]",0.5,[],"",SRG-OS-000080-GPOS-00048,V-89597,SV-100247r1_rule,VRAU-SL-000435,F-96339r1_fix,"[""CCI-000213""]","[""AC-3"", ""Rev_4""]","","","","","","","","","","","Check /boot/grub/menu.lst ownership:

# stat /boot/grub/menu.lst

If the owner of the file is not ""root"", this is a finding.","Change the ownership of the file:

# chown root /boot/grub/menu.lst","control ""V-89597"" do
  title ""The system boot loader configuration files must be owned by root.""
  desc  ""The system's boot loader configuration files are critical to the
integrity of the system and must be protected. Unauthorized modification of
these files resulting from improper ownership could compromise the system's
boot loader configuration.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000080-GPOS-00048""
  tag ""gid"": ""V-89597""
  tag ""rid"": ""SV-100247r1_rule""
  tag ""stig_id"": ""VRAU-SL-000435""
  tag ""fix_id"": ""F-96339r1_fix""
  tag ""cci"": [""CCI-000213""]
  tag ""nist"": [""AC-3"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check /boot/grub/menu.lst ownership:

# stat /boot/grub/menu.lst

If the owner of the file is not \""root\"", this is a finding.""
  tag ""fix"": ""Change the ownership of the file:

# chown root /boot/grub/menu.lst""

describe file('/boot/grub/menu.lst') do
  its('owner'){should cmp 'root'}
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89597.rb""}",passed,"File /boot/grub/menu.lst owner should cmp == ""root""",0.0002855,2019-08-01T08:47:28-07:00,""
V-89599,"The system boot loader configuration file(s) must be group-owned by
root, bin, sys, or system.","The system's boot loader configuration files are critical to the
integrity of the system and must be protected. Unauthorized modifications
resulting from improper group-ownership may compromise the boot loader
configuration.","[{""label""=>""default"", ""data""=>""The system's boot loader configuration files are critical to the\nintegrity of the system and must be protected. Unauthorized modifications\nresulting from improper group-ownership may compromise the boot loader\nconfiguration.""}]",0.5,[],"",SRG-OS-000080-GPOS-00048,V-89599,SV-100249r1_rule,VRAU-SL-000440,F-96341r1_fix,"[""CCI-000213""]","[""AC-3"", ""Rev_4""]","","","","","","","","","","","Check /boot/grub/menu.lst ownership:

# stat /boot/grub/menu.lst

If the group-owner of the file is not ""root"", ""bin"", ""sys"", or
""system"", this is a finding.","Change the group-ownership of the file:

# chgrp root /boot/grub/menu.lst","control ""V-89599"" do
  title ""The system boot loader configuration file(s) must be group-owned by
root, bin, sys, or system.""
  desc  ""The system's boot loader configuration files are critical to the
integrity of the system and must be protected. Unauthorized modifications
resulting from improper group-ownership may compromise the boot loader
configuration.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000080-GPOS-00048""
  tag ""gid"": ""V-89599""
  tag ""rid"": ""SV-100249r1_rule""
  tag ""stig_id"": ""VRAU-SL-000440""
  tag ""fix_id"": ""F-96341r1_fix""
  tag ""cci"": [""CCI-000213""]
  tag ""nist"": [""AC-3"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check /boot/grub/menu.lst ownership:

# stat /boot/grub/menu.lst

If the group-owner of the file is not \""root\"", \""bin\"", \""sys\"", or
\""system\"", this is a finding.""
  tag ""fix"": ""Change the group-ownership of the file:

# chgrp root /boot/grub/menu.lst""

describe file('/boot/grub/menu.lst') do
  its('group'){should cmp 'root'}
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89599.rb""}",passed,"File /boot/grub/menu.lst group should cmp == ""root""",0.0001853,2019-08-01T08:47:28-07:00,""
V-89601,The Bluetooth protocol handler must be disabled or not installed.,"Bluetooth is a personal area network (PAN) technology. Binding this
protocol to the network stack increases the attack surface of the host.
Unprivileged local processes may be able to cause the kernel to dynamically
load a protocol handler by opening a socket using the protocol.","[{""label""=>""default"", ""data""=>""Bluetooth is a personal area network (PAN) technology. Binding this\nprotocol to the network stack increases the attack surface of the host.\nUnprivileged local processes may be able to cause the kernel to dynamically\nload a protocol handler by opening a socket using the protocol.""}]",0.5,[],"",SRG-OS-000095-GPOS-00049,V-89601,SV-100251r1_rule,VRAU-SL-000445,F-96343r1_fix,"[""CCI-000381""]","[""CM-7 a"", ""Rev_4""]","","","","","","","","","","","Verify the Bluetooth protocol handler is prevented from dynamic
loading:

# grep ""install bluetooth /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*

If no result is returned, this is a finding.","Prevent the Bluetooth protocol handler for dynamic loading:

# echo ""install bluetooth /bin/true"" >> /etc/modprobe.conf.local","control ""V-89601"" do
  title ""The Bluetooth protocol handler must be disabled or not installed.""
  desc  ""Bluetooth is a personal area network (PAN) technology. Binding this
protocol to the network stack increases the attack surface of the host.
Unprivileged local processes may be able to cause the kernel to dynamically
load a protocol handler by opening a socket using the protocol.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000095-GPOS-00049""
  tag ""gid"": ""V-89601""
  tag ""rid"": ""SV-100251r1_rule""
  tag ""stig_id"": ""VRAU-SL-000445""
  tag ""fix_id"": ""F-96343r1_fix""
  tag ""cci"": [""CCI-000381""]
  tag ""nist"": [""CM-7 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the Bluetooth protocol handler is prevented from dynamic
loading:

# grep \""install bluetooth /bin/true\"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*

If no result is returned, this is a finding.""
  tag ""fix"": ""Prevent the Bluetooth protocol handler for dynamic loading:

# echo \""install bluetooth /bin/true\"" >> /etc/modprobe.conf.local""

describe command('grep ""install bluetooth /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*') do
  its('stdout') {should_not eq ''}
end


end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89601.rb""}",passed,"Command: `grep ""install bluetooth /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*` stdout should not eq """"",0.166845,2019-08-01T08:47:28-07:00,""
V-89603,The system must have USB Mass Storage disabled unless needed.,"USB is a common computer peripheral interface. USB devices may include
storage devices that could be used to install malicious software on a system or
exfiltrate data.","[{""label""=>""default"", ""data""=>""USB is a common computer peripheral interface. USB devices may include\nstorage devices that could be used to install malicious software on a system or\nexfiltrate data.""}]",0.5,[],"",SRG-OS-000095-GPOS-00049,V-89603,SV-100253r1_rule,VRAU-SL-000450,F-96345r1_fix,"[""CCI-000381""]","[""CM-7 a"", ""Rev_4""]","","","","","","","","","","","If the system needs USB storage, this vulnerability is not
applicable.

Check if ""usb-storage"" is prevented from loading:

# grep ""install usb-storage /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*

If no results are returned, this is a finding.","Prevent the ""usb-storage"" module from loading:

# echo ""install usb-storage /bin/true"" >> /etc/modprobe.conf.local","control ""V-89603"" do
  title ""The system must have USB Mass Storage disabled unless needed.""
  desc  ""USB is a common computer peripheral interface. USB devices may include
storage devices that could be used to install malicious software on a system or
exfiltrate data.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000095-GPOS-00049""
  tag ""gid"": ""V-89603""
  tag ""rid"": ""SV-100253r1_rule""
  tag ""stig_id"": ""VRAU-SL-000450""
  tag ""fix_id"": ""F-96345r1_fix""
  tag ""cci"": [""CCI-000381""]
  tag ""nist"": [""CM-7 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""If the system needs USB storage, this vulnerability is not
applicable.

Check if \""usb-storage\"" is prevented from loading:

# grep \""install usb-storage /bin/true\"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*

If no results are returned, this is a finding.""
  tag ""fix"": ""Prevent the \""usb-storage\"" module from loading:

# echo \""install usb-storage /bin/true\"" >> /etc/modprobe.conf.local""

describe command('grep ""usb-storage /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*') do
  its('stdout') {should_not eq ''}
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89603.rb""}",passed,"Command: `grep ""usb-storage /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*` stdout should not eq """"",0.1569527,2019-08-01T08:47:28-07:00,""
V-89605,The system must have USB disabled unless needed.,"USB is a common computer peripheral interface. USB devices may include
storage devices that could be used to install malicious software on a system or
exfiltrate data.","[{""label""=>""default"", ""data""=>""USB is a common computer peripheral interface. USB devices may include\nstorage devices that could be used to install malicious software on a system or\nexfiltrate data.""}]",0.5,[],"",SRG-OS-000095-GPOS-00049,V-89605,SV-100255r1_rule,VRAU-SL-000455,F-96347r1_fix,"[""CCI-000381""]","[""CM-7 a"", ""Rev_4""]","","","","","","","","","","","If the system needs USB, this vulnerability is not applicable.

Check if the directory /proc/bus/usb exists.

If the directory /proc/bus/usb exists, this is a finding.","Edit the grub bootloader file /boot/grub/menu.lst by appending
the ""nousb"" parameter to the kernel boot line.","control ""V-89605"" do
  title ""The system must have USB disabled unless needed.""
  desc  ""USB is a common computer peripheral interface. USB devices may include
storage devices that could be used to install malicious software on a system or
exfiltrate data.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000095-GPOS-00049""
  tag ""gid"": ""V-89605""
  tag ""rid"": ""SV-100255r1_rule""
  tag ""stig_id"": ""VRAU-SL-000455""
  tag ""fix_id"": ""F-96347r1_fix""
  tag ""cci"": [""CCI-000381""]
  tag ""nist"": [""CM-7 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""If the system needs USB, this vulnerability is not applicable.

Check if the directory /proc/bus/usb exists.

If the directory /proc/bus/usb exists, this is a finding.""
  tag ""fix"": ""Edit the grub bootloader file /boot/grub/menu.lst by appending
the \""nousb\"" parameter to the kernel boot line.""

describe directory('/proc/bus/usb') do
  it{should_not exist}
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89605.rb""}",passed,Directory /proc/bus/usb should not exist,0.1672399,2019-08-01T08:47:28-07:00,""
V-89607,The telnet-server package must not be installed.,"Removing the ""telnet-server"" package decreases the risk of the
unencrypted telnet service's accidental (or intentional) activation.","[{""label""=>""default"", ""data""=>""Removing the \""telnet-server\"" package decreases the risk of the\nunencrypted telnet service's accidental (or intentional) activation.""}]",0.5,[],"",SRG-OS-000095-GPOS-00049,V-89607,SV-100257r1_rule,VRAU-SL-000460,F-96349r1_fix,"[""CCI-000381""]","[""CM-7 a"", ""Rev_4""]","","","","","","","","","","","Check if ""telnet-server"" is installed:

# rpm -q telnet-server

If there is a ""telnet-server"" package listed, this is a finding.","To remove the ""telnet-server"" package use the following command:

rpm -e telnet-server","control ""V-89607"" do
  title ""The telnet-server package must not be installed.""
  desc  ""Removing the \""telnet-server\"" package decreases the risk of the
unencrypted telnet service's accidental (or intentional) activation.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000095-GPOS-00049""
  tag ""gid"": ""V-89607""
  tag ""rid"": ""SV-100257r1_rule""
  tag ""stig_id"": ""VRAU-SL-000460""
  tag ""fix_id"": ""F-96349r1_fix""
  tag ""cci"": [""CCI-000381""]
  tag ""nist"": [""CM-7 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check if \""telnet-server\"" is installed:

# rpm -q telnet-server

If there is a \""telnet-server\"" package listed, this is a finding.""
  tag ""fix"": ""To remove the \""telnet-server\"" package use the following command:

rpm -e telnet-server""

describe package('telnet-server') do
  it { should_not be_installed }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89607.rb""}",passed,System Package telnet-server should not be installed,0.1675709,2019-08-01T08:47:28-07:00,""
V-89609,The rsh-server package must not be installed.,"The ""rsh-server"" package provides several obsolete and insecure
network services. Removing it decreases the risk of accidental (or intentional)
activation of those services.","[{""label""=>""default"", ""data""=>""The \""rsh-server\"" package provides several obsolete and insecure\nnetwork services. Removing it decreases the risk of accidental (or intentional)\nactivation of those services.""}]",0.5,[],"",SRG-OS-000095-GPOS-00049,V-89609,SV-100259r1_rule,VRAU-SL-000465,F-96351r1_fix,"[""CCI-000381""]","[""CM-7 a"", ""Rev_4""]","","","","","","","","","","","Check if ""rsh-server"" is installed:

# rpm -q rsh-server

If an ""rsh-server"" package is listed, this is a finding.","To remove the ""telnet-server"" package, use the following
command:

rpm -e rsh-server","control ""V-89609"" do
  title ""The rsh-server package must not be installed.""
  desc  ""The \""rsh-server\"" package provides several obsolete and insecure
network services. Removing it decreases the risk of accidental (or intentional)
activation of those services.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000095-GPOS-00049""
  tag ""gid"": ""V-89609""
  tag ""rid"": ""SV-100259r1_rule""
  tag ""stig_id"": ""VRAU-SL-000465""
  tag ""fix_id"": ""F-96351r1_fix""
  tag ""cci"": [""CCI-000381""]
  tag ""nist"": [""CM-7 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check if \""rsh-server\"" is installed:

# rpm -q rsh-server

If an \""rsh-server\"" package is listed, this is a finding.""
  tag ""fix"": ""To remove the \""telnet-server\"" package, use the following
command:

rpm -e rsh-server""

describe package('rsh-server') do
  it { should_not be_installed }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89609.rb""}",passed,System Package rsh-server should not be installed,0.1668722,2019-08-01T08:47:29-07:00,""
V-89611,The ypserv package must not be installed.,"Removing the ""ypserv"" package decreases the risk of the accidental
(or intentional) activation of NIS or NIS+ services.","[{""label""=>""default"", ""data""=>""Removing the \""ypserv\"" package decreases the risk of the accidental\n(or intentional) activation of NIS or NIS+ services.""}]",0.5,[],"",SRG-OS-000095-GPOS-00049,V-89611,SV-100261r1_rule,VRAU-SL-000470,F-96353r1_fix,"[""CCI-000381""]","[""CM-7 a"", ""Rev_4""]","","","","","","","","","","","Check if ""ypserv"" is installed:

# rpm -q ypserv

If there is a ""ypserv"" package listed, this is a finding.","To remove the ""telnet-server"" package use the following command:

rpm -e ypserv","control ""V-89611"" do
  title ""The ypserv package must not be installed.""
  desc  ""Removing the \""ypserv\"" package decreases the risk of the accidental
(or intentional) activation of NIS or NIS+ services.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000095-GPOS-00049""
  tag ""gid"": ""V-89611""
  tag ""rid"": ""SV-100261r1_rule""
  tag ""stig_id"": ""VRAU-SL-000470""
  tag ""fix_id"": ""F-96353r1_fix""
  tag ""cci"": [""CCI-000381""]
  tag ""nist"": [""CM-7 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check if \""ypserv\"" is installed:

# rpm -q ypserv

If there is a \""ypserv\"" package listed, this is a finding.""
  tag ""fix"": ""To remove the \""telnet-server\"" package use the following command:

rpm -e ypserv""

describe package('ypserv') do
  it { should_not be_installed }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89611.rb""}",passed,System Package ypserv should not be installed,0.1766712,2019-08-01T08:47:29-07:00,""
V-89613,The yast2-tftp-server package must not be installed.,"Removing the ""yast2-tftp-server"" package decreases the risk of the
accidental (or intentional) activation of tftp services.","[{""label""=>""default"", ""data""=>""Removing the \""yast2-tftp-server\"" package decreases the risk of the\naccidental (or intentional) activation of tftp services.""}]",0.5,[],"",SRG-OS-000095-GPOS-00049,V-89613,SV-100263r1_rule,VRAU-SL-000475,F-96355r1_fix,"[""CCI-000381""]","[""CM-7 a"", ""Rev_4""]","","","","","","","","","","","Check if ""yast2-tftp-server"" is installed:

# rpm -q yast2-tftp-server

If a ""yast2-tftp-server"" package is listed, this is a finding.","To remove the ""yast2-tftp-server"" package, use the following
command:

rpm -e yast2-tftp-server","control ""V-89613"" do
  title ""The yast2-tftp-server package must not be installed.""
  desc  ""Removing the \""yast2-tftp-server\"" package decreases the risk of the
accidental (or intentional) activation of tftp services.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000095-GPOS-00049""
  tag ""gid"": ""V-89613""
  tag ""rid"": ""SV-100263r1_rule""
  tag ""stig_id"": ""VRAU-SL-000475""
  tag ""fix_id"": ""F-96355r1_fix""
  tag ""cci"": [""CCI-000381""]
  tag ""nist"": [""CM-7 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check if \""yast2-tftp-server\"" is installed:

# rpm -q yast2-tftp-server

If a \""yast2-tftp-server\"" package is listed, this is a finding.""
  tag ""fix"": ""To remove the \""yast2-tftp-server\"" package, use the following
command:

rpm -e yast2-tftp-server""

describe package('yast2-tftp-server') do
  it { should_not be_installed }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89613.rb""}",passed,System Package yast2-tftp-server should not be installed,0.1661335,2019-08-01T08:47:29-07:00,""
V-89615,The tftp package must not be installed.,"The Trivial File Transfer Protocol (TFTP) is normally used only for
booting diskless workstations and for getting or saving network component
configuration files. Disabling the ""tftp"" protocol service ensures the system
is not acting over tftp, which does not provide encryption or authentication.","[{""label""=>""default"", ""data""=>""The Trivial File Transfer Protocol (TFTP) is normally used only for\nbooting diskless workstations and for getting or saving network component\nconfiguration files. Disabling the \""tftp\"" protocol service ensures the system\nis not acting over tftp, which does not provide encryption or authentication.""}]",0.5,[],"",SRG-OS-000095-GPOS-00049,V-89615,SV-100265r1_rule,VRAU-SL-000490,F-96357r1_fix,"[""CCI-000381""]","[""CM-7 a"", ""Rev_4""]","","","","","","","","","","","Check if ""tftp"" is installed:

# rpm -q tftp

If there is a ""tftp"" package listed, this is a finding.","To remove the ""tftp"" package use the following command:

rpm -e tftp","control ""V-89615"" do
  title ""The tftp package must not be installed.""
  desc  ""The Trivial File Transfer Protocol (TFTP) is normally used only for
booting diskless workstations and for getting or saving network component
configuration files. Disabling the \""tftp\"" protocol service ensures the system
is not acting over tftp, which does not provide encryption or authentication.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000095-GPOS-00049""
  tag ""gid"": ""V-89615""
  tag ""rid"": ""SV-100265r1_rule""
  tag ""stig_id"": ""VRAU-SL-000490""
  tag ""fix_id"": ""F-96357r1_fix""
  tag ""cci"": [""CCI-000381""]
  tag ""nist"": [""CM-7 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check if \""tftp\"" is installed:

# rpm -q tftp

If there is a \""tftp\"" package listed, this is a finding.""
  tag ""fix"": ""To remove the \""tftp\"" package use the following command:

rpm -e tftp""

describe package('tftp') do
  it { should_not be_installed }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89615.rb""}",passed,System Package tftp should not be installed,0.1670639,2019-08-01T08:47:29-07:00,""
V-89617,"The Datagram Congestion Control Protocol (DCCP) must be disabled
unless required.","The DCCP is a proposed transport layer protocol. This protocol is not
yet widely used. Binding this protocol to the network stack increases the
attack surface of the host. Unprivileged local processes may be able to cause
the kernel to dynamically load a protocol handler by opening a socket using the
protocol.","[{""label""=>""default"", ""data""=>""The DCCP is a proposed transport layer protocol. This protocol is not\nyet widely used. Binding this protocol to the network stack increases the\nattack surface of the host. Unprivileged local processes may be able to cause\nthe kernel to dynamically load a protocol handler by opening a socket using the\nprotocol.""}]",0.5,[],",
,
",SRG-OS-000096-GPOS-00050,V-89617,SV-100267r1_rule,VRAU-SL-000495,F-96359r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]",",
,
",",
,
",",
,
",",
,
",",
,
",",
,
",",
,
",",
,
",",
,
",",
,
","Check that the DCCP protocol handler is prevented from dynamic
loading:

# grep ""install dccp /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*

If no result is returned, this is a finding.

# grep ""install dccp_ipv4 /bin/true"" /etc/modprobe.conf/etc/modprobe.conf.local /etc/modprobe.d/*

If no result is returned, this is a finding.

# grep ""install dccp_ipv6"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/* | grep ‘bin/true’

If no result is returned, this is a finding.","Prevent the DCCP protocol handler for dynamic loading:

# echo ""install dccp /bin/true"" >> /etc/modprobe.conf.local
# echo ""install dccp_ipv4 /bin/true"" >> /etc/modprobe.conf.local
# echo ""install dccp_ipv6 /bin/true"" >> /etc/modprobe.conf.local","control ""V-89617"" do
  title ""The Datagram Congestion Control Protocol (DCCP) must be disabled
unless required.""
  desc  ""The DCCP is a proposed transport layer protocol. This protocol is not
yet widely used. Binding this protocol to the network stack increases the
attack surface of the host. Unprivileged local processes may be able to cause
the kernel to dynamically load a protocol handler by opening a socket using the
protocol.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89617""
  tag ""rid"": ""SV-100267r1_rule""
  tag ""stig_id"": ""VRAU-SL-000495""
  tag ""fix_id"": ""F-96359r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check that the DCCP protocol handler is prevented from dynamic
loading:

# grep \""install dccp /bin/true\"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*

If no result is returned, this is a finding.

# grep \""install dccp_ipv4 /bin/true\"" /etc/modprobe.conf/etc/modprobe.conf.local /etc/modprobe.d/*

If no result is returned, this is a finding.

# grep \""install dccp_ipv6\"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/* | grep ‘bin/true’

If no result is returned, this is a finding.""
  tag ""fix"": ""Prevent the DCCP protocol handler for dynamic loading:

# echo \""install dccp /bin/true\"" >> /etc/modprobe.conf.local
# echo \""install dccp_ipv4 /bin/true\"" >> /etc/modprobe.conf.local
# echo \""install dccp_ipv6 /bin/true\"" >> /etc/modprobe.conf.local""

describe command('grep ""install dccp /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*') do
  its('stdout') {should_not eq ''}
end

describe command('grep ""install dccp_ipv4 /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*') do
  its('stdout') {should_not eq ''}
end

describe command('grep ""install dccp_ipv6 /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*') do
  its('stdout') {should_not eq ''}
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89617.rb""}","passed,
passed,
passed","Command: `grep ""install dccp /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*` stdout should not eq """",
Command: `grep ""install dccp_ipv4 /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*` stdout should not eq """",
Command: `grep ""install dccp_ipv6 /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*` stdout should not eq """"","0.1538309,
0.1558201,
0.155647","2019-08-01T08:47:29-07:00,
2019-08-01T08:47:29-07:00,
2019-08-01T08:47:29-07:00",",
,
"
V-89619,"The Stream Control Transmission Protocol (SCTP) must be disabled
unless required.","The SCTP is an IETF-standardized transport layer protocol. This
protocol is not yet widely used. Binding this protocol to the network stack
increases the attack surface of the host. Unprivileged local processes may be
able to cause the kernel to dynamically load a protocol handler by opening a
socket using the protocol.","[{""label""=>""default"", ""data""=>""The SCTP is an IETF-standardized transport layer protocol. This\nprotocol is not yet widely used. Binding this protocol to the network stack\nincreases the attack surface of the host. Unprivileged local processes may be\nable to cause the kernel to dynamically load a protocol handler by opening a\nsocket using the protocol.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89619,SV-100269r1_rule,VRAU-SL-000500,F-96361r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Verify the SCTP protocol handler is prevented from dynamic
loading:

# grep ""install sctp /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local
/etc/modprobe.d/*

If no result is returned, this is a finding.","Prevent the SCTP protocol handler for dynamic loading:

# echo ""install sctp /bin/true"" >> /etc/modprobe.conf.local","control ""V-89619"" do
  title ""The Stream Control Transmission Protocol (SCTP) must be disabled
unless required.""
  desc  ""The SCTP is an IETF-standardized transport layer protocol. This
protocol is not yet widely used. Binding this protocol to the network stack
increases the attack surface of the host. Unprivileged local processes may be
able to cause the kernel to dynamically load a protocol handler by opening a
socket using the protocol.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89619""
  tag ""rid"": ""SV-100269r1_rule""
  tag ""stig_id"": ""VRAU-SL-000500""
  tag ""fix_id"": ""F-96361r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the SCTP protocol handler is prevented from dynamic
loading:

# grep \""install sctp /bin/true\"" /etc/modprobe.conf /etc/modprobe.conf.local
/etc/modprobe.d/*

If no result is returned, this is a finding.""
  tag ""fix"": ""Prevent the SCTP protocol handler for dynamic loading:

# echo \""install sctp /bin/true\"" >> /etc/modprobe.conf.local""

describe command('grep ""install sctp /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*') do
  its('stdout') {should_not eq ''}
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89619.rb""}",passed,"Command: `grep ""install sctp /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*` stdout should not eq """"",0.1566162,2019-08-01T08:47:30-07:00,""
V-89621,"The Reliable Datagram Sockets (RDS) protocol must be disabled or not
installed unless required.","The RDS protocol is a relatively new protocol developed by Oracle for
communication between the nodes of a cluster. Binding this protocol to the
network stack increases the attack surface of the host. Unprivileged local
processes may be able to cause the system to dynamically load a protocol
handler by opening a socket using the protocol.","[{""label""=>""default"", ""data""=>""The RDS protocol is a relatively new protocol developed by Oracle for\ncommunication between the nodes of a cluster. Binding this protocol to the\nnetwork stack increases the attack surface of the host. Unprivileged local\nprocesses may be able to cause the system to dynamically load a protocol\nhandler by opening a socket using the protocol.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89621,SV-100271r1_rule,VRAU-SL-000505,F-96363r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Ask the SA if RDS is required by application software running
on the system. If so, this is not applicable.

Check that the RDS protocol handler is prevented from dynamic loading:

# grep ""install rds /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local
/etc/modprobe.d/*

If no result is returned, this is a finding.","Prevent the use of RDS protocol handler for dynamic loading:

# echo ""install rds /bin/true"" >> /etc/modprobe.conf.local","control ""V-89621"" do
  title ""The Reliable Datagram Sockets (RDS) protocol must be disabled or not
installed unless required.""
  desc  ""The RDS protocol is a relatively new protocol developed by Oracle for
communication between the nodes of a cluster. Binding this protocol to the
network stack increases the attack surface of the host. Unprivileged local
processes may be able to cause the system to dynamically load a protocol
handler by opening a socket using the protocol.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89621""
  tag ""rid"": ""SV-100271r1_rule""
  tag ""stig_id"": ""VRAU-SL-000505""
  tag ""fix_id"": ""F-96363r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Ask the SA if RDS is required by application software running
on the system. If so, this is not applicable.

Check that the RDS protocol handler is prevented from dynamic loading:

# grep \""install rds /bin/true\"" /etc/modprobe.conf /etc/modprobe.conf.local
/etc/modprobe.d/*

If no result is returned, this is a finding.""
  tag ""fix"": ""Prevent the use of RDS protocol handler for dynamic loading:

# echo \""install rds /bin/true\"" >> /etc/modprobe.conf.local""

describe command('grep ""install rds /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*') do
  its('stdout') {should_not eq ''}
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89621.rb""}",passed,"Command: `grep ""install rds /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*` stdout should not eq """"",0.1565239,2019-08-01T08:47:30-07:00,""
V-89623,"The Transparent Inter-Process Communication (TIPC) must be disabled or
not installed.","The Transparent Inter-Process Communication (TIPC) protocol is a
relatively new cluster communications protocol developed by Ericsson. Binding
this protocol to the network stack increases the attack surface of the host.
Unprivileged local processes may be able to cause the kernel to dynamically
load a protocol handler by opening a socket using the protocol.","[{""label""=>""default"", ""data""=>""The Transparent Inter-Process Communication (TIPC) protocol is a\nrelatively new cluster communications protocol developed by Ericsson. Binding\nthis protocol to the network stack increases the attack surface of the host.\nUnprivileged local processes may be able to cause the kernel to dynamically\nload a protocol handler by opening a socket using the protocol.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89623,SV-100273r1_rule,VRAU-SL-000510,F-96365r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Verify the TIPC protocol handler is prevented from dynamic
loading:

# grep ""install tipc /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local
/etc/modprobe.d/*

If no result is returned, this is a finding.","Prevent the TIPC protocol handler for dynamic loading:

# echo ""install tipc /bin/true"" >> /etc/modprobe.conf.local","control ""V-89623"" do
  title ""The Transparent Inter-Process Communication (TIPC) must be disabled or
not installed.""
  desc  ""The Transparent Inter-Process Communication (TIPC) protocol is a
relatively new cluster communications protocol developed by Ericsson. Binding
this protocol to the network stack increases the attack surface of the host.
Unprivileged local processes may be able to cause the kernel to dynamically
load a protocol handler by opening a socket using the protocol.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89623""
  tag ""rid"": ""SV-100273r1_rule""
  tag ""stig_id"": ""VRAU-SL-000510""
  tag ""fix_id"": ""F-96365r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the TIPC protocol handler is prevented from dynamic
loading:

# grep \""install tipc /bin/true\"" /etc/modprobe.conf /etc/modprobe.conf.local
/etc/modprobe.d/*

If no result is returned, this is a finding.""
  tag ""fix"": ""Prevent the TIPC protocol handler for dynamic loading:

# echo \""install tipc /bin/true\"" >> /etc/modprobe.conf.local""

describe command('grep ""install tipc /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*') do
  its('stdout') {should_not eq ''}
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89623.rb""}",passed,"Command: `grep ""install tipc /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*` stdout should not eq """"",0.1659654,2019-08-01T08:47:30-07:00,""
V-89625,"The xinetd service must be disabled if no network services using it
are enabled.","The ""xinetd"" service provides a dedicated listener service for some
programs, which is no longer necessary for commonly used network services.
Disabling it ensures that these uncommon services are not running and also
prevents attacks against ""xinetd"" itself.","[{""label""=>""default"", ""data""=>""The \""xinetd\"" service provides a dedicated listener service for some\nprograms, which is no longer necessary for commonly used network services.\nDisabling it ensures that these uncommon services are not running and also\nprevents attacks against \""xinetd\"" itself.""}]",0.5,[],",
",SRG-OS-000096-GPOS-00050,V-89625,SV-100275r1_rule,VRAU-SL-000515,F-96367r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]",",
",",
",",
",",
",",
",",
",",
",",
",",
",",
","If network services are using the ""xinetd"" service, this is
not applicable.

To check that the ""xinetd"" service is disabled in system boot configuration,
run the following command:

# chkconfig ""xinetd"" --list

Output should indicate the ""xinetd"" service has either not been installed or
has been disabled at all run levels as shown in the example below:

xinetd 0:off 1:off 2:off 3:off 4:off 5:off 6:off

Run the following command to verify ""xinetd"" is disabled through current
runtime configuration:

# service xinetd status

If the service is disabled, the command will return the following output:

Checking for service xinetd: unused

If the service is running, this is a finding.","The ""xinetd"" service can be disabled with the following
command:

# chkconfig xinetd off","control ""V-89625"" do
  title ""The xinetd service must be disabled if no network services using it
are enabled.""
  desc  ""The \""xinetd\"" service provides a dedicated listener service for some
programs, which is no longer necessary for commonly used network services.
Disabling it ensures that these uncommon services are not running and also
prevents attacks against \""xinetd\"" itself.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89625""
  tag ""rid"": ""SV-100275r1_rule""
  tag ""stig_id"": ""VRAU-SL-000515""
  tag ""fix_id"": ""F-96367r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""If network services are using the \""xinetd\"" service, this is
not applicable.

To check that the \""xinetd\"" service is disabled in system boot configuration,
run the following command:

# chkconfig \""xinetd\"" --list

Output should indicate the \""xinetd\"" service has either not been installed or
has been disabled at all run levels as shown in the example below:

xinetd 0:off 1:off 2:off 3:off 4:off 5:off 6:off

Run the following command to verify \""xinetd\"" is disabled through current
runtime configuration:

# service xinetd status

If the service is disabled, the command will return the following output:

Checking for service xinetd: unused

If the service is running, this is a finding.""
  tag ""fix"": ""The \""xinetd\"" service can be disabled with the following
command:

# chkconfig xinetd off""

describe service('xinetd') do
  it {should_not be_enabled}
  it {should_not be_running}
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89625.rb""}","passed,
passed","Service xinetd should not be enabled,
Service xinetd should not be running","0.0003919,
0.0030682","2019-08-01T08:47:30-07:00,
2019-08-01T08:47:30-07:00",",
"
V-89627,"The xinetd.conf file, and the xinetd.d directory must be owned by root
or bin.","Failure to give ownership of sensitive files or utilities to root
provides the designated owner and unauthorized users with the potential to
access sensitive information or change the system configuration, which could
weaken the system's security posture.","[{""label""=>""default"", ""data""=>""Failure to give ownership of sensitive files or utilities to root\nprovides the designated owner and unauthorized users with the potential to\naccess sensitive information or change the system configuration, which could\nweaken the system's security posture.""}]",0.5,[],",
",SRG-OS-000096-GPOS-00050,V-89627,SV-100277r1_rule,VRAU-SL-000520,F-96369r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]",",
",",
",",
",",
",",
",",
",",
",",
",",
",",
","Check the owner of the ""xinetd"" configuration files:

# ls -lL /etc/xinetd.conf
# ls -laL /etc/xinetd.d

This is a finding if any of the above files or directories are not owned by
""root"" or ""bin"".","Change the owner of the ""xinetd"" configuration files:

# chown root /etc/xinetd.conf /etc/xinetd.d/*","control ""V-89627"" do
  title ""The xinetd.conf file, and the xinetd.d directory must be owned by root
or bin.""
  desc  ""Failure to give ownership of sensitive files or utilities to root
provides the designated owner and unauthorized users with the potential to
access sensitive information or change the system configuration, which could
weaken the system's security posture.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89627""
  tag ""rid"": ""SV-100277r1_rule""
  tag ""stig_id"": ""VRAU-SL-000520""
  tag ""fix_id"": ""F-96369r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the owner of the \""xinetd\"" configuration files:

# ls -lL /etc/xinetd.conf
# ls -laL /etc/xinetd.d

This is a finding if any of the above files or directories are not owned by
\""root\"" or \""bin\"".""
  tag ""fix"": ""Change the owner of the \""xinetd\"" configuration files:

# chown root /etc/xinetd.conf /etc/xinetd.d/*""

describe file('/etc/xinetd.conf') do 
  its('owner') {should be 'root'} # doesn't work, wtf...
end

describe directory('/etc/xinetd.d') do 
  its('owner') {should be 'root'}
end


end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89627.rb""}","failed,
failed","File /etc/xinetd.conf owner should equal ""root"",
Directory /etc/xinetd.d owner should equal ""root""","0.1544084,
0.1658199","2019-08-01T08:47:30-07:00,
2019-08-01T08:47:30-07:00","
expected #<String:57818080> => ""root""
     got #<String:91613260> => ""root""

Compared using equal?, which compares object identity,
but expected and actual are not the same object. Use
`expect(actual).to eq(expected)` if you don't care about
object identity in this example.

,

expected #<String:91803260> => ""root""
     got #<String:91895900> => ""root""

Compared using equal?, which compares object identity,
but expected and actual are not the same object. Use
`expect(actual).to eq(expected)` if you don't care about
object identity in this example.

"
V-89629,"The inetd.conf file, xinetd.conf file, and  xinetd.d directory must be
group owned by root, bin, sys, or system.","Failure to give ownership of sensitive files or utilities to root
provides the designated owner and unauthorized users with the potential to
access sensitive information or change the system configuration, which could
weaken the system's security posture.","[{""label""=>""default"", ""data""=>""Failure to give ownership of sensitive files or utilities to root\nprovides the designated owner and unauthorized users with the potential to\naccess sensitive information or change the system configuration, which could\nweaken the system's security posture.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89629,SV-100279r1_rule,VRAU-SL-000525,F-96371r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Check the group-ownership of the ""xinetd"" configuration files
and directories:

# ls -alL /etc/xinetd.conf /etc/xinetd.d

If a file or directory is not group-owned by ""root"", ""bin"", ""sys"", or
""system"", this is a finding.","Change the group-owner of the ""xinetd"" configuration files and
directories:

# chgrp -R root /etc/xinetd.conf /etc/xinetd.d","control ""V-89629"" do
  title ""The inetd.conf file, xinetd.conf file, and  xinetd.d directory must be
group owned by root, bin, sys, or system.""
  desc  ""Failure to give ownership of sensitive files or utilities to root
provides the designated owner and unauthorized users with the potential to
access sensitive information or change the system configuration, which could
weaken the system's security posture.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89629""
  tag ""rid"": ""SV-100279r1_rule""
  tag ""stig_id"": ""VRAU-SL-000525""
  tag ""fix_id"": ""F-96371r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the group-ownership of the \""xinetd\"" configuration files
and directories:

# ls -alL /etc/xinetd.conf /etc/xinetd.d

If a file or directory is not group-owned by \""root\"", \""bin\"", \""sys\"", or
\""system\"", this is a finding.""
  tag ""fix"": ""Change the group-owner of the \""xinetd\"" configuration files and
directories:

# chgrp -R root /etc/xinetd.conf /etc/xinetd.d""

#describe file('/etc/xinetd.conf') do 
#  its('group') {should cmp 'root'} #not working, but why
#end

describe directory('/etc/xinetd.d') do 
  its('group') {should cmp 'root'} #works!
end


end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89629.rb""}",passed,"Directory /etc/xinetd.d group should cmp == ""root""",0.0004406,2019-08-01T08:47:30-07:00,""
V-89631,The xinetd.d directory must have mode 0755 or less permissive.,"The Internet service daemon configuration files must be protected as
malicious modification could cause denial of service or increase the attack
surface of the system.","[{""label""=>""default"", ""data""=>""The Internet service daemon configuration files must be protected as\nmalicious modification could cause denial of service or increase the attack\nsurface of the system.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89631,SV-100281r1_rule,VRAU-SL-000530,F-96373r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Check the permissions of the ""xinetd"" configuration
directories:

# ls -dlL /etc/xinetd.d

If the mode of the directory is more permissive than ""0755"", this is a
finding.","Change the mode of the directory:

# chmod 0755 /etc/xinetd.d","control ""V-89631"" do
  title ""The xinetd.d directory must have mode 0755 or less permissive.""
  desc  ""The Internet service daemon configuration files must be protected as
malicious modification could cause denial of service or increase the attack
surface of the system.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89631""
  tag ""rid"": ""SV-100281r1_rule""
  tag ""stig_id"": ""VRAU-SL-000530""
  tag ""fix_id"": ""F-96373r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the permissions of the \""xinetd\"" configuration
directories:

# ls -dlL /etc/xinetd.d

If the mode of the directory is more permissive than \""0755\"", this is a
finding.""
  tag ""fix"": ""Change the mode of the directory:

# chmod 0755 /etc/xinetd.d""

describe directory('/etc/xinetd.d') do
  it{should_not be_more_permissive_than '0755'}
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89631.rb""}",passed,"Directory /etc/xinetd.d should not be more permissive than ""0755""",0.1543662,2019-08-01T08:47:30-07:00,""
V-89633,Xinetd logging/tracing must be enabled.,"Xinetd logging and tracing allows the system administrators to observe
the IP addresses that are connecting to their machines and to observe what
network services are being sought. This provides valuable information when
trying to find the source of malicious users and potential malicious users.","[{""label""=>""default"", ""data""=>""Xinetd logging and tracing allows the system administrators to observe\nthe IP addresses that are connecting to their machines and to observe what\nnetwork services are being sought. This provides valuable information when\ntrying to find the source of malicious users and potential malicious users.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89633,SV-100283r1_rule,VRAU-SL-000535,F-96375r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Examine the /etc/xinetd.conf file and each file in the
/etc/xinetd.d directory file for the following:

log_type = SYSLOG authpriv
log_on_success = HOST PID USERID EXIT
log_on_failure = HOST USERID

If ""xinetd"" running and logging is not enabled, this is a finding.","Edit each file in the /etc/xinetd.d directory and the
/etc/xinetd.conf file to contain:

log_type = SYSLOG authpriv
log_on_success = HOST PID USERID EXIT
log_on_failure = HOST USERID

The /etc/xinetd.conf file contains default values that will hold true for all
services unless individually modified in the service's ""xinetd.d"" file.","control ""V-89633"" do
  title ""Xinetd logging/tracing must be enabled.""
  desc  ""Xinetd logging and tracing allows the system administrators to observe
the IP addresses that are connecting to their machines and to observe what
network services are being sought. This provides valuable information when
trying to find the source of malicious users and potential malicious users.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89633""
  tag ""rid"": ""SV-100283r1_rule""
  tag ""stig_id"": ""VRAU-SL-000535""
  tag ""fix_id"": ""F-96375r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Examine the /etc/xinetd.conf file and each file in the
/etc/xinetd.d directory file for the following:

log_type = SYSLOG authpriv
log_on_success = HOST PID USERID EXIT
log_on_failure = HOST USERID

If \""xinetd\"" running and logging is not enabled, this is a finding.""
  tag ""fix"": ""Edit each file in the /etc/xinetd.d directory and the
/etc/xinetd.conf file to contain:

log_type = SYSLOG authpriv
log_on_success = HOST PID USERID EXIT
log_on_failure = HOST USERID

The /etc/xinetd.conf file contains default values that will hold true for all
services unless individually modified in the service's \""xinetd.d\"" file.""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89633.rb""}","","","","",""
V-89635,"The ypbind service must not be running if no network services
utilizing it are enabled.","Disabling the ""ypbind"" service ensures the system is not acting as a
client in a NIS or NIS+ domain when not required.","[{""label""=>""default"", ""data""=>""Disabling the \""ypbind\"" service ensures the system is not acting as a\nclient in a NIS or NIS+ domain when not required.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89635,SV-100285r1_rule,VRAU-SL-000540,F-96377r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","If network services are using the ""ypbind"" service, this is
not applicable.

To check that the ""ypbind"" service is disabled in system boot configuration,
run the following command:

# chkconfig ""ypbind"" --list

Output should indicate the ""ypbind"" service has either not been installed, or
has been disabled at all run levels, as shown in the example below:

ypbind 0:off 1:off 2:off 3:off 4:off 5:off 6:off

Run the following command to verify ""ypbind"" is disabled through current
runtime configuration:

# service ypbind status

If the service is disabled the command will return the following output:

Checking for service ypbind unused

If the service is running, this is a finding.","The ""ypbind"" service can be disabled with the following
command:

# chkconfig ypbind off","control ""V-89635"" do
  title ""The ypbind service must not be running if no network services
utilizing it are enabled.""
  desc  ""Disabling the \""ypbind\"" service ensures the system is not acting as a
client in a NIS or NIS+ domain when not required.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89635""
  tag ""rid"": ""SV-100285r1_rule""
  tag ""stig_id"": ""VRAU-SL-000540""
  tag ""fix_id"": ""F-96377r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""If network services are using the \""ypbind\"" service, this is
not applicable.

To check that the \""ypbind\"" service is disabled in system boot configuration,
run the following command:

# chkconfig \""ypbind\"" --list

Output should indicate the \""ypbind\"" service has either not been installed, or
has been disabled at all run levels, as shown in the example below:

ypbind 0:off 1:off 2:off 3:off 4:off 5:off 6:off

Run the following command to verify \""ypbind\"" is disabled through current
runtime configuration:

# service ypbind status

If the service is disabled the command will return the following output:

Checking for service ypbind unused

If the service is running, this is a finding.""
  tag ""fix"": ""The \""ypbind\"" service can be disabled with the following
command:

# chkconfig ypbind off""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89635.rb""}","","","","",""
V-89637,The system must not use UDP for NIS/NIS+.,"Implementing NIS or NIS+ under UDP may make the system more
susceptible to a denial-of-service attack and does not provide the same quality
of service as TCP.","[{""label""=>""default"", ""data""=>""Implementing NIS or NIS+ under UDP may make the system more\nsusceptible to a denial-of-service attack and does not provide the same quality\nof service as TCP.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89637,SV-100287r1_rule,VRAU-SL-000545,F-96379r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","If the SLES for vRealize does not use NIS or NIS+, this is not
applicable.

Check if NIS or NIS+ is implemented using UDP:

# rpcinfo -p | grep yp | grep udp

If NIS or NIS+ is implemented using UDP, this is a finding.","Configure the SLES for vRealize to not use UDP for NIS and NIS+.
Consult vendor documentation for the required procedure.","control ""V-89637"" do
  title ""The system must not use UDP for NIS/NIS+.""
  desc  ""Implementing NIS or NIS+ under UDP may make the system more
susceptible to a denial-of-service attack and does not provide the same quality
of service as TCP.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89637""
  tag ""rid"": ""SV-100287r1_rule""
  tag ""stig_id"": ""VRAU-SL-000545""
  tag ""fix_id"": ""F-96379r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""If the SLES for vRealize does not use NIS or NIS+, this is not
applicable.

Check if NIS or NIS+ is implemented using UDP:

# rpcinfo -p | grep yp | grep udp

If NIS or NIS+ is implemented using UDP, this is a finding.""
  tag ""fix"": ""Configure the SLES for vRealize to not use UDP for NIS and NIS+.
Consult vendor documentation for the required procedure.""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89637.rb""}","","","","",""
V-89639,NIS maps must be protected through hard-to-guess domain names.,"The use of hard-to-guess NIS domain names provides additional
protection from unauthorized access to the NIS directory information.","[{""label""=>""default"", ""data""=>""The use of hard-to-guess NIS domain names provides additional\nprotection from unauthorized access to the NIS directory information.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89639,SV-100289r1_rule,VRAU-SL-000550,F-96381r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","If the SLES for vRealize does not use NIS or NIS+, this is not
applicable.

Check the domain name for NIS maps:

# domainname

If the name returned is simple to guess, such as the organization name,
building or room name, etc., this is a finding.","Change the NIS domain name to a value difficult to guess. Consult
vendor documentation for the required procedure.","control ""V-89639"" do
  title ""NIS maps must be protected through hard-to-guess domain names.""
  desc  ""The use of hard-to-guess NIS domain names provides additional
protection from unauthorized access to the NIS directory information.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89639""
  tag ""rid"": ""SV-100289r1_rule""
  tag ""stig_id"": ""VRAU-SL-000550""
  tag ""fix_id"": ""F-96381r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""If the SLES for vRealize does not use NIS or NIS+, this is not
applicable.

Check the domain name for NIS maps:

# domainname

If the name returned is simple to guess, such as the organization name,
building or room name, etc., this is a finding.""
  tag ""fix"": ""Change the NIS domain name to a value difficult to guess. Consult
vendor documentation for the required procedure.""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89639.rb""}","","","","",""
V-89641,Mail relaying must be restricted.,"If unrestricted mail relaying is permitted, unauthorized senders could
use this host as a mail relay for the purpose of sending spam or other
unauthorized activity.","[{""label""=>""default"", ""data""=>""If unrestricted mail relaying is permitted, unauthorized senders could\nuse this host as a mail relay for the purpose of sending spam or other\nunauthorized activity.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89641,SV-100291r1_rule,VRAU-SL-000555,F-96383r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Determine if Sendmail only binds to loopback addresses by
examining the ""DaemonPortOptions"" configuration options.

# grep -i ""O DaemonPortOptions"" /etc/sendmail.cf

If there are uncommented DaemonPortOptions lines, and all such lines specify
system loopback addresses, this is not a finding.

Otherwise, determine if Sendmail is configured to allow open relay operation.

# grep -i promiscuous_relay /etc/mail/sendmail.mc

If the promiscuous relay feature is enabled, this is a finding.","If the SLES for vRealize does not need to receive mail from
external hosts, add one or more ""DaemonPortOptions"" lines referencing system
loopback addresses (such as ""O
DaemonPortOptions=Addr=127.0.0.1,Port=smtp,Name=MTA"") and remove lines
containing non-loopback addresses.

# sed -i ""s/O DaemonPortOptions=Name=MTA/O
DaemonPortOptions=Addr=127.0.0.1,Port=smtp,Name=MTA/"" /etc/sendmail.cf

Restart the sendmail service:

# service sendmail restart","control ""V-89641"" do
  title ""Mail relaying must be restricted.""
  desc  ""If unrestricted mail relaying is permitted, unauthorized senders could
use this host as a mail relay for the purpose of sending spam or other
unauthorized activity.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89641""
  tag ""rid"": ""SV-100291r1_rule""
  tag ""stig_id"": ""VRAU-SL-000555""
  tag ""fix_id"": ""F-96383r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Determine if Sendmail only binds to loopback addresses by
examining the \""DaemonPortOptions\"" configuration options.

# grep -i \""O DaemonPortOptions\"" /etc/sendmail.cf

If there are uncommented DaemonPortOptions lines, and all such lines specify
system loopback addresses, this is not a finding.

Otherwise, determine if Sendmail is configured to allow open relay operation.

# grep -i promiscuous_relay /etc/mail/sendmail.mc

If the promiscuous relay feature is enabled, this is a finding.""
  tag ""fix"": ""If the SLES for vRealize does not need to receive mail from
external hosts, add one or more \""DaemonPortOptions\"" lines referencing system
loopback addresses (such as \""O
DaemonPortOptions=Addr=127.0.0.1,Port=smtp,Name=MTA\"") and remove lines
containing non-loopback addresses.

# sed -i \""s/O DaemonPortOptions=Name=MTA/O
DaemonPortOptions=Addr=127.0.0.1,Port=smtp,Name=MTA/\"" /etc/sendmail.cf

Restart the sendmail service:

# service sendmail restart""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89641.rb""}","","","","",""
V-89643,The alias files must be owned by root.,"If the alias and aliases.db files are not owned by root, an
unauthorized user may modify the file to add aliases to run malicious code or
redirect email.","[{""label""=>""default"", ""data""=>""If the alias and aliases.db files are not owned by root, an\nunauthorized user may modify the file to add aliases to run malicious code or\nredirect email.""}]",0.5,[],",
",SRG-OS-000096-GPOS-00050,V-89643,SV-100293r1_rule,VRAU-SL-000560,F-96385r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]",",
",",
",",
",",
",",
",",
",",
",",
",",
",",
","Check the ownership of the alias file:

# ls -lL /etc/aliases
# ls -lL /etc/aliases.db

If all the files are not owned by ""root"", this is a finding.","Change the owner of the alias files to ""root"":

# chown root /etc/aliases
# chown root /etc/aliases.db","control ""V-89643"" do
  title ""The alias files must be owned by root.""
  desc  ""If the alias and aliases.db files are not owned by root, an
unauthorized user may modify the file to add aliases to run malicious code or
redirect email.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89643""
  tag ""rid"": ""SV-100293r1_rule""
  tag ""stig_id"": ""VRAU-SL-000560""
  tag ""fix_id"": ""F-96385r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the ownership of the alias file:

# ls -lL /etc/aliases
# ls -lL /etc/aliases.db

If all the files are not owned by \""root\"", this is a finding.""
  tag ""fix"": ""Change the owner of the alias files to \""root\"":

# chown root /etc/aliases
# chown root /etc/aliases.db""

describe file('/etc/aliases') do
  its('owner') {should cmp 'root'}
end

describe file('/etc/aliases.db') do
  its('owner') {should cmp 'root'}
end


end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89643.rb""}","passed,
passed","File /etc/aliases owner should cmp == ""root"",
File /etc/aliases.db owner should cmp == ""root""","0.1667412,
0.1562411","2019-08-01T08:47:31-07:00,
2019-08-01T08:47:31-07:00",",
"
V-89645,The alias files must be group-owned by root or a system group.,"If the aliases and aliases.db file are not group owned by root or a
system group, an unauthorized user may modify one or both of the files to add
aliases to run malicious code or redirect email.","[{""label""=>""default"", ""data""=>""If the aliases and aliases.db file are not group owned by root or a\nsystem group, an unauthorized user may modify one or both of the files to add\naliases to run malicious code or redirect email.""}]",0.5,[],",
",SRG-OS-000096-GPOS-00050,V-89645,SV-100295r1_rule,VRAU-SL-000565,F-96387r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]",",
",",
",",
",",
",",
",",
",",
",",
",",
",",
","Check the group-ownership of the alias files:

# ls -lL /etc/aliases
# ls -lL /etc/aliases.db

If the files are not group-owned by ""root"", this is a finding.","Change the group-owner of the alias files to ""root"":

# chgrp root /etc/aliases
# chgrp root /etc/aliases.db","control ""V-89645"" do
  title ""The alias files must be group-owned by root or a system group.""
  desc  ""If the aliases and aliases.db file are not group owned by root or a
system group, an unauthorized user may modify one or both of the files to add
aliases to run malicious code or redirect email.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89645""
  tag ""rid"": ""SV-100295r1_rule""
  tag ""stig_id"": ""VRAU-SL-000565""
  tag ""fix_id"": ""F-96387r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the group-ownership of the alias files:

# ls -lL /etc/aliases
# ls -lL /etc/aliases.db

If the files are not group-owned by \""root\"", this is a finding.""
  tag ""fix"": ""Change the group-owner of the alias files to \""root\"":

# chgrp root /etc/aliases
# chgrp root /etc/aliases.db""

describe file('/etc/aliases') do
  its('group') {should cmp 'root'}
end

describe file('/etc/aliases.db') do
  its('group') {should cmp 'root'}
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89645.rb""}","passed,
passed","File /etc/aliases group should cmp == ""root"",
File /etc/aliases.db group should cmp == ""root""","0.0002624,
0.0001872","2019-08-01T08:47:31-07:00,
2019-08-01T08:47:31-07:00",",
"
V-89647,The alias files must have mode 0644 or less permissive.,"Excessive permissions on the alias files may permit unauthorized
modification. If an alias file is modified by an unauthorized user, they may
modify the file to run malicious code or redirect email.","[{""label""=>""default"", ""data""=>""Excessive permissions on the alias files may permit unauthorized\nmodification. If an alias file is modified by an unauthorized user, they may\nmodify the file to run malicious code or redirect email.""}]",0.5,[],",
",SRG-OS-000096-GPOS-00050,V-89647,SV-100297r1_rule,VRAU-SL-000570,F-96389r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]",",
",",
",",
",",
",",
",",
",",
",",
",",
",",
","Check the permissions of the alias files:

# ls -lL /etc/aliases
# ls -lL /etc/aliases.db

If the files have a mode more permissive than ""0644"", this is a finding.","Change the mode of the alias files to ""0644"":

# chmod 0644 /etc/aliases /etc/aliases.db","control ""V-89647"" do
  title ""The alias files must have mode 0644 or less permissive.""
  desc  ""Excessive permissions on the alias files may permit unauthorized
modification. If an alias file is modified by an unauthorized user, they may
modify the file to run malicious code or redirect email.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89647""
  tag ""rid"": ""SV-100297r1_rule""
  tag ""stig_id"": ""VRAU-SL-000570""
  tag ""fix_id"": ""F-96389r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the permissions of the alias files:

# ls -lL /etc/aliases
# ls -lL /etc/aliases.db

If the files have a mode more permissive than \""0644\"", this is a finding.""
  tag ""fix"": ""Change the mode of the alias files to \""0644\"":

# chmod 0644 /etc/aliases /etc/aliases.db""

describe file('/etc/aliases') do
  it { should_not be_more_permissive_than('0644') }
end

describe file('/etc/aliases.db') do
  it { should_not be_more_permissive_than('0644') }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89647.rb""}","passed,
passed","File /etc/aliases should not be more permissive than ""0644"",
File /etc/aliases.db should not be more permissive than ""0644""","0.1549752,
0.1556551","2019-08-01T08:47:31-07:00,
2019-08-01T08:47:31-07:00",",
"
V-89649,"Files executed through a mail aliases file must be owned by root and
must reside within a directory owned and writable only by root.","If a file executed through a mail aliases file is not owned and
writable only by root, it may be subject to unauthorized modification.
Unauthorized modification of files executed through aliases may allow
unauthorized users to attain root privileges.","[{""label""=>""default"", ""data""=>""If a file executed through a mail aliases file is not owned and\nwritable only by root, it may be subject to unauthorized modification.\nUnauthorized modification of files executed through aliases may allow\nunauthorized users to attain root privileges.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89649,SV-100299r1_rule,VRAU-SL-000575,F-96391r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Verify the ownership of files referenced within the sendmail
aliases file:

# more /etc/aliases

Examine the aliases file for any directories or paths used:

# ls -lL <directory or file path>

Check the owner for any paths referenced.

If the file or parent directory is not owned by ""root"", this is a finding.","Edit the /etc/aliases file (alternatively, /usr/lib/sendmail.cf).
Locate the entries executing a program. They will appear similar to the
following line:

Aliasname: : /usr/local/bin/ls (or some other program name)

Ensure ""root"" owns the programs and the directory or directories they reside
in by using the ""chown"" command to change owner to ""root"":

# chown root <file or directory name>","control ""V-89649"" do
  title ""Files executed through a mail aliases file must be owned by root and
must reside within a directory owned and writable only by root.""
  desc  ""If a file executed through a mail aliases file is not owned and
writable only by root, it may be subject to unauthorized modification.
Unauthorized modification of files executed through aliases may allow
unauthorized users to attain root privileges.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89649""
  tag ""rid"": ""SV-100299r1_rule""
  tag ""stig_id"": ""VRAU-SL-000575""
  tag ""fix_id"": ""F-96391r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the ownership of files referenced within the sendmail
aliases file:

# more /etc/aliases

Examine the aliases file for any directories or paths used:

# ls -lL <directory or file path>

Check the owner for any paths referenced.

If the file or parent directory is not owned by \""root\"", this is a finding.""
  tag ""fix"": ""Edit the /etc/aliases file (alternatively, /usr/lib/sendmail.cf).
Locate the entries executing a program. They will appear similar to the
following line:

Aliasname: : /usr/local/bin/ls (or some other program name)

Ensure \""root\"" owns the programs and the directory or directories they reside
in by using the \""chown\"" command to change owner to \""root\"":

# chown root <file or directory name>""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89649.rb""}","","","","",""
V-89651,"Files executed through a mail aliases file must be group-owned by
root, bin, sys, or system, and must reside within a directory group-owned by
root, bin, sys, or system.","If a file executed through a mail aliases file is not group-owned by
root or a system group, it may be subject to unauthorized modification.
Unauthorized modification of files executed through aliases may allow
unauthorized users to attain root privileges.","[{""label""=>""default"", ""data""=>""If a file executed through a mail aliases file is not group-owned by\nroot or a system group, it may be subject to unauthorized modification.\nUnauthorized modification of files executed through aliases may allow\nunauthorized users to attain root privileges.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89651,SV-100301r1_rule,VRAU-SL-000580,F-96393r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Examine the contents of the /etc/aliases file:

# more /etc/aliases

Examine the aliases file for any directories or paths that may be utilized:

# ls -lL <file referenced from aliases>

Check the permissions for any paths referenced.

If the group-owner of any file is not ""root"", ""bin"", ""sys"", or
""system"", this is a finding.","Change the group-ownership of the file referenced from
/etc/mail/aliases:

# chgrp root <file referenced from aliases>","control ""V-89651"" do
  title ""Files executed through a mail aliases file must be group-owned by
root, bin, sys, or system, and must reside within a directory group-owned by
root, bin, sys, or system.""
  desc  ""If a file executed through a mail aliases file is not group-owned by
root or a system group, it may be subject to unauthorized modification.
Unauthorized modification of files executed through aliases may allow
unauthorized users to attain root privileges.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89651""
  tag ""rid"": ""SV-100301r1_rule""
  tag ""stig_id"": ""VRAU-SL-000580""
  tag ""fix_id"": ""F-96393r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Examine the contents of the /etc/aliases file:

# more /etc/aliases

Examine the aliases file for any directories or paths that may be utilized:

# ls -lL <file referenced from aliases>

Check the permissions for any paths referenced.

If the group-owner of any file is not \""root\"", \""bin\"", \""sys\"", or
\""system\"", this is a finding.""
  tag ""fix"": ""Change the group-ownership of the file referenced from
/etc/mail/aliases:

# chgrp root <file referenced from aliases>""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89651.rb""}","","","","",""
V-89653,"Files executed through a mail aliases file must have mode 0755 or less
permissive.","If a file executed through a mail alias file has permissions greater
than 0755, it can be modified by an unauthorized user and may contain malicious
code or instructions that could compromise the system.","[{""label""=>""default"", ""data""=>""If a file executed through a mail alias file has permissions greater\nthan 0755, it can be modified by an unauthorized user and may contain malicious\ncode or instructions that could compromise the system.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89653,SV-100303r1_rule,VRAU-SL-000585,F-96395r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Examine the contents of the /etc/aliases file:

# more /etc/aliases

Examine the aliases file for any directories or paths that may be used:

# ls -lL <file referenced from aliases>

Check the permissions for any paths referenced.

If any file referenced from the aliases file has a mode more permissive than
""0755"", this is a finding.","Use the ""chmod"" command to change the access permissions for
files executed from the alias file:

# chmod 0755 <file referenced from aliases>","control ""V-89653"" do
  title ""Files executed through a mail aliases file must have mode 0755 or less
permissive.""
  desc  ""If a file executed through a mail alias file has permissions greater
than 0755, it can be modified by an unauthorized user and may contain malicious
code or instructions that could compromise the system.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89653""
  tag ""rid"": ""SV-100303r1_rule""
  tag ""stig_id"": ""VRAU-SL-000585""
  tag ""fix_id"": ""F-96395r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Examine the contents of the /etc/aliases file:

# more /etc/aliases

Examine the aliases file for any directories or paths that may be used:

# ls -lL <file referenced from aliases>

Check the permissions for any paths referenced.

If any file referenced from the aliases file has a mode more permissive than
\""0755\"", this is a finding.""
  tag ""fix"": ""Use the \""chmod\"" command to change the access permissions for
files executed from the alias file:

# chmod 0755 <file referenced from aliases>""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89653.rb""}","","","","",""
V-89655,"Sendmail logging must not be set to less than nine in the sendmail.cf
file.","If Sendmail is not configured to log at level 9, system logs may not
contain the information necessary for tracking unauthorized use of the sendmail
service.","[{""label""=>""default"", ""data""=>""If Sendmail is not configured to log at level 9, system logs may not\ncontain the information necessary for tracking unauthorized use of the sendmail\nservice.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89655,SV-100305r1_rule,VRAU-SL-000590,F-96397r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Check sendmail to determine if the logging level is set to
level nine:

# grep ""O L"" /etc/sendmail.cf
OR
# grep LogLevel /etc/sendmail.cf

If logging is set to less than nine, this is a finding.","Edit the sendmail.cf file, locate the ""O L"" or ""LogLevel""
entry and change it to ""9"".","control ""V-89655"" do
  title ""Sendmail logging must not be set to less than nine in the sendmail.cf
file.""
  desc  ""If Sendmail is not configured to log at level 9, system logs may not
contain the information necessary for tracking unauthorized use of the sendmail
service.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89655""
  tag ""rid"": ""SV-100305r1_rule""
  tag ""stig_id"": ""VRAU-SL-000590""
  tag ""fix_id"": ""F-96397r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check sendmail to determine if the logging level is set to
level nine:

# grep \""O L\"" /etc/sendmail.cf
OR
# grep LogLevel /etc/sendmail.cf

If logging is set to less than nine, this is a finding.""
  tag ""fix"": ""Edit the sendmail.cf file, locate the \""O L\"" or \""LogLevel\""
entry and change it to \""9\"".""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89655.rb""}","","","","",""
V-89657,"The system syslog service must log informational and more severe SMTP
service messages.","If informational and more severe SMTP service messages are not logged,
malicious activity on the system may go unnoticed.","[{""label""=>""default"", ""data""=>""If informational and more severe SMTP service messages are not logged,\nmalicious activity on the system may go unnoticed.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89657,SV-100307r1_rule,VRAU-SL-000595,F-96399r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Check the /etc/syslog-ng/syslog-ng.conf for the following log
entries:

filter f_mailinfo { level(info) and facility(mail); };
filter f_mailwarn { level(warn) and facility(mail); };
filter f_mailerr { level(err, crit) and facility(mail); };
filter f_mail { facility(mail); };

If present, this is not a finding.","Edit the /etc/syslog-ng/syslog-ng.conf file and add the following
log entries:

filter f_mailinfo { level(info) and facility(mail); };
filter f_mailwarn { level(warn) and facility(mail); };
filter f_mailerr { level(err, crit) and facility(mail); };
filter f_mail { facility(mail); };

destination mailinfo { file(""/var/log/mail.info""); };
log { source(src); filter(f_mailinfo); destination(mailinfo); };

destination mailwarn { file(""/var/log/mail.warn""); };
log { source(src); filter(f_mailwarn); destination(mailwarn); };

destination mailerr { file(""/var/log/mail.err"" fsync(yes)); };
log { source(src); filter(f_mailerr); destination(mailerr); };","control ""V-89657"" do
  title ""The system syslog service must log informational and more severe SMTP
service messages.""
  desc  ""If informational and more severe SMTP service messages are not logged,
malicious activity on the system may go unnoticed.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89657""
  tag ""rid"": ""SV-100307r1_rule""
  tag ""stig_id"": ""VRAU-SL-000595""
  tag ""fix_id"": ""F-96399r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the /etc/syslog-ng/syslog-ng.conf for the following log
entries:

filter f_mailinfo { level(info) and facility(mail); };
filter f_mailwarn { level(warn) and facility(mail); };
filter f_mailerr { level(err, crit) and facility(mail); };
filter f_mail { facility(mail); };

If present, this is not a finding.""
  tag ""fix"": ""Edit the /etc/syslog-ng/syslog-ng.conf file and add the following
log entries:

filter f_mailinfo { level(info) and facility(mail); };
filter f_mailwarn { level(warn) and facility(mail); };
filter f_mailerr { level(err, crit) and facility(mail); };
filter f_mail { facility(mail); };

destination mailinfo { file(\""/var/log/mail.info\""); };
log { source(src); filter(f_mailinfo); destination(mailinfo); };

destination mailwarn { file(\""/var/log/mail.warn\""); };
log { source(src); filter(f_mailwarn); destination(mailwarn); };

destination mailerr { file(\""/var/log/mail.err\"" fsync(yes)); };
log { source(src); filter(f_mailerr); destination(mailerr); };""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89657.rb""}","","","","",""
V-89659,The SMTP service log files must be owned by root.,"If the SMTP service log file is not owned by root, then unauthorized
personnel may modify or delete the file to hide a system compromise.","[{""label""=>""default"", ""data""=>""If the SMTP service log file is not owned by root, then unauthorized\npersonnel may modify or delete the file to hide a system compromise.""}]",0.5,[],",
,
,
",SRG-OS-000096-GPOS-00050,V-89659,SV-100309r1_rule,VRAU-SL-000600,F-96401r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]",",
,
,
",",
,
,
",",
,
,
",",
,
,
",",
,
,
",",
,
,
",",
,
,
",",
,
,
",",
,
,
",",
,
,
","Check the permissions on the mail log files:

# ls -la /var/log/mail
# ls -la /var/log/mail.info
# ls -la /var/log/mail.warn
# ls -la /var/log/mail.err

If any mail log file is not owned by ""root"", this is a finding.","Change the ownership of the sendmail log files:

# chown root <sendmail log file>","control ""V-89659"" do
  title ""The SMTP service log files must be owned by root.""
  desc  ""If the SMTP service log file is not owned by root, then unauthorized
personnel may modify or delete the file to hide a system compromise.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89659""
  tag ""rid"": ""SV-100309r1_rule""
  tag ""stig_id"": ""VRAU-SL-000600""
  tag ""fix_id"": ""F-96401r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the permissions on the mail log files:

# ls -la /var/log/mail
# ls -la /var/log/mail.info
# ls -la /var/log/mail.warn
# ls -la /var/log/mail.err

If any mail log file is not owned by \""root\"", this is a finding.""
  tag ""fix"": ""Change the ownership of the sendmail log files:

# chown root <sendmail log file>""

describe file('/var/log/mail') do
  its('owner') {should cmp 'root'}
end
describe file('/var/log/mail.info') do
  its('owner') {should cmp 'root'}
end
describe file('/var/log/mail.warn') do
  its('owner') {should cmp 'root'}
end
describe file('/var/log/mail.err') do
  its('owner') {should cmp 'root'}
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89659.rb""}","passed,
passed,
passed,
passed","File /var/log/mail owner should cmp == ""root"",
File /var/log/mail.info owner should cmp == ""root"",
File /var/log/mail.warn owner should cmp == ""root"",
File /var/log/mail.err owner should cmp == ""root""","0.1789129,
0.1574265,
0.1658988,
0.1574609","2019-08-01T08:47:31-07:00,
2019-08-01T08:47:31-07:00,
2019-08-01T08:47:32-07:00,
2019-08-01T08:47:32-07:00",",
,
,
"
V-89661,The SMTP service log file must have mode 0644 or less permissive.,"If the SMTP service log file is more permissive than 0644,
unauthorized users may be allowed to change the log file.","[{""label""=>""default"", ""data""=>""If the SMTP service log file is more permissive than 0644,\nunauthorized users may be allowed to change the log file.""}]",0.5,[],",
,
,
",SRG-OS-000096-GPOS-00050,V-89661,SV-100311r1_rule,VRAU-SL-000605,F-96403r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]",",
,
,
",",
,
,
",",
,
,
",",
,
,
",",
,
,
",",
,
,
",",
,
,
",",
,
,
",",
,
,
",",
,
,
","Check the permissions on the mail log files:

# ls -la /var/log/mail
# ls -la /var/log/mail.info
# ls -la /var/log/mail.warn
# ls -la /var/log/mail.err

If the log file permissions are greater than ""0644"", this is a finding.","Change the mode of the sendmail log files:

# chmod 0644 <sendmail log file>","control ""V-89661"" do
  title ""The SMTP service log file must have mode 0644 or less permissive.""
  desc  ""If the SMTP service log file is more permissive than 0644,
unauthorized users may be allowed to change the log file.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89661""
  tag ""rid"": ""SV-100311r1_rule""
  tag ""stig_id"": ""VRAU-SL-000605""
  tag ""fix_id"": ""F-96403r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the permissions on the mail log files:

# ls -la /var/log/mail
# ls -la /var/log/mail.info
# ls -la /var/log/mail.warn
# ls -la /var/log/mail.err

If the log file permissions are greater than \""0644\"", this is a finding.""
  tag ""fix"": ""Change the mode of the sendmail log files:

# chmod 0644 <sendmail log file>""

describe file('/var/log/mail') do
  it { should_not be_more_permissive_than('0644') }
end
describe file('/var/log/mail.info') do
  it { should_not be_more_permissive_than('0644') }
end
describe file('/var/log/mail.warn') do
it { should_not be_more_permissive_than('0644') }
end
describe file('/var/log/mail.err') do
it { should_not be_more_permissive_than('0644') }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89661.rb""}","passed,
passed,
passed,
passed","File /var/log/mail should not be more permissive than ""0644"",
File /var/log/mail.info should not be more permissive than ""0644"",
File /var/log/mail.warn should not be more permissive than ""0644"",
File /var/log/mail.err should not be more permissive than ""0644""","0.1558066,
0.1449376,
0.1447629,
0.1462001","2019-08-01T08:47:32-07:00,
2019-08-01T08:47:32-07:00,
2019-08-01T08:47:32-07:00,
2019-08-01T08:47:32-07:00",",
,
,
"
V-89663,The SMTP service HELP command must not be enabled.,"The HELP command should be disabled to mask version information. The
version of the SMTP service software could be used by attackers to target
vulnerabilities present in specific software versions.","[{""label""=>""default"", ""data""=>""The HELP command should be disabled to mask version information. The\nversion of the SMTP service software could be used by attackers to target\nvulnerabilities present in specific software versions.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89663,SV-100313r1_rule,VRAU-SL-000610,F-96405r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Check the permissions of the sendmail helpfile:

ls -al /usr/lib/sendmail.d/helpfile

If the permissions are not ""0000"", this is a finding.","Run the following command to disable the sendmail helpfile:

# chmod 0000 /usr/lib/sendmail.d/helpfile","control ""V-89663"" do
  title ""The SMTP service HELP command must not be enabled.""
  desc  ""The HELP command should be disabled to mask version information. The
version of the SMTP service software could be used by attackers to target
vulnerabilities present in specific software versions.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89663""
  tag ""rid"": ""SV-100313r1_rule""
  tag ""stig_id"": ""VRAU-SL-000610""
  tag ""fix_id"": ""F-96405r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the permissions of the sendmail helpfile:

ls -al /usr/lib/sendmail.d/helpfile

If the permissions are not \""0000\"", this is a finding.""
  tag ""fix"": ""Run the following command to disable the sendmail helpfile:

# chmod 0000 /usr/lib/sendmail.d/helpfile""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89663.rb""}","","","","",""
V-89665,The SMTP service SMTP greeting must not provide version information.,"The version of the SMTP service can be used by attackers to plan an
attack based on vulnerabilities present in the specific version.","[{""label""=>""default"", ""data""=>""The version of the SMTP service can be used by attackers to plan an\nattack based on vulnerabilities present in the specific version.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89665,SV-100315r1_rule,VRAU-SL-000615,F-96407r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","To check for the sendmail version being displayed in the
greeting:

# more /etc/sendmail.cf | grep SmtpGreetingMessage

If it returns the following:

O SmtpGreetingMessage=$j Sendmail $v/$Z; $b

Then sendmail is providing version information, and this is a finding.","Change the ""O SmtpGreetingMessage"" line in the /etc/sendmail.cf
file to:

O SmtpGreetingMessage= Mail Server Ready ; $b","control ""V-89665"" do
  title ""The SMTP service SMTP greeting must not provide version information.""
  desc  ""The version of the SMTP service can be used by attackers to plan an
attack based on vulnerabilities present in the specific version.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89665""
  tag ""rid"": ""SV-100315r1_rule""
  tag ""stig_id"": ""VRAU-SL-000615""
  tag ""fix_id"": ""F-96407r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To check for the sendmail version being displayed in the
greeting:

# more /etc/sendmail.cf | grep SmtpGreetingMessage

If it returns the following:

O SmtpGreetingMessage=$j Sendmail $v/$Z; $b

Then sendmail is providing version information, and this is a finding.""
  tag ""fix"": ""Change the \""O SmtpGreetingMessage\"" line in the /etc/sendmail.cf
file to:

O SmtpGreetingMessage= Mail Server Ready ; $b""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89665.rb""}","","","","",""
V-89667,The SMTP service must not use .forward files.,"The .forward file allows users to automatically forward mail to
another system. Use of .forward files could allow the unauthorized forwarding
of mail and could potentially create mail loops, which could degrade system
performance.","[{""label""=>""default"", ""data""=>""The .forward file allows users to automatically forward mail to\nanother system. Use of .forward files could allow the unauthorized forwarding\nof mail and could potentially create mail loops, which could degrade system\nperformance.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89667,SV-100317r1_rule,VRAU-SL-000620,F-96409r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Check if forwarding from sendmail:

# grep ""0 ForwardPath"" /etc/sendmail.cf

If the entry contains a file path and is not commented out, this is a finding.","Disable forwarding for sendmail and remove "".forward"" files
from the system:

Remove all .forward files on the system:

# find / -name .forward -delete

Use the following command to disable forwarding:

# sed -i ""s/O ForwardPath/#O ForwardPath/"" /etc/sendmail.cf

Restart the sendmail service:

# service sendmail restart","control ""V-89667"" do
  title ""The SMTP service must not use .forward files.""
  desc  ""The .forward file allows users to automatically forward mail to
another system. Use of .forward files could allow the unauthorized forwarding
of mail and could potentially create mail loops, which could degrade system
performance.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89667""
  tag ""rid"": ""SV-100317r1_rule""
  tag ""stig_id"": ""VRAU-SL-000620""
  tag ""fix_id"": ""F-96409r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check if forwarding from sendmail:

# grep \""0 ForwardPath\"" /etc/sendmail.cf

If the entry contains a file path and is not commented out, this is a finding.""
  tag ""fix"": ""Disable forwarding for sendmail and remove \"".forward\"" files
from the system:

Remove all .forward files on the system:

# find / -name .forward -delete

Use the following command to disable forwarding:

# sed -i \""s/O ForwardPath/#O ForwardPath/\"" /etc/sendmail.cf

Restart the sendmail service:

# service sendmail restart""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89667.rb""}","","","","",""
V-89669,The SMTP service must not have the EXPN feature active.,"The SMTP EXPN function allows an attacker to determine if an account
exists on a system, providing significant assistance to a brute force attack on
user accounts. EXPN may also provide additional information concerning users on
the system, such as the full names of account owners.","[{""label""=>""default"", ""data""=>""The SMTP EXPN function allows an attacker to determine if an account\nexists on a system, providing significant assistance to a brute force attack on\nuser accounts. EXPN may also provide additional information concerning users on\nthe system, such as the full names of account owners.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89669,SV-100319r1_rule,VRAU-SL-000625,F-96411r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Use the following command to check if EXPN is disabled:

# grep -v ""^#"" /etc/sendmail.cf |grep -i PrivacyOptions

If ""noexpn"" is not returned, this is a finding.","Add ""noexpn"" to the ""PrivacyOptions"" flag in /etc/sendmail.cf","control ""V-89669"" do
  title ""The SMTP service must not have the EXPN feature active.""
  desc  ""The SMTP EXPN function allows an attacker to determine if an account
exists on a system, providing significant assistance to a brute force attack on
user accounts. EXPN may also provide additional information concerning users on
the system, such as the full names of account owners.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89669""
  tag ""rid"": ""SV-100319r1_rule""
  tag ""stig_id"": ""VRAU-SL-000625""
  tag ""fix_id"": ""F-96411r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Use the following command to check if EXPN is disabled:

# grep -v \""^#\"" /etc/sendmail.cf |grep -i PrivacyOptions

If \""noexpn\"" is not returned, this is a finding.""
  tag ""fix"": ""Add \""noexpn\"" to the \""PrivacyOptions\"" flag in /etc/sendmail.cf""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89669.rb""}","","","","",""
V-89671,The SMTP service must not have the VRFY feature active.,"The VRFY (Verify) command allows an attacker to determine if an
account exists on a system, providing significant assistance to a brute force
attack on user accounts. VRFY may provide additional information about users on
the system, such as the full names of account owners.","[{""label""=>""default"", ""data""=>""The VRFY (Verify) command allows an attacker to determine if an\naccount exists on a system, providing significant assistance to a brute force\nattack on user accounts. VRFY may provide additional information about users on\nthe system, such as the full names of account owners.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89671,SV-100321r1_rule,VRAU-SL-000630,F-96413r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Use the following command to check if VRFY is disabled:

# grep -v ""^#"" /etc/sendmail.cf |grep -i PrivacyOptions

If ""novrfy"" is not returned, this is a finding.","Add ""novrfy"" to the ""PrivacyOptions"" flag in /etc/sendmail.cf","control ""V-89671"" do
  title ""The SMTP service must not have the VRFY feature active.""
  desc  ""The VRFY (Verify) command allows an attacker to determine if an
account exists on a system, providing significant assistance to a brute force
attack on user accounts. VRFY may provide additional information about users on
the system, such as the full names of account owners.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89671""
  tag ""rid"": ""SV-100321r1_rule""
  tag ""stig_id"": ""VRAU-SL-000630""
  tag ""fix_id"": ""F-96413r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Use the following command to check if VRFY is disabled:

# grep -v \""^#\"" /etc/sendmail.cf |grep -i PrivacyOptions

If \""novrfy\"" is not returned, this is a finding.""
  tag ""fix"": ""Add \""novrfy\"" to the \""PrivacyOptions\"" flag in /etc/sendmail.cf""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89671.rb""}","","","","",""
V-89673,"The Lightweight User Datagram Protocol (UDP-Lite) must be disabled
unless required.","The Lightweight User Datagram Protocol (UDP-Lite) is a proposed
transport layer protocol. This protocol is not yet widely used. Binding this
protocol to the network stack increases the attack surface of the host.
Unprivileged local processes may be able to cause the system to dynamically
load a protocol handler by opening a socket using the protocol.","[{""label""=>""default"", ""data""=>""The Lightweight User Datagram Protocol (UDP-Lite) is a proposed\ntransport layer protocol. This protocol is not yet widely used. Binding this\nprotocol to the network stack increases the attack surface of the host.\nUnprivileged local processes may be able to cause the system to dynamically\nload a protocol handler by opening a socket using the protocol.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89673,SV-100323r1_rule,VRAU-SL-000635,F-96415r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Run the following command:

iptables --list | grep ""udplite""

If no result is displayed, this is a finding.","Configure the system to prevent the dynamic loading of the
UDP-Lite protocol handler:

Add the following rule to the iptables firewall ruleset:

# iptables -A INPUT -p udplite -j DROP","control ""V-89673"" do
  title ""The Lightweight User Datagram Protocol (UDP-Lite) must be disabled
unless required.""
  desc  ""The Lightweight User Datagram Protocol (UDP-Lite) is a proposed
transport layer protocol. This protocol is not yet widely used. Binding this
protocol to the network stack increases the attack surface of the host.
Unprivileged local processes may be able to cause the system to dynamically
load a protocol handler by opening a socket using the protocol.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89673""
  tag ""rid"": ""SV-100323r1_rule""
  tag ""stig_id"": ""VRAU-SL-000635""
  tag ""fix_id"": ""F-96415r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Run the following command:

iptables --list | grep \""udplite\""

If no result is displayed, this is a finding.""
  tag ""fix"": ""Configure the system to prevent the dynamic loading of the
UDP-Lite protocol handler:

Add the following rule to the iptables firewall ruleset:

# iptables -A INPUT -p udplite -j DROP""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89673.rb""}","","","","",""
V-89675,"The Internetwork Packet Exchange (IPX) protocol must be disabled or
not installed.","The Internetwork Packet Exchange (IPX) protocol is a network-layer
protocol that is no longer in common use. Binding this protocol to the network
stack increases the attack surface of the host. Unprivileged local processes
may be able to cause the system to dynamically load a protocol handler by
opening a socket using the protocol.","[{""label""=>""default"", ""data""=>""The Internetwork Packet Exchange (IPX) protocol is a network-layer\nprotocol that is no longer in common use. Binding this protocol to the network\nstack increases the attack surface of the host. Unprivileged local processes\nmay be able to cause the system to dynamically load a protocol handler by\nopening a socket using the protocol.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89675,SV-100325r1_rule,VRAU-SL-000640,F-96417r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Check that the IPX protocol handler is prevented from dynamic
loading:

# grep ""install ipx /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local
/etc/modprobe.d/*

If no result is returned, this is a finding.","Prevent the IPX protocol handler for dynamic loading:

# echo ""install ipx /bin/true"" >> /etc/modprobe.conf.local","control ""V-89675"" do
  title ""The Internetwork Packet Exchange (IPX) protocol must be disabled or
not installed.""
  desc  ""The Internetwork Packet Exchange (IPX) protocol is a network-layer
protocol that is no longer in common use. Binding this protocol to the network
stack increases the attack surface of the host. Unprivileged local processes
may be able to cause the system to dynamically load a protocol handler by
opening a socket using the protocol.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89675""
  tag ""rid"": ""SV-100325r1_rule""
  tag ""stig_id"": ""VRAU-SL-000640""
  tag ""fix_id"": ""F-96417r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check that the IPX protocol handler is prevented from dynamic
loading:

# grep \""install ipx /bin/true\"" /etc/modprobe.conf /etc/modprobe.conf.local
/etc/modprobe.d/*

If no result is returned, this is a finding.""
  tag ""fix"": ""Prevent the IPX protocol handler for dynamic loading:

# echo \""install ipx /bin/true\"" >> /etc/modprobe.conf.local""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89675.rb""}","","","","",""
V-89677,The AppleTalk protocol must be disabled or not installed.,"The AppleTalk suite of protocols is no longer in common use. Binding
this protocol to the network stack increases the attack surface of the host.
Unprivileged local processes may be able to cause the system to dynamically
load a protocol handler by opening a socket using the protocol.","[{""label""=>""default"", ""data""=>""The AppleTalk suite of protocols is no longer in common use. Binding\nthis protocol to the network stack increases the attack surface of the host.\nUnprivileged local processes may be able to cause the system to dynamically\nload a protocol handler by opening a socket using the protocol.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89677,SV-100327r1_rule,VRAU-SL-000645,F-96419r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Verify the AppleTalk protocol handler is prevented from dynamic
loading:

# grep ""install appletalk /bin/true"" /etc/modprobe.conf
/etc/modprobe.conf.local /etc/modprobe.d/*

If no result is returned, this is a finding.","Prevent the AppleTalk protocol handler for dynamic loading:

# echo ""install appletalk /bin/true"" >> /etc/modprobe.conf.local","control ""V-89677"" do
  title ""The AppleTalk protocol must be disabled or not installed.""
  desc  ""The AppleTalk suite of protocols is no longer in common use. Binding
this protocol to the network stack increases the attack surface of the host.
Unprivileged local processes may be able to cause the system to dynamically
load a protocol handler by opening a socket using the protocol.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89677""
  tag ""rid"": ""SV-100327r1_rule""
  tag ""stig_id"": ""VRAU-SL-000645""
  tag ""fix_id"": ""F-96419r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the AppleTalk protocol handler is prevented from dynamic
loading:

# grep \""install appletalk /bin/true\"" /etc/modprobe.conf
/etc/modprobe.conf.local /etc/modprobe.d/*

If no result is returned, this is a finding.""
  tag ""fix"": ""Prevent the AppleTalk protocol handler for dynamic loading:

# echo \""install appletalk /bin/true\"" >> /etc/modprobe.conf.local""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89677.rb""}","","","","",""
V-89679,The DECnet protocol must be disabled or not installed.,"The DECnet suite of protocols is no longer in common use. Binding this
protocol to the network stack increases the attack surface of the host.
Unprivileged local processes may be able to cause the system to dynamically
load a protocol handler by opening a socket using the protocol.","[{""label""=>""default"", ""data""=>""The DECnet suite of protocols is no longer in common use. Binding this\nprotocol to the network stack increases the attack surface of the host.\nUnprivileged local processes may be able to cause the system to dynamically\nload a protocol handler by opening a socket using the protocol.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89679,SV-100329r1_rule,VRAU-SL-000650,F-96421r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Check that the DECnet protocol handler is prevented from
dynamic loading:

# grep ""install decnet /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local
/etc/modprobe.d/*

If no result is returned, this is a finding.","Prevent the DECnet protocol handler for dynamic loading:

# echo ""install decnet /bin/true"" >> /etc/modprobe.conf.local","control ""V-89679"" do
  title ""The DECnet protocol must be disabled or not installed.""
  desc  ""The DECnet suite of protocols is no longer in common use. Binding this
protocol to the network stack increases the attack surface of the host.
Unprivileged local processes may be able to cause the system to dynamically
load a protocol handler by opening a socket using the protocol.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89679""
  tag ""rid"": ""SV-100329r1_rule""
  tag ""stig_id"": ""VRAU-SL-000650""
  tag ""fix_id"": ""F-96421r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check that the DECnet protocol handler is prevented from
dynamic loading:

# grep \""install decnet /bin/true\"" /etc/modprobe.conf /etc/modprobe.conf.local
/etc/modprobe.d/*

If no result is returned, this is a finding.""
  tag ""fix"": ""Prevent the DECnet protocol handler for dynamic loading:

# echo \""install decnet /bin/true\"" >> /etc/modprobe.conf.local""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89679.rb""}","","","","",""
V-89681,"Proxy Neighbor Discovery Protocol (NDP) must not be enabled on the
system.","Proxy Neighbor Discovery Protocol (NDP) allows a system to respond to
NDP requests on one interface on behalf of hosts connected to another
interface. If this function is enabled when not required, addressing
information may be leaked between the attached network segments.","[{""label""=>""default"", ""data""=>""Proxy Neighbor Discovery Protocol (NDP) allows a system to respond to\nNDP requests on one interface on behalf of hosts connected to another\ninterface. If this function is enabled when not required, addressing\ninformation may be leaked between the attached network segments.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89681,SV-100331r1_rule,VRAU-SL-000655,F-96423r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Note: For Appliance OS, proxy_ndp is disabled by default and
this is not a finding.

Determine if the system is configured for proxy NDP, and if it is enabled:

more /proc/sys/net/ipv6/conf/*/proxy_ndp

If the file is not found, the kernel is not configured for proxy NDP, and this
is not a finding.

If the file has a value of ""0"", proxy NDP is not enabled, and this is not a
finding.

If the file has a value of ""1"", proxy NDP is enabled, and this is a finding.",Disable proxy NDP on the system.,"control ""V-89681"" do
  title ""Proxy Neighbor Discovery Protocol (NDP) must not be enabled on the
system.""
  desc  ""Proxy Neighbor Discovery Protocol (NDP) allows a system to respond to
NDP requests on one interface on behalf of hosts connected to another
interface. If this function is enabled when not required, addressing
information may be leaked between the attached network segments.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89681""
  tag ""rid"": ""SV-100331r1_rule""
  tag ""stig_id"": ""VRAU-SL-000655""
  tag ""fix_id"": ""F-96423r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Note: For Appliance OS, proxy_ndp is disabled by default and
this is not a finding.

Determine if the system is configured for proxy NDP, and if it is enabled:

more /proc/sys/net/ipv6/conf/*/proxy_ndp

If the file is not found, the kernel is not configured for proxy NDP, and this
is not a finding.

If the file has a value of \""0\"", proxy NDP is not enabled, and this is not a
finding.

If the file has a value of \""1\"", proxy NDP is enabled, and this is a finding.""
  tag ""fix"": ""Disable proxy NDP on the system.""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89681.rb""}","","","","",""
V-89683,The SLES for vRealize must not have 6to4 enabled.,"6to4 is an IPv6 transition mechanism that involves tunneling IPv6
packets encapsulated in IPv4 packets on an ad-hoc basis. This is not a
preferred transition strategy and increases the attack surface of the system.","[{""label""=>""default"", ""data""=>""6to4 is an IPv6 transition mechanism that involves tunneling IPv6\npackets encapsulated in IPv4 packets on an ad-hoc basis. This is not a\npreferred transition strategy and increases the attack surface of the system.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89683,SV-100333r1_rule,VRAU-SL-000660,F-96425r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Check the SLES for vRealize for any active ""6to4"" tunnels
without specific remote addresses:

# ip tun list | grep ""remote any"" | grep ""ipv6/ip""

If any results are returned the ""tunnel"" is the first field.

If any results are returned, this is a finding.","Disable the active 6to4 tunnel:

# ip link set <tunnel> down

Add this command to a startup script, or remove the configuration creating the
tunnel.","control ""V-89683"" do
  title ""The SLES for vRealize must not have 6to4 enabled.""
  desc  ""6to4 is an IPv6 transition mechanism that involves tunneling IPv6
packets encapsulated in IPv4 packets on an ad-hoc basis. This is not a
preferred transition strategy and increases the attack surface of the system.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89683""
  tag ""rid"": ""SV-100333r1_rule""
  tag ""stig_id"": ""VRAU-SL-000660""
  tag ""fix_id"": ""F-96425r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the SLES for vRealize for any active \""6to4\"" tunnels
without specific remote addresses:

# ip tun list | grep \""remote any\"" | grep \""ipv6/ip\""

If any results are returned the \""tunnel\"" is the first field.

If any results are returned, this is a finding.""
  tag ""fix"": ""Disable the active 6to4 tunnel:

# ip link set <tunnel> down

Add this command to a startup script, or remove the configuration creating the
tunnel.""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89683.rb""}","","","","",""
V-89685,The SLES for vRealize must not have Teredo enabled.,"Teredo is an IPv6 transition mechanism that involves tunneling IPv6
packets encapsulated in IPv4 packets. Unauthorized tunneling may circumvent
network security.","[{""label""=>""default"", ""data""=>""Teredo is an IPv6 transition mechanism that involves tunneling IPv6\npackets encapsulated in IPv4 packets. Unauthorized tunneling may circumvent\nnetwork security.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89685,SV-100335r1_rule,VRAU-SL-000665,F-96427r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","Verify the Teredo service is not running:

ps ax | grep teredo | grep -v grep

If the Teredo process is running, this is a finding.","Kill the Teredo service.

Edit startup scripts to prevent the service from running on startup.

For Appliance OS, Teredo is not included by default, this is not a finding.","control ""V-89685"" do
  title ""The SLES for vRealize must not have Teredo enabled.""
  desc  ""Teredo is an IPv6 transition mechanism that involves tunneling IPv6
packets encapsulated in IPv4 packets. Unauthorized tunneling may circumvent
network security.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89685""
  tag ""rid"": ""SV-100335r1_rule""
  tag ""stig_id"": ""VRAU-SL-000665""
  tag ""fix_id"": ""F-96427r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the Teredo service is not running:

ps ax | grep teredo | grep -v grep

If the Teredo process is running, this is a finding.""
  tag ""fix"": ""Kill the Teredo service.

Edit startup scripts to prevent the service from running on startup.

For Appliance OS, Teredo is not included by default, this is not a finding.""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89685.rb""}","","","","",""
V-89687,The DHCP client must be disabled if not needed.,"DHCP allows for the unauthenticated configuration of network
parameters on the system by exchanging information with a DHCP server.","[{""label""=>""default"", ""data""=>""DHCP allows for the unauthenticated configuration of network\nparameters on the system by exchanging information with a DHCP server.""}]",0.5,[],",
",SRG-OS-000096-GPOS-00050,V-89687,SV-100337r1_rule,VRAU-SL-000670,F-96429r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]",",
",",
",",
",",
",",
",",
",",
",",
",",
",",
","Check that no interface is configured to use DHCP:

# grep -i bootproto=dhcp4 /etc/sysconfig/network/ifcfg-*

If any configuration is found, this is a finding.","Edit the /etc/sysconfig/network/ifcfg-* file(s) and change the
""bootproto"" setting to ""static"".","control ""V-89687"" do
  title ""The DHCP client must be disabled if not needed.""
  desc  ""DHCP allows for the unauthenticated configuration of network
parameters on the system by exchanging information with a DHCP server.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89687""
  tag ""rid"": ""SV-100337r1_rule""
  tag ""stig_id"": ""VRAU-SL-000670""
  tag ""fix_id"": ""F-96429r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check that no interface is configured to use DHCP:

# grep -i bootproto=dhcp4 /etc/sysconfig/network/ifcfg-*

If any configuration is found, this is a finding.""
  tag ""fix"": ""Edit the /etc/sysconfig/network/ifcfg-* file(s) and change the
\""bootproto\"" setting to \""static\"".""

#check all with grep
describe command('grep -i bootproto=dhcp4 /etc/sysconfig/network/ifcfg-*') do
  its('stdout') {should cmp ''}
end

#explicitly check configuration of eth0
describe parse_config_file('/etc/sysconfig/network/ifcfg-eth0') do
  its('BOOTPROTO') { should_not eq 'dhcp4' }
end


end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89687.rb""}","passed,
passed","Command: `grep -i bootproto=dhcp4 /etc/sysconfig/network/ifcfg-*` stdout should cmp == """",
Parse Config File /etc/sysconfig/network/ifcfg-eth0 BOOTPROTO should not eq ""dhcp4""","0.144697,
0.0002942","2019-08-01T08:47:33-07:00,
2019-08-01T08:47:33-07:00",",
"
V-89689,"The SLES for vRealize must have IEEE 1394 (Firewire) disabled unless
needed.","Firewire is a common computer peripheral interface. Firewire devices
may include storage devices that could be used to install malicious software on
a system or exfiltrate data.","[{""label""=>""default"", ""data""=>""Firewire is a common computer peripheral interface. Firewire devices\nmay include storage devices that could be used to install malicious software on\na system or exfiltrate data.""}]",0.5,[],"",SRG-OS-000096-GPOS-00050,V-89689,SV-100339r1_rule,VRAU-SL-000675,F-96431r1_fix,"[""CCI-000382""]","[""CM-7 b"", ""Rev_4""]","","","","","","","","","","","If the SLES for vRealize needs IEEE 1394 (Firewire), this is
not applicable.

Check if the firewire module is not disabled:

# grep ""install ieee1394 /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*

If no results are returned, this is a finding.","Prevent the SLES for vRealize from loading the firewire module:

# echo ""install ieee1394 /bin/true"" >> /etc/modprobe.conf.local","control ""V-89689"" do
  title ""The SLES for vRealize must have IEEE 1394 (Firewire) disabled unless
needed.""
  desc  ""Firewire is a common computer peripheral interface. Firewire devices
may include storage devices that could be used to install malicious software on
a system or exfiltrate data.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000096-GPOS-00050""
  tag ""gid"": ""V-89689""
  tag ""rid"": ""SV-100339r1_rule""
  tag ""stig_id"": ""VRAU-SL-000675""
  tag ""fix_id"": ""F-96431r1_fix""
  tag ""cci"": [""CCI-000382""]
  tag ""nist"": [""CM-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""If the SLES for vRealize needs IEEE 1394 (Firewire), this is
not applicable.

Check if the firewire module is not disabled:

# grep \""install ieee1394 /bin/true\"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*

If no results are returned, this is a finding.""
  tag ""fix"": ""Prevent the SLES for vRealize from loading the firewire module:

# echo \""install ieee1394 /bin/true\"" >> /etc/modprobe.conf.local""

describe command('grep ""install ieee1394 /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*') do
  its('stdout') {should_not eq ''}
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89689.rb""}",passed,"Command: `grep ""install ieee1394 /bin/true"" /etc/modprobe.conf /etc/modprobe.conf.local /etc/modprobe.d/*` stdout should not eq """"",0.1565359,2019-08-01T08:47:33-07:00,""
V-89691,"Duplicate User IDs (UIDs) must not exist for users within the
organization.","To assure accountability and prevent unauthenticated access,
organizational users must be identified and authenticated to prevent potential
misuse and compromise of the system.

    Organizational users include organizational employees or individuals the
organization deems to have equivalent status of employees (e.g., contractors).
Organizational users (and processes acting on behalf of users) must be uniquely
identified and authenticated to all accesses, except for the following:

    1) Accesses explicitly identified and documented by the organization.
Organizations document specific user actions that can be performed on the
information system without identification or authentication; and

    2) Accesses that occur through authorized use of group authenticators
without individual authentication. Organizations may require unique
identification of individuals in group accounts (e.g., shared privilege
accounts) or for detailed accountability of individual activity.","[{""label""=>""default"", ""data""=>""To assure accountability and prevent unauthenticated access,\norganizational users must be identified and authenticated to prevent potential\nmisuse and compromise of the system.\n\n    Organizational users include organizational employees or individuals the\norganization deems to have equivalent status of employees (e.g., contractors).\nOrganizational users (and processes acting on behalf of users) must be uniquely\nidentified and authenticated to all accesses, except for the following:\n\n    1) Accesses explicitly identified and documented by the organization.\nOrganizations document specific user actions that can be performed on the\ninformation system without identification or authentication; and\n\n    2) Accesses that occur through authorized use of group authenticators\nwithout individual authentication. Organizations may require unique\nidentification of individuals in group accounts (e.g., shared privilege\naccounts) or for detailed accountability of individual activity.""}]",0.5,[],"",SRG-OS-000104-GPOS-00051,V-89691,SV-100341r1_rule,VRAU-SL-000680,F-96433r1_fix,"[""CCI-000764""]","[""IA-2"", ""Rev_4""]","","","","","","","","","","","Verify that the SLES for vRealize contains no duplicate UIDs
for organizational users by running the following command:

# awk -F "":"" 'list[$3]++{print $1, $3}' /etc/passwd

If output is produced, this is a finding.","Edit the file /etc/passwd and provide each organizational user
account that has a duplicate UID with a unique UID.","control ""V-89691"" do
  title ""Duplicate User IDs (UIDs) must not exist for users within the
organization.""
  desc  ""To assure accountability and prevent unauthenticated access,
organizational users must be identified and authenticated to prevent potential
misuse and compromise of the system.

    Organizational users include organizational employees or individuals the
organization deems to have equivalent status of employees (e.g., contractors).
Organizational users (and processes acting on behalf of users) must be uniquely
identified and authenticated to all accesses, except for the following:

    1) Accesses explicitly identified and documented by the organization.
Organizations document specific user actions that can be performed on the
information system without identification or authentication; and

    2) Accesses that occur through authorized use of group authenticators
without individual authentication. Organizations may require unique
identification of individuals in group accounts (e.g., shared privilege
accounts) or for detailed accountability of individual activity.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000104-GPOS-00051""
  tag ""gid"": ""V-89691""
  tag ""rid"": ""SV-100341r1_rule""
  tag ""stig_id"": ""VRAU-SL-000680""
  tag ""fix_id"": ""F-96433r1_fix""
  tag ""cci"": [""CCI-000764""]
  tag ""nist"": [""IA-2"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that the SLES for vRealize contains no duplicate UIDs
for organizational users by running the following command:

# awk -F \"":\"" 'list[$3]++{print $1, $3}' /etc/passwd

If output is produced, this is a finding.""
  tag ""fix"": ""Edit the file /etc/passwd and provide each organizational user
account that has a duplicate UID with a unique UID.""

describe command('awk -F "":"" \'list[$3]++{print $1, $3}\' /etc/passwd') do
  its('stdout') {should cmp ''}
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89691.rb""}",failed,"Command: `awk -F "":"" 'list[$3]++{print $1, $3}' /etc/passwd` stdout should cmp == """"",0.1562536,2019-08-01T08:47:33-07:00,"
expected: """"
     got: ""uuidd 102\n""

(compared using `cmp` matcher)
"
V-89693,The SLES for vRealize must prevent direct logon into the root account.,"To assure individual accountability and prevent unauthorized access,
organizational users must be individually identified and authenticated.

    A group authenticator is a generic account used by multiple individuals.
Use of a group authenticator alone does not uniquely identify individual users.
Examples of the group authenticator is the UNIX OS ""root"" user account, the
Windows ""Administrator"" account, the ""sa"" account, or a ""helpdesk""
account.

    For example, the UNIX and Windows operating systems offer a 'switch user'
capability allowing users to authenticate with their individual credentials
and, when needed, 'switch' to the administrator role. This method provides for
unique individual authentication prior to using a group authenticator.

    Users (and any processes acting on behalf of users) need to be uniquely
identified and authenticated for all accesses other than those accesses
explicitly identified and documented by the organization, which outlines
specific user actions that can be performed on the operating system without
identification or authentication.

    Requiring individuals to be authenticated with an individual authenticator
prior to using a group authenticator allows for traceability of actions, as
well as adding an additional level of protection of the actions that can be
taken with group account knowledge.","[{""label""=>""default"", ""data""=>""To assure individual accountability and prevent unauthorized access,\norganizational users must be individually identified and authenticated.\n\n    A group authenticator is a generic account used by multiple individuals.\nUse of a group authenticator alone does not uniquely identify individual users.\nExamples of the group authenticator is the UNIX OS \""root\"" user account, the\nWindows \""Administrator\"" account, the \""sa\"" account, or a \""helpdesk\""\naccount.\n\n    For example, the UNIX and Windows operating systems offer a 'switch user'\ncapability allowing users to authenticate with their individual credentials\nand, when needed, 'switch' to the administrator role. This method provides for\nunique individual authentication prior to using a group authenticator.\n\n    Users (and any processes acting on behalf of users) need to be uniquely\nidentified and authenticated for all accesses other than those accesses\nexplicitly identified and documented by the organization, which outlines\nspecific user actions that can be performed on the operating system without\nidentification or authentication.\n\n    Requiring individuals to be authenticated with an individual authenticator\nprior to using a group authenticator allows for traceability of actions, as\nwell as adding an additional level of protection of the actions that can be\ntaken with group account knowledge.""}]",0.7,[],"",SRG-OS-000109-GPOS-00056,V-89693,SV-100343r1_rule,VRAU-SL-000705,F-96435r1_fix,"[""CCI-000770""]","[""IA-2 (5)"", ""Rev_4""]","","","","","","","","","","","Verify the SLES for vRealize prevents direct logons to the
""root"" account by running the following command:

# grep root /etc/shadow | cut -d """":"""" -f 2

If the returned message contains any text, this is a finding.","Configure the SLES for vRealize to prevent direct logons to the
""root"" account by performing the following operations:

Add this line to the /etc/group file:

admin:x:[UNIQUE_NUMBER]:[USERNAME]

USERNAME is the user to be added to the admin group.
UNIQUE_NUMBER is a number entered into the ID field of an entry that is unique
to all other IDs in the file.

Comment out the following lines in /etc/sudoers file:
Default targetpw
ALL  ALL=(ALL) ALL

Under the line in the /etc/sudoers file:

root ALL=(ALL) All

Add the following line:

%admin ALL=(ALL) ALL

Run the following command:

# passwd -d root","control ""V-89693"" do
  title ""The SLES for vRealize must prevent direct logon into the root account.""
  desc  ""To assure individual accountability and prevent unauthorized access,
organizational users must be individually identified and authenticated.

    A group authenticator is a generic account used by multiple individuals.
Use of a group authenticator alone does not uniquely identify individual users.
Examples of the group authenticator is the UNIX OS \""root\"" user account, the
Windows \""Administrator\"" account, the \""sa\"" account, or a \""helpdesk\""
account.

    For example, the UNIX and Windows operating systems offer a 'switch user'
capability allowing users to authenticate with their individual credentials
and, when needed, 'switch' to the administrator role. This method provides for
unique individual authentication prior to using a group authenticator.

    Users (and any processes acting on behalf of users) need to be uniquely
identified and authenticated for all accesses other than those accesses
explicitly identified and documented by the organization, which outlines
specific user actions that can be performed on the operating system without
identification or authentication.

    Requiring individuals to be authenticated with an individual authenticator
prior to using a group authenticator allows for traceability of actions, as
well as adding an additional level of protection of the actions that can be
taken with group account knowledge.
  ""
  impact 0.7
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000109-GPOS-00056""
  tag ""gid"": ""V-89693""
  tag ""rid"": ""SV-100343r1_rule""
  tag ""stig_id"": ""VRAU-SL-000705""
  tag ""fix_id"": ""F-96435r1_fix""
  tag ""cci"": [""CCI-000770""]
  tag ""nist"": [""IA-2 (5)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the SLES for vRealize prevents direct logons to the
\""root\"" account by running the following command:

# grep root /etc/shadow | cut -d \""\"":\""\"" -f 2

If the returned message contains any text, this is a finding.""
  tag ""fix"": ""Configure the SLES for vRealize to prevent direct logons to the
\""root\"" account by performing the following operations:

Add this line to the /etc/group file:

admin:x:[UNIQUE_NUMBER]:[USERNAME]

USERNAME is the user to be added to the admin group.
UNIQUE_NUMBER is a number entered into the ID field of an entry that is unique
to all other IDs in the file.

Comment out the following lines in /etc/sudoers file:
Default targetpw
ALL  ALL=(ALL) ALL

Under the line in the /etc/sudoers file:

root ALL=(ALL) All

Add the following line:

%admin ALL=(ALL) ALL

Run the following command:

# passwd -d root""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89693.rb""}","","","","",""
V-89695,"The SLES for vRealize must enforce SSHv2 for network access to
privileged accounts.","A replay attack may enable an unauthorized user to gain access to the
operating system. Authentication sessions between the authenticator and the
operating system validating the user credentials must not be vulnerable to a
replay attack.

    An authentication process resists replay attacks if it is impractical to
achieve a successful authentication by recording and replaying a previous
authentication message.

    A privileged account is any information system account with authorizations
of a privileged user.

    Techniques used to address this include protocols using nonces (e.g.,
numbers generated for a specific one-time use) or challenges (e.g., TLS,
WS_Security). Additional techniques include time-synchronous or
challenge-response one-time authenticators.","[{""label""=>""default"", ""data""=>""A replay attack may enable an unauthorized user to gain access to the\noperating system. Authentication sessions between the authenticator and the\noperating system validating the user credentials must not be vulnerable to a\nreplay attack.\n\n    An authentication process resists replay attacks if it is impractical to\nachieve a successful authentication by recording and replaying a previous\nauthentication message.\n\n    A privileged account is any information system account with authorizations\nof a privileged user.\n\n    Techniques used to address this include protocols using nonces (e.g.,\nnumbers generated for a specific one-time use) or challenges (e.g., TLS,\nWS_Security). Additional techniques include time-synchronous or\nchallenge-response one-time authenticators.""}]",0.5,[],"",SRG-OS-000112-GPOS-00057,V-89695,SV-100345r1_rule,VRAU-SL-000710,F-96437r1_fix,"[""CCI-001941""]","[""IA-2 (8)"", ""Rev_4""]","","","","","","","","","","","Verify that the SLES for vRealize enforces SSHv2 for network
access to privileged accounts by running the following command:

Replace [ADDRESS] in the following command with the correct IP address based on
the current system configuration.
# ssh -1 [ADDRESS]

An example of the command usage is as follows:
# ssh -1 localhost

The output must be the following:

Protocol major versions differ: 1 vs. 2

If the output is not as listed above, this is a finding.

OR

Verify that the ssh is configured to enforce SSHv2 for network access to
privileged accounts by running the following command:

# grep Protocol /etc/ssh/sshd_config

If the result is not ""Protocol 2"", this is a finding.","Configure the SLES for vRealize to enforce SSHv2 for network
access to privileged accounts by running the following commands:

# sed -i 's/^.*\bProtocol\b.*$/Protocol 2/' /etc/ssh/sshd_config

Restart the ssh service:

# service sshd restart","control ""V-89695"" do
  title ""The SLES for vRealize must enforce SSHv2 for network access to
privileged accounts.""
  desc  ""A replay attack may enable an unauthorized user to gain access to the
operating system. Authentication sessions between the authenticator and the
operating system validating the user credentials must not be vulnerable to a
replay attack.

    An authentication process resists replay attacks if it is impractical to
achieve a successful authentication by recording and replaying a previous
authentication message.

    A privileged account is any information system account with authorizations
of a privileged user.

    Techniques used to address this include protocols using nonces (e.g.,
numbers generated for a specific one-time use) or challenges (e.g., TLS,
WS_Security). Additional techniques include time-synchronous or
challenge-response one-time authenticators.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000112-GPOS-00057""
  tag ""gid"": ""V-89695""
  tag ""rid"": ""SV-100345r1_rule""
  tag ""stig_id"": ""VRAU-SL-000710""
  tag ""fix_id"": ""F-96437r1_fix""
  tag ""cci"": [""CCI-001941""]
  tag ""nist"": [""IA-2 (8)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that the SLES for vRealize enforces SSHv2 for network
access to privileged accounts by running the following command:

Replace [ADDRESS] in the following command with the correct IP address based on
the current system configuration.
# ssh -1 [ADDRESS]

An example of the command usage is as follows:
# ssh -1 localhost

The output must be the following:

Protocol major versions differ: 1 vs. 2

If the output is not as listed above, this is a finding.

OR

Verify that the ssh is configured to enforce SSHv2 for network access to
privileged accounts by running the following command:

# grep Protocol /etc/ssh/sshd_config

If the result is not \""Protocol 2\"", this is a finding.""
  tag ""fix"": ""Configure the SLES for vRealize to enforce SSHv2 for network
access to privileged accounts by running the following commands:

# sed -i 's/^.*\\bProtocol\\b.*$/Protocol 2/' /etc/ssh/sshd_config

Restart the ssh service:

# service sshd restart""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89695.rb""}","","","","",""
V-89697,"The SLES for vRealize must enforce SSHv2 for network access to
non-privileged accounts.","A replay attack may enable an unauthorized user to gain access to the
operating system. Authentication sessions between the authenticator and the
operating system validating the user credentials must not be vulnerable to a
replay attack.

    An authentication process resists replay attacks if it is impractical to
achieve a successful authentication by recording and replaying a previous
authentication message.

    A non-privileged account is any operating system account with
authorizations of a non-privileged user.

    Techniques used to address this include protocols using nonces (e.g.,
numbers generated for a specific one-time use) or challenges (e.g., TLS,
WS_Security). Additional techniques include time-synchronous or
challenge-response one-time authenticators.","[{""label""=>""default"", ""data""=>""A replay attack may enable an unauthorized user to gain access to the\noperating system. Authentication sessions between the authenticator and the\noperating system validating the user credentials must not be vulnerable to a\nreplay attack.\n\n    An authentication process resists replay attacks if it is impractical to\nachieve a successful authentication by recording and replaying a previous\nauthentication message.\n\n    A non-privileged account is any operating system account with\nauthorizations of a non-privileged user.\n\n    Techniques used to address this include protocols using nonces (e.g.,\nnumbers generated for a specific one-time use) or challenges (e.g., TLS,\nWS_Security). Additional techniques include time-synchronous or\nchallenge-response one-time authenticators.""}]",0.5,[],"",SRG-OS-000113-GPOS-00058,V-89697,SV-100347r1_rule,VRAU-SL-000715,F-96439r1_fix,"[""CCI-001942""]","[""IA-2 (9)"", ""Rev_4""]","","","","","","","","","","","Verify that the SLES for vRealize enforces SSHv2 for network
access to privileged accounts by running the following command:

Replace [ADDRESS] in the following command with the correct IP address based on
the current system configuration.

# ssh -1 [ADDRESS]

An example of the command usage is as follows:
# ssh -1 localhost

The output must be one of the following items:

Protocol major versions differ: 1 vs. 2

OR:

Protocol 1 not allowed in the FIPS mode.

If the output is not one of the above, this is a finding.

OR

Verify that the ssh is configured to enforce SSHv2 for network access to
privileged accounts by running the following command:

# grep Protocol /etc/ssh/sshd_config

If the result is not ""Protocol 2"", this is a finding.","Configure the SLES for vRealize to enforce SSHv2 for network
access to non-privileged accounts by running the following commands:

# sed -i 's/^.*\bProtocol\b.*$/Protocol 2/' /etc/ssh/sshd_config

Restart the ssh service:

# service sshd restart","control ""V-89697"" do
  title ""The SLES for vRealize must enforce SSHv2 for network access to
non-privileged accounts.""
  desc  ""A replay attack may enable an unauthorized user to gain access to the
operating system. Authentication sessions between the authenticator and the
operating system validating the user credentials must not be vulnerable to a
replay attack.

    An authentication process resists replay attacks if it is impractical to
achieve a successful authentication by recording and replaying a previous
authentication message.

    A non-privileged account is any operating system account with
authorizations of a non-privileged user.

    Techniques used to address this include protocols using nonces (e.g.,
numbers generated for a specific one-time use) or challenges (e.g., TLS,
WS_Security). Additional techniques include time-synchronous or
challenge-response one-time authenticators.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000113-GPOS-00058""
  tag ""gid"": ""V-89697""
  tag ""rid"": ""SV-100347r1_rule""
  tag ""stig_id"": ""VRAU-SL-000715""
  tag ""fix_id"": ""F-96439r1_fix""
  tag ""cci"": [""CCI-001942""]
  tag ""nist"": [""IA-2 (9)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that the SLES for vRealize enforces SSHv2 for network
access to privileged accounts by running the following command:

Replace [ADDRESS] in the following command with the correct IP address based on
the current system configuration.

# ssh -1 [ADDRESS]

An example of the command usage is as follows:
# ssh -1 localhost

The output must be one of the following items:

Protocol major versions differ: 1 vs. 2

OR:

Protocol 1 not allowed in the FIPS mode.

If the output is not one of the above, this is a finding.

OR

Verify that the ssh is configured to enforce SSHv2 for network access to
privileged accounts by running the following command:

# grep Protocol /etc/ssh/sshd_config

If the result is not \""Protocol 2\"", this is a finding.""
  tag ""fix"": ""Configure the SLES for vRealize to enforce SSHv2 for network
access to non-privileged accounts by running the following commands:

# sed -i 's/^.*\\bProtocol\\b.*$/Protocol 2/' /etc/ssh/sshd_config

Restart the ssh service:

# service sshd restart""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89697.rb""}","","","","",""
V-89699,"The SLES for vRealize must disable account identifiers of individuals
and roles (such as root) after 35 days of inactivity after password expiration.","Inactive identifiers pose a risk to systems and applications because
attackers may exploit an inactive identifier and potentially obtain undetected
access to the system. Owners of inactive accounts will not notice if
unauthorized access to their user account has been obtained.

    Operating systems need to track periods of inactivity and disable
application identifiers after 35 days of inactivity.","[{""label""=>""default"", ""data""=>""Inactive identifiers pose a risk to systems and applications because\nattackers may exploit an inactive identifier and potentially obtain undetected\naccess to the system. Owners of inactive accounts will not notice if\nunauthorized access to their user account has been obtained.\n\n    Operating systems need to track periods of inactivity and disable\napplication identifiers after 35 days of inactivity.""}]",0.5,[],"",SRG-OS-000118-GPOS-00060,V-89699,SV-100349r1_rule,VRAU-SL-000725,F-96441r1_fix,"[""CCI-000795""]","[""IA-4 e"", ""Rev_4""]","","","","","","","","","","","Verify the SLES for vRealize disables account identifiers after
""35"" days of inactivity after the password expiration, by performing the
following commands:

# grep ""INACTIVE"" /etc/default/useradd

The output must indicate the ""INACTIVE"" configuration option is set to an
appropriate integer as shown in the example below:

grep ""INACTIVE"" /etc/default/useradd
INACTIVE=35

If ""INACTIVE"" is not set to the value of ""35"" or less, this is a finding.","Configure the SLES for vRealize to disable account identifiers
after 35 days of inactivity after the password expiration. Run the following
command to change the configuration for useradd:

Replace [VALUE] in the command with any integer from the range 0<[VALUE]<= 35.
# sed -i ""s/^.*\bINACTIVE\b.*$/INACTIVE=[VALUE]/"" /etc/default/useradd

DoD recommendation is ""35"" days, but a lower value is acceptable. The value
""-1"" will disable this feature and ""0"" will disable the account immediately
after the password expires.","control ""V-89699"" do
  title ""The SLES for vRealize must disable account identifiers of individuals
and roles (such as root) after 35 days of inactivity after password expiration.""
  desc  ""Inactive identifiers pose a risk to systems and applications because
attackers may exploit an inactive identifier and potentially obtain undetected
access to the system. Owners of inactive accounts will not notice if
unauthorized access to their user account has been obtained.

    Operating systems need to track periods of inactivity and disable
application identifiers after 35 days of inactivity.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000118-GPOS-00060""
  tag ""gid"": ""V-89699""
  tag ""rid"": ""SV-100349r1_rule""
  tag ""stig_id"": ""VRAU-SL-000725""
  tag ""fix_id"": ""F-96441r1_fix""
  tag ""cci"": [""CCI-000795""]
  tag ""nist"": [""IA-4 e"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the SLES for vRealize disables account identifiers after
\""35\"" days of inactivity after the password expiration, by performing the
following commands:

# grep \""INACTIVE\"" /etc/default/useradd

The output must indicate the \""INACTIVE\"" configuration option is set to an
appropriate integer as shown in the example below:

grep \""INACTIVE\"" /etc/default/useradd
INACTIVE=35

If \""INACTIVE\"" is not set to the value of \""35\"" or less, this is a finding.""
  tag ""fix"": ""Configure the SLES for vRealize to disable account identifiers
after 35 days of inactivity after the password expiration. Run the following
command to change the configuration for useradd:

Replace [VALUE] in the command with any integer from the range 0<[VALUE]<= 35.
# sed -i \""s/^.*\\bINACTIVE\\b.*$/INACTIVE=[VALUE]/\"" /etc/default/useradd

DoD recommendation is \""35\"" days, but a lower value is acceptable. The value
\""-1\"" will disable this feature and \""0\"" will disable the account immediately
after the password expires.""

describe parse_config_file('/etc/default/useradd') do
  its('INACTIVE') { should cmp 35 }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89699.rb""}",passed,Parse Config File /etc/default/useradd INACTIVE should cmp == 35,0.000295,2019-08-01T08:47:33-07:00,""
V-89701,"The SLES for vRealize must use mechanisms meeting the requirements of
applicable federal laws, Executive orders, directives, policies, regulations,
standards, and guidance for authentication to a cryptographic module.","Unapproved mechanisms that are used for authentication to the
cryptographic module are not verified and therefore cannot be relied upon to
provide confidentiality or integrity, and DoD data may be compromised.

    Operating systems utilizing encryption are required to use FIPS-compliant
mechanisms for authenticating to cryptographic modules.

    FIPS 140-2 is the current standard for validating that mechanisms used to
access cryptographic modules utilize authentication that meets DoD
requirements. This allows for Security Levels 1, 2, 3, or 4 for use on a
general purpose computing system.","[{""label""=>""default"", ""data""=>""Unapproved mechanisms that are used for authentication to the\ncryptographic module are not verified and therefore cannot be relied upon to\nprovide confidentiality or integrity, and DoD data may be compromised.\n\n    Operating systems utilizing encryption are required to use FIPS-compliant\nmechanisms for authenticating to cryptographic modules.\n\n    FIPS 140-2 is the current standard for validating that mechanisms used to\naccess cryptographic modules utilize authentication that meets DoD\nrequirements. This allows for Security Levels 1, 2, 3, or 4 for use on a\ngeneral purpose computing system.""}]",0.5,[],",
",SRG-OS-000120-GPOS-00061,V-89701,SV-100351r1_rule,VRAU-SL-000730,F-96443r1_fix,"[""CCI-000803""]","[""IA-7"", ""Rev_4""]",",
",",
",",
",",
",",
",",
",",
",",
",",
",",
","Check the /etc/default/passwd file:

# grep CRYPT /etc/default/passwd

If the ""CRYPT"" setting in /etc/default/passwd is not present, or not set to
""SHA256"" or ""SHA512"", this is a finding.

If the ""CRYPT_FILES"" setting in /etc/default/passwd is not present, or not
set to ""SHA256"" or ""SHA512"", this is a finding.","Edit the /etc/default/passwd file and add or change the ""CRYPT""
variable setting so that it contains:

CRYPT=sha256
OR
CRYPT=sha512

Edit the /etc/default/passwd file and add or change the ""CRYPT_FILES""
variable setting so that it contains:

CRYPT_FILES=sha256
OR
CRYPT_FILES=sha512","control ""V-89701"" do
  title ""The SLES for vRealize must use mechanisms meeting the requirements of
applicable federal laws, Executive orders, directives, policies, regulations,
standards, and guidance for authentication to a cryptographic module.""
  desc  ""Unapproved mechanisms that are used for authentication to the
cryptographic module are not verified and therefore cannot be relied upon to
provide confidentiality or integrity, and DoD data may be compromised.

    Operating systems utilizing encryption are required to use FIPS-compliant
mechanisms for authenticating to cryptographic modules.

    FIPS 140-2 is the current standard for validating that mechanisms used to
access cryptographic modules utilize authentication that meets DoD
requirements. This allows for Security Levels 1, 2, 3, or 4 for use on a
general purpose computing system.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000120-GPOS-00061""
  tag ""gid"": ""V-89701""
  tag ""rid"": ""SV-100351r1_rule""
  tag ""stig_id"": ""VRAU-SL-000730""
  tag ""fix_id"": ""F-96443r1_fix""
  tag ""cci"": [""CCI-000803""]
  tag ""nist"": [""IA-7"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the /etc/default/passwd file:

# grep CRYPT /etc/default/passwd

If the \""CRYPT\"" setting in /etc/default/passwd is not present, or not set to
\""SHA256\"" or \""SHA512\"", this is a finding.

If the \""CRYPT_FILES\"" setting in /etc/default/passwd is not present, or not
set to \""SHA256\"" or \""SHA512\"", this is a finding.""
  tag ""fix"": ""Edit the /etc/default/passwd file and add or change the \""CRYPT\""
variable setting so that it contains:

CRYPT=sha256
OR
CRYPT=sha512

Edit the /etc/default/passwd file and add or change the \""CRYPT_FILES\""
variable setting so that it contains:

CRYPT_FILES=sha256
OR
CRYPT_FILES=sha512""

#CRYPT
describe.one do
  describe parse_config_file('/etc/default/passwd') do
    its('CRYPT') { should cmp 'SHA512' }
  end

  describe parse_config_file('/etc/default/passwd') do
    its('CRYPT') { should cmp 'SHA256'}
  end

end

#CRYPT_FILES
describe.one do
  describe parse_config_file('/etc/default/passwd') do
    its('CRYPT_FILES') { should cmp 'SHA512' }
  end

  describe parse_config_file('/etc/default/passwd') do
    its('CRYPT_FILES') { should cmp 'SHA256'}
  end

end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89701.rb""}","passed,
passed","Parse Config File /etc/default/passwd CRYPT should cmp == ""SHA512"",
Parse Config File /etc/default/passwd CRYPT_FILES should cmp == ""SHA512""","0.0002195,
0.000181","2019-08-01T08:47:33-07:00,
2019-08-01T08:47:33-07:00",",
"
V-89703,"The SLES for vRealize must uniquely identify and must authenticate
non-organizational users (or processes acting on behalf of non-organizational
users).","Lack of authentication and identification enables non-organizational
users to gain access to the application or possibly other information systems
and provides an opportunity for intruders to compromise resources within the
application or information system.

    Non-organizational users include all information system users other than
organizational users, which include organizational employees or individuals the
organization deems to have equivalent status of an employee (e.g., contractors
and guest researchers).

    Non-organizational users must be uniquely identified and authenticated for
all accesses other than those accesses explicitly identified and documented by
the organization when related to the use of anonymous access.","[{""label""=>""default"", ""data""=>""Lack of authentication and identification enables non-organizational\nusers to gain access to the application or possibly other information systems\nand provides an opportunity for intruders to compromise resources within the\napplication or information system.\n\n    Non-organizational users include all information system users other than\norganizational users, which include organizational employees or individuals the\norganization deems to have equivalent status of an employee (e.g., contractors\nand guest researchers).\n\n    Non-organizational users must be uniquely identified and authenticated for\nall accesses other than those accesses explicitly identified and documented by\nthe organization when related to the use of anonymous access.""}]",0.5,[],"",SRG-OS-000121-GPOS-00062,V-89703,SV-100353r1_rule,VRAU-SL-000735,F-96445r1_fix,"[""CCI-000804""]","[""IA-8"", ""Rev_4""]","","","","","","","","","","","Run the following command to check for duplicate account names:

# pwck -rq

If there are no duplicate names, no line will be returned.

If a line is returned, this is a finding.","Change usernames, or delete accounts, so each has a unique name.","control ""V-89703"" do
  title ""The SLES for vRealize must uniquely identify and must authenticate
non-organizational users (or processes acting on behalf of non-organizational
users).""
  desc  ""Lack of authentication and identification enables non-organizational
users to gain access to the application or possibly other information systems
and provides an opportunity for intruders to compromise resources within the
application or information system.

    Non-organizational users include all information system users other than
organizational users, which include organizational employees or individuals the
organization deems to have equivalent status of an employee (e.g., contractors
and guest researchers).

    Non-organizational users must be uniquely identified and authenticated for
all accesses other than those accesses explicitly identified and documented by
the organization when related to the use of anonymous access.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000121-GPOS-00062""
  tag ""gid"": ""V-89703""
  tag ""rid"": ""SV-100353r1_rule""
  tag ""stig_id"": ""VRAU-SL-000735""
  tag ""fix_id"": ""F-96445r1_fix""
  tag ""cci"": [""CCI-000804""]
  tag ""nist"": [""IA-8"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Run the following command to check for duplicate account names:

# pwck -rq

If there are no duplicate names, no line will be returned.

If a line is returned, this is a finding.""
  tag ""fix"": ""Change usernames, or delete accounts, so each has a unique name.""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89703.rb""}","","","","",""
V-89705,All GIDs referenced in /etc/passwd must be defined in /etc/group.,"Inconsistency in GIDs between /etc/passwd and /etc/group could lead to
a user having unintended rights.","[{""label""=>""default"", ""data""=>""Inconsistency in GIDs between /etc/passwd and /etc/group could lead to\na user having unintended rights.""}]",0.5,[],"",SRG-OS-000121-GPOS-00062,V-89705,SV-100355r1_rule,VRAU-SL-000740,F-96447r1_fix,"[""CCI-000804""]","[""IA-8"", ""Rev_4""]","","","","","","","","","","","To ensure all GIDs referenced in /etc/passwd are defined in
/etc/group, run the following command:

# pwck -rq

If a line is returned, this is a finding.","Add a group to the system for each GID referenced without a
corresponding group.","control ""V-89705"" do
  title ""All GIDs referenced in /etc/passwd must be defined in /etc/group.""
  desc  ""Inconsistency in GIDs between /etc/passwd and /etc/group could lead to
a user having unintended rights.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000121-GPOS-00062""
  tag ""gid"": ""V-89705""
  tag ""rid"": ""SV-100355r1_rule""
  tag ""stig_id"": ""VRAU-SL-000740""
  tag ""fix_id"": ""F-96447r1_fix""
  tag ""cci"": [""CCI-000804""]
  tag ""nist"": [""IA-8"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To ensure all GIDs referenced in /etc/passwd are defined in
/etc/group, run the following command:

# pwck -rq

If a line is returned, this is a finding.""
  tag ""fix"": ""Add a group to the system for each GID referenced without a
corresponding group.""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89705.rb""}","","","","",""
V-89707,"The SLES for vRealize must uniquely identify and must authenticate
non-organizational users (or processes acting on behalf of non-organizational
users).","Lack of authentication and identification enables non-organizational
users to gain access to the application or possibly other information systems
and provides an opportunity for intruders to compromise resources within the
application or information system.

    Non-organizational users include all information system users other than
organizational users, which include organizational employees or individuals the
organization deems to have equivalent status of an employee (e.g., contractors
and guest researchers).

    Non-organizational users must be uniquely identified and authenticated for
all accesses other than those accesses explicitly identified and documented by
the organization when related to the use of anonymous access.","[{""label""=>""default"", ""data""=>""Lack of authentication and identification enables non-organizational\nusers to gain access to the application or possibly other information systems\nand provides an opportunity for intruders to compromise resources within the\napplication or information system.\n\n    Non-organizational users include all information system users other than\norganizational users, which include organizational employees or individuals the\norganization deems to have equivalent status of an employee (e.g., contractors\nand guest researchers).\n\n    Non-organizational users must be uniquely identified and authenticated for\nall accesses other than those accesses explicitly identified and documented by\nthe organization when related to the use of anonymous access.""}]",0.5,[],"",SRG-OS-000121-GPOS-00062,V-89707,SV-100357r1_rule,VRAU-SL-000745,F-96449r1_fix,"[""CCI-000804""]","[""IA-8"", ""Rev_4""]","","","","","","","","","","","Verify the SLES for vRealize uniquely identifies and
authenticates non-organizational users by running the following commands:

# awk -F: '{print $3}' /etc/passwd | sort | uniq -d

If the output is not blank, this is a finding.","Configure the SLES for vRealize to uniquely identify and
authenticate non-organizational users (or processes acting on behalf of
non-organizational users).

UNIQUE_USER_ID is a unique numerical value that must be non-negative. USERNAME
is the username of the user whose user ID is to be changed.

# usermod -u [UNIQUE_USER_ID] [USERNAME]","control ""V-89707"" do
  title ""The SLES for vRealize must uniquely identify and must authenticate
non-organizational users (or processes acting on behalf of non-organizational
users).""
  desc  ""Lack of authentication and identification enables non-organizational
users to gain access to the application or possibly other information systems
and provides an opportunity for intruders to compromise resources within the
application or information system.

    Non-organizational users include all information system users other than
organizational users, which include organizational employees or individuals the
organization deems to have equivalent status of an employee (e.g., contractors
and guest researchers).

    Non-organizational users must be uniquely identified and authenticated for
all accesses other than those accesses explicitly identified and documented by
the organization when related to the use of anonymous access.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000121-GPOS-00062""
  tag ""gid"": ""V-89707""
  tag ""rid"": ""SV-100357r1_rule""
  tag ""stig_id"": ""VRAU-SL-000745""
  tag ""fix_id"": ""F-96449r1_fix""
  tag ""cci"": [""CCI-000804""]
  tag ""nist"": [""IA-8"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the SLES for vRealize uniquely identifies and
authenticates non-organizational users by running the following commands:

# awk -F: '{print $3}' /etc/passwd | sort | uniq -d

If the output is not blank, this is a finding.""
  tag ""fix"": ""Configure the SLES for vRealize to uniquely identify and
authenticate non-organizational users (or processes acting on behalf of
non-organizational users).

UNIQUE_USER_ID is a unique numerical value that must be non-negative. USERNAME
is the username of the user whose user ID is to be changed.

# usermod -u [UNIQUE_USER_ID] [USERNAME]""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89707.rb""}","","","","",""
V-89709,"The SLES for vRealize must be configured such that emergency
administrator accounts are never automatically removed or disabled.","Emergency administrator accounts are privileged accounts that are
established in response to crisis situations where the need for rapid account
activation is required. Therefore, emergency account activation may bypass
normal account authorization processes. If these accounts are automatically
disabled, system maintenance during emergencies may not be possible, thus
adversely affecting system availability.

    Emergency administrator accounts are different from infrequently used
accounts (i.e., local logon accounts used by system administrators when network
or normal logon/access is not available). Infrequently used accounts also
remain available and are not subject to automatic termination dates. However,
an emergency administrator account is normally a different account that is
created for use by vendors or system maintainers.

    To address access requirements, many operating systems can be integrated
with enterprise-level authentication/access mechanisms that meet or exceed
access control policy requirements.","[{""label""=>""default"", ""data""=>""Emergency administrator accounts are privileged accounts that are\nestablished in response to crisis situations where the need for rapid account\nactivation is required. Therefore, emergency account activation may bypass\nnormal account authorization processes. If these accounts are automatically\ndisabled, system maintenance during emergencies may not be possible, thus\nadversely affecting system availability.\n\n    Emergency administrator accounts are different from infrequently used\naccounts (i.e., local logon accounts used by system administrators when network\nor normal logon/access is not available). Infrequently used accounts also\nremain available and are not subject to automatic termination dates. However,\nan emergency administrator account is normally a different account that is\ncreated for use by vendors or system maintainers.\n\n    To address access requirements, many operating systems can be integrated\nwith enterprise-level authentication/access mechanisms that meet or exceed\naccess control policy requirements.""}]",0.5,[],"",SRG-OS-000123-GPOS-00064,V-89709,SV-100359r1_rule,VRAU-SL-000755,F-96451r1_fix,"[""CCI-001682""]","[""AC-2 (2)"", ""Rev_4""]","","","","","","","","","","","For each emergency administrator account run the following
command:

chage -l [user]

If the output shows an expiration date for the account, this is a finding.","For each emergency administrator account run the following
command to remove the expiration:

chage -E -1 [user]","control ""V-89709"" do
  title ""The SLES for vRealize must be configured such that emergency
administrator accounts are never automatically removed or disabled.""
  desc  ""Emergency administrator accounts are privileged accounts that are
established in response to crisis situations where the need for rapid account
activation is required. Therefore, emergency account activation may bypass
normal account authorization processes. If these accounts are automatically
disabled, system maintenance during emergencies may not be possible, thus
adversely affecting system availability.

    Emergency administrator accounts are different from infrequently used
accounts (i.e., local logon accounts used by system administrators when network
or normal logon/access is not available). Infrequently used accounts also
remain available and are not subject to automatic termination dates. However,
an emergency administrator account is normally a different account that is
created for use by vendors or system maintainers.

    To address access requirements, many operating systems can be integrated
with enterprise-level authentication/access mechanisms that meet or exceed
access control policy requirements.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000123-GPOS-00064""
  tag ""gid"": ""V-89709""
  tag ""rid"": ""SV-100359r1_rule""
  tag ""stig_id"": ""VRAU-SL-000755""
  tag ""fix_id"": ""F-96451r1_fix""
  tag ""cci"": [""CCI-001682""]
  tag ""nist"": [""AC-2 (2)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""For each emergency administrator account run the following
command:

chage -l [user]

If the output shows an expiration date for the account, this is a finding.""
  tag ""fix"": ""For each emergency administrator account run the following
command to remove the expiration:

chage -E -1 [user]""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89709.rb""}","","","","",""
V-89711,"The SLES for vRealize must employ strong authenticators in the
establishment of nonlocal maintenance and diagnostic sessions.","If maintenance tools are used by unauthorized personnel, they may
accidentally or intentionally damage or compromise the system. The act of
managing systems and applications includes the ability to access sensitive
application information, such as system configuration details, diagnostic
information, user information, and potentially sensitive application data.

    Some maintenance and test tools are either standalone devices with their
own operating systems or are applications bundled with an operating system.

    Nonlocal maintenance and diagnostic activities are those activities
conducted by individuals communicating through a network, either an external
network (e.g., the Internet) or an internal network. Local maintenance and
diagnostic activities are those activities carried out by individuals
physically present at the information system or information system component
and not communicating across a network connection. Typically, strong
authentication requires authenticators that are resistant to replay attacks and
employ multifactor authentication. Strong authenticators include, for example,
PKI where certificates are stored on a token protected by a password,
passphrase, or biometric.","[{""label""=>""default"", ""data""=>""If maintenance tools are used by unauthorized personnel, they may\naccidentally or intentionally damage or compromise the system. The act of\nmanaging systems and applications includes the ability to access sensitive\napplication information, such as system configuration details, diagnostic\ninformation, user information, and potentially sensitive application data.\n\n    Some maintenance and test tools are either standalone devices with their\nown operating systems or are applications bundled with an operating system.\n\n    Nonlocal maintenance and diagnostic activities are those activities\nconducted by individuals communicating through a network, either an external\nnetwork (e.g., the Internet) or an internal network. Local maintenance and\ndiagnostic activities are those activities carried out by individuals\nphysically present at the information system or information system component\nand not communicating across a network connection. Typically, strong\nauthentication requires authenticators that are resistant to replay attacks and\nemploy multifactor authentication. Strong authenticators include, for example,\nPKI where certificates are stored on a token protected by a password,\npassphrase, or biometric.""}]",0.5,[],"",SRG-OS-000125-GPOS-00065,V-89711,SV-100361r1_rule,VRAU-SL-000760,F-96453r2_fix,"[""CCI-000877""]","[""MA-4 c"", ""Rev_4""]","","","","","","","","","","","Check the SSH daemon configuration for DoD-approved encryption
to protect the confidentiality of SSH remote connections by performing the
following commands:

Check the ""Ciphers"" setting in the ""sshd_config"" file.

# grep -i Ciphers /etc/ssh/sshd_config  | grep -v '#'

The output must contain either nothing or any number of the following
algorithms:

aes128-ctr, aes256-ctr.

If the output contains an algorithm not listed above, this is a finding.

Expected Output:
Ciphers aes256-ctr,aes128-ctr","Update the ""Ciphers"" directive with the following command:

# sed -i ""/^[^#]*Ciphers/ c\Ciphers aes256-ctr,aes128-ctr""
/etc/ssh/sshd_config

Save and close the file.

Restart the sshd process:

# service sshd restart","control ""V-89711"" do
  title ""The SLES for vRealize must employ strong authenticators in the
establishment of nonlocal maintenance and diagnostic sessions.""
  desc  ""If maintenance tools are used by unauthorized personnel, they may
accidentally or intentionally damage or compromise the system. The act of
managing systems and applications includes the ability to access sensitive
application information, such as system configuration details, diagnostic
information, user information, and potentially sensitive application data.

    Some maintenance and test tools are either standalone devices with their
own operating systems or are applications bundled with an operating system.

    Nonlocal maintenance and diagnostic activities are those activities
conducted by individuals communicating through a network, either an external
network (e.g., the Internet) or an internal network. Local maintenance and
diagnostic activities are those activities carried out by individuals
physically present at the information system or information system component
and not communicating across a network connection. Typically, strong
authentication requires authenticators that are resistant to replay attacks and
employ multifactor authentication. Strong authenticators include, for example,
PKI where certificates are stored on a token protected by a password,
passphrase, or biometric.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000125-GPOS-00065""
  tag ""gid"": ""V-89711""
  tag ""rid"": ""SV-100361r1_rule""
  tag ""stig_id"": ""VRAU-SL-000760""
  tag ""fix_id"": ""F-96453r2_fix""
  tag ""cci"": [""CCI-000877""]
  tag ""nist"": [""MA-4 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the SSH daemon configuration for DoD-approved encryption
to protect the confidentiality of SSH remote connections by performing the
following commands:

Check the \""Ciphers\"" setting in the \""sshd_config\"" file.

# grep -i Ciphers /etc/ssh/sshd_config  | grep -v '#'

The output must contain either nothing or any number of the following
algorithms:

aes128-ctr, aes256-ctr.

If the output contains an algorithm not listed above, this is a finding.

Expected Output:
Ciphers aes256-ctr,aes128-ctr""
  tag ""fix"": ""Update the \""Ciphers\"" directive with the following command:

# sed -i \""/^[^#]*Ciphers/ c\\Ciphers aes256-ctr,aes128-ctr\""
/etc/ssh/sshd_config

Save and close the file.

Restart the sshd process:

# service sshd restart""

describe sshd_config do
  its('Ciphers') { should cmp 'aes256-ctr,aes128-ctr' }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89711.rb""}",passed,"SSHD Configuration Ciphers should cmp == ""aes256-ctr,aes128-ctr""",0.0009336,2019-08-01T08:47:33-07:00,""
V-89713,"The SLES for vRealize must terminate all sessions and network
connections related to nonlocal maintenance when nonlocal maintenance is
completed.","If a maintenance session or connection remains open after maintenance
is completed, it may be hijacked by an attacker and used to compromise or
damage the system.

    Some maintenance and test tools are either standalone devices with their
own operating systems or are applications bundled with an operating system.

    Nonlocal maintenance and diagnostic activities are those activities
conducted by individuals communicating through a network, either an external
network (e.g., the Internet) or an internal network. Local maintenance and
diagnostic activities are those activities carried out by individuals
physically present at the information system or information system component
and not communicating across a network connection.","[{""label""=>""default"", ""data""=>""If a maintenance session or connection remains open after maintenance\nis completed, it may be hijacked by an attacker and used to compromise or\ndamage the system.\n\n    Some maintenance and test tools are either standalone devices with their\nown operating systems or are applications bundled with an operating system.\n\n    Nonlocal maintenance and diagnostic activities are those activities\nconducted by individuals communicating through a network, either an external\nnetwork (e.g., the Internet) or an internal network. Local maintenance and\ndiagnostic activities are those activities carried out by individuals\nphysically present at the information system or information system component\nand not communicating across a network connection.""}]",0.5,[],"",SRG-OS-000126-GPOS-00066,V-89713,SV-100363r1_rule,VRAU-SL-000765,F-96455r1_fix,"[""CCI-000879""]","[""MA-4 e"", ""Rev_4""]","","","","","","","","","","","Check for the existence of the /etc/profile.d/tmout.sh file:

# ls -al /etc/profile.d/tmout.sh

Check for the presence of the ""TMOUT"" variable:

# grep TMOUT /etc/profile.d/tmout.sh

The value of ""TMOUT"" should be set to ""900"" seconds (15 minutes).

If the file does not exist, or the ""TMOUT"" variable is not set to ""900"",
this is a finding.","Ensure the file exists and is owned by ""root"". If the files
does not exist, use the following commands to create the file:

# touch /etc/profile.d/tmout.sh
# chown root:root /etc/profile.d/tmout.sh
# chmod 644 /etc/profile.d/tmout.sh

Edit the file /etc/profile.d/tmout.sh, and add the following lines:

TMOUT=900
readonly TMOUT
export TMOUT
mesg n 2>/dev/null","control ""V-89713"" do
  title ""The SLES for vRealize must terminate all sessions and network
connections related to nonlocal maintenance when nonlocal maintenance is
completed.""
  desc  "" If a maintenance session or connection remains open after maintenance
is completed, it may be hijacked by an attacker and used to compromise or
damage the system.

    Some maintenance and test tools are either standalone devices with their
own operating systems or are applications bundled with an operating system.

    Nonlocal maintenance and diagnostic activities are those activities
conducted by individuals communicating through a network, either an external
network (e.g., the Internet) or an internal network. Local maintenance and
diagnostic activities are those activities carried out by individuals
physically present at the information system or information system component
and not communicating across a network connection.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000126-GPOS-00066""
  tag ""gid"": ""V-89713""
  tag ""rid"": ""SV-100363r1_rule""
  tag ""stig_id"": ""VRAU-SL-000765""
  tag ""fix_id"": ""F-96455r1_fix""
  tag ""cci"": [""CCI-000879""]
  tag ""nist"": [""MA-4 e"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check for the existence of the /etc/profile.d/tmout.sh file:

# ls -al /etc/profile.d/tmout.sh

Check for the presence of the \""TMOUT\"" variable:

# grep TMOUT /etc/profile.d/tmout.sh

The value of \""TMOUT\"" should be set to \""900\"" seconds (15 minutes).

If the file does not exist, or the \""TMOUT\"" variable is not set to \""900\"",
this is a finding.""
  tag ""fix"": ""Ensure the file exists and is owned by \""root\"". If the files
does not exist, use the following commands to create the file:

# touch /etc/profile.d/tmout.sh
# chown root:root /etc/profile.d/tmout.sh
# chmod 644 /etc/profile.d/tmout.sh

Edit the file /etc/profile.d/tmout.sh, and add the following lines:

TMOUT=900
readonly TMOUT
export TMOUT
mesg n 2>/dev/null""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89713.rb""}","","","","",""
V-89715,"The SLES for vRealize must manage excess capacity, bandwidth, or other
redundancy to limit the effects of information flooding types of Denial of
Service (DoS) attacks.","DoS is a condition when a resource is not available for legitimate
users. When this occurs, the organization either cannot accomplish its mission
or must operate at degraded capacity.

    Managing excess capacity ensures that sufficient capacity is available to
counter flooding attacks. Employing increased capacity and service redundancy
may reduce the susceptibility to some DoS attacks. Managing excess capacity may
include, for example, establishing selected usage priorities, quotas, or
partitioning.","[{""label""=>""default"", ""data""=>""DoS is a condition when a resource is not available for legitimate\nusers. When this occurs, the organization either cannot accomplish its mission\nor must operate at degraded capacity.\n\n    Managing excess capacity ensures that sufficient capacity is available to\ncounter flooding attacks. Employing increased capacity and service redundancy\nmay reduce the susceptibility to some DoS attacks. Managing excess capacity may\ninclude, for example, establishing selected usage priorities, quotas, or\npartitioning.""}]",0.5,[],"",SRG-OS-000142-GPOS-00071,V-89715,SV-100365r1_rule,VRAU-SL-000785,F-96457r2_fix,"[""CCI-001095""]","[""SC-5 (2)"", ""Rev_4""]","","","","","","","","","","","Check that the SLES for vRealize configured to use TCP
syncookies when experiencing a TCP SYN flood.

# cat /proc/sys/net/ipv4/tcp_syncookies

If the result is not ""1"", this is a finding.","Configure the SLES for vRealize to use TCP syncookies when
experiencing a TCP SYN flood.

# sed -i 's/^.*\bnet.ipv4.tcp_syncookies\b.*$/net.ipv4.tcp_syncookies=1/'
/etc/sysctl.conf

Reload sysctl to verify the new change:

# sysctl -p","control ""V-89715"" do
  title ""The SLES for vRealize must manage excess capacity, bandwidth, or other
redundancy to limit the effects of information flooding types of Denial of
Service (DoS) attacks.""
  desc  ""DoS is a condition when a resource is not available for legitimate
users. When this occurs, the organization either cannot accomplish its mission
or must operate at degraded capacity.

    Managing excess capacity ensures that sufficient capacity is available to
counter flooding attacks. Employing increased capacity and service redundancy
may reduce the susceptibility to some DoS attacks. Managing excess capacity may
include, for example, establishing selected usage priorities, quotas, or
partitioning.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000142-GPOS-00071""
  tag ""gid"": ""V-89715""
  tag ""rid"": ""SV-100365r1_rule""
  tag ""stig_id"": ""VRAU-SL-000785""
  tag ""fix_id"": ""F-96457r2_fix""
  tag ""cci"": [""CCI-001095""]
  tag ""nist"": [""SC-5 (2)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check that the SLES for vRealize configured to use TCP
syncookies when experiencing a TCP SYN flood.

# cat /proc/sys/net/ipv4/tcp_syncookies

If the result is not \""1\"", this is a finding.""
  tag ""fix"": ""Configure the SLES for vRealize to use TCP syncookies when
experiencing a TCP SYN flood.

# sed -i 's/^.*\\bnet.ipv4.tcp_syncookies\\b.*$/net.ipv4.tcp_syncookies=1/'
/etc/sysctl.conf

Reload sysctl to verify the new change:

# sysctl -p""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89715.rb""}","","","","",""
V-89717,"The SLES for vRealize must manage excess capacity, bandwidth, or other
redundancy to limit the effects of information flooding types of Denial of
Service (DoS) attacks.","DoS is a condition when a resource is not available for legitimate
users. When this occurs, the organization either cannot accomplish its mission
or must operate at degraded capacity.

    Managing excess capacity ensures that sufficient capacity is available to
counter flooding attacks. Employing increased capacity and service redundancy
may reduce the susceptibility to some DoS attacks. Managing excess capacity may
include, for example, establishing selected usage priorities, quotas, or
partitioning.","[{""label""=>""default"", ""data""=>""DoS is a condition when a resource is not available for legitimate\nusers. When this occurs, the organization either cannot accomplish its mission\nor must operate at degraded capacity.\n\n    Managing excess capacity ensures that sufficient capacity is available to\ncounter flooding attacks. Employing increased capacity and service redundancy\nmay reduce the susceptibility to some DoS attacks. Managing excess capacity may\ninclude, for example, establishing selected usage priorities, quotas, or\npartitioning.""}]",0.5,[],"",SRG-OS-000142-GPOS-00071,V-89717,SV-100367r1_rule,VRAU-SL-000790,F-96459r1_fix,"[""CCI-001095""]","[""SC-5 (2)"", ""Rev_4""]","","","","","","","","","","","Check that the SLES for vRealize has an appropriate TCP backlog
queue size to mitigate against TCP SYN flood DOS attacks with the following
command:

# cat /proc/sys/net/ipv4/tcp_max_syn_backlog

If the TCP backlog queue size is not set to at least the recommended default
setting of ""1280"", this is a finding.","Configure the TCP backlog queue size with the following command:

# sed -i
's/^.*\bnet.ipv4.tcp_max_syn_backlog\b.*$/net.ipv4.tcp_max_syn_backlog=1280/'
/etc/sysctl.conf

Reload sysctl to verify the new change:

# sysctl -p","control ""V-89717"" do
  title ""The SLES for vRealize must manage excess capacity, bandwidth, or other
redundancy to limit the effects of information flooding types of Denial of
Service (DoS) attacks.""
  desc  ""DoS is a condition when a resource is not available for legitimate
users. When this occurs, the organization either cannot accomplish its mission
or must operate at degraded capacity.

    Managing excess capacity ensures that sufficient capacity is available to
counter flooding attacks. Employing increased capacity and service redundancy
may reduce the susceptibility to some DoS attacks. Managing excess capacity may
include, for example, establishing selected usage priorities, quotas, or
partitioning.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000142-GPOS-00071""
  tag ""gid"": ""V-89717""
  tag ""rid"": ""SV-100367r1_rule""
  tag ""stig_id"": ""VRAU-SL-000790""
  tag ""fix_id"": ""F-96459r1_fix""
  tag ""cci"": [""CCI-001095""]
  tag ""nist"": [""SC-5 (2)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check that the SLES for vRealize has an appropriate TCP backlog
queue size to mitigate against TCP SYN flood DOS attacks with the following
command:

# cat /proc/sys/net/ipv4/tcp_max_syn_backlog

If the TCP backlog queue size is not set to at least the recommended default
setting of \""1280\"", this is a finding.""
  tag ""fix"": ""Configure the TCP backlog queue size with the following command:

# sed -i
's/^.*\\bnet.ipv4.tcp_max_syn_backlog\\b.*$/net.ipv4.tcp_max_syn_backlog=1280/'
/etc/sysctl.conf

Reload sysctl to verify the new change:

# sysctl -p""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89717.rb""}","","","","",""
V-89719,"The SLES for vRealize must terminate all network connections
associated with a communications session at the end of the session, or as
follows: for in-band management sessions (privileged sessions), the session
must be terminated after 10 minutes of inactivity; and for user sessions
(non-privileged session), the session must be terminated after 15 minutes of
inactivity, except to fulfill documented and validated mission requirements.","Terminating an idle session within a short time period reduces the
window of opportunity for unauthorized personnel to take control of a
management session enabled on the console or console port that has been left
unattended. In addition, quickly terminating an idle session will also free up
resources committed by the managed network element.

    Terminating network connections associated with communications sessions
includes, for example, de-allocating associated TCP/IP address/port pairs at
the operating system level, and de-allocating networking assignments at the
application level if multiple application sessions are using a single operating
system-level network connection. This does not mean that the operating system
terminates all sessions or network access; it only ends the inactive session
and releases the resources associated with that session.","[{""label""=>""default"", ""data""=>""Terminating an idle session within a short time period reduces the\nwindow of opportunity for unauthorized personnel to take control of a\nmanagement session enabled on the console or console port that has been left\nunattended. In addition, quickly terminating an idle session will also free up\nresources committed by the managed network element.\n\n    Terminating network connections associated with communications sessions\nincludes, for example, de-allocating associated TCP/IP address/port pairs at\nthe operating system level, and de-allocating networking assignments at the\napplication level if multiple application sessions are using a single operating\nsystem-level network connection. This does not mean that the operating system\nterminates all sessions or network access; it only ends the inactive session\nand releases the resources associated with that session.""}]",0.5,[],"",SRG-OS-000163-GPOS-00072,V-89719,SV-100369r1_rule,VRAU-SL-000795,F-96461r1_fix,"[""CCI-001133""]","[""SC-10"", ""Rev_4""]","","","","","","","","","","","Check for the existence of the /etc/profile.d/tmout.sh file:

# ls -al /etc/profile.d/tmout.sh

Check for the presence of the ""TMOUT"" variable:

# grep TMOUT /etc/profile.d/tmout.sh

The value of ""TMOUT"" should be set to ""900"" seconds (15 minutes).

If the file does not exist, or the ""TMOUT"" variable is not set to ""900"",
this is a finding.","Ensure the file exists and is owned by ""root"". If the files
does not exist, use the following commands to create the file:

# touch /etc/profile.d/tmout.sh
# chown root:root /etc/profile.d/tmout.sh
# chmod 644 /etc/profile.d/tmout.sh

Edit the file /etc/profile.d/tmout.sh, and add the following lines:

TMOUT=900
readonly TMOUT
export TMOUT
mesg n 2>/dev/null","control ""V-89719"" do
  title ""The SLES for vRealize must terminate all network connections
associated with a communications session at the end of the session, or as
follows: for in-band management sessions (privileged sessions), the session
must be terminated after 10 minutes of inactivity; and for user sessions
(non-privileged session), the session must be terminated after 15 minutes of
inactivity, except to fulfill documented and validated mission requirements.""
  desc  ""Terminating an idle session within a short time period reduces the
window of opportunity for unauthorized personnel to take control of a
management session enabled on the console or console port that has been left
unattended. In addition, quickly terminating an idle session will also free up
resources committed by the managed network element.

    Terminating network connections associated with communications sessions
includes, for example, de-allocating associated TCP/IP address/port pairs at
the operating system level, and de-allocating networking assignments at the
application level if multiple application sessions are using a single operating
system-level network connection. This does not mean that the operating system
terminates all sessions or network access; it only ends the inactive session
and releases the resources associated with that session.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000163-GPOS-00072""
  tag ""gid"": ""V-89719""
  tag ""rid"": ""SV-100369r1_rule""
  tag ""stig_id"": ""VRAU-SL-000795""
  tag ""fix_id"": ""F-96461r1_fix""
  tag ""cci"": [""CCI-001133""]
  tag ""nist"": [""SC-10"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check for the existence of the /etc/profile.d/tmout.sh file:

# ls -al /etc/profile.d/tmout.sh

Check for the presence of the \""TMOUT\"" variable:

# grep TMOUT /etc/profile.d/tmout.sh

The value of \""TMOUT\"" should be set to \""900\"" seconds (15 minutes).

If the file does not exist, or the \""TMOUT\"" variable is not set to \""900\"",
this is a finding.""
  tag ""fix"": ""Ensure the file exists and is owned by \""root\"". If the files
does not exist, use the following commands to create the file:

# touch /etc/profile.d/tmout.sh
# chown root:root /etc/profile.d/tmout.sh
# chmod 644 /etc/profile.d/tmout.sh

Edit the file /etc/profile.d/tmout.sh, and add the following lines:

TMOUT=900
readonly TMOUT
export TMOUT
mesg n 2>/dev/null""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89719.rb""}","","","","",""
V-89721,The /var/log directory must be group-owned by root.,"Only authorized personnel should be aware of errors and the details of
the errors. Error messages are an indicator of an organization's operational
state or can identify the operating system or platform. Additionally,
Personally Identifiable Information (PII) and operational information must not
be revealed through error messages to unauthorized personnel or their
designated representatives.

    The structure and content of error messages must be carefully considered by
the organization and development team. The extent to which the information
system is able to identify and handle error conditions is guided by
organizational policy and operational requirements.","[{""label""=>""default"", ""data""=>""Only authorized personnel should be aware of errors and the details of\nthe errors. Error messages are an indicator of an organization's operational\nstate or can identify the operating system or platform. Additionally,\nPersonally Identifiable Information (PII) and operational information must not\nbe revealed through error messages to unauthorized personnel or their\ndesignated representatives.\n\n    The structure and content of error messages must be carefully considered by\nthe organization and development team. The extent to which the information\nsystem is able to identify and handle error conditions is guided by\norganizational policy and operational requirements.""}]",0.5,[],"",SRG-OS-000206-GPOS-00084,V-89721,SV-100371r1_rule,VRAU-SL-000820,F-96463r1_fix,"[""CCI-001314""]","[""SI-11 b"", ""Rev_4""]","","","","","","","","","","","Verify the /var/log directory is group-owned by ""root"" by
running the following command:

# ls -lad /var/log | cut -d' ' -f4

The output must look like the following example:

ls -lad /var/log | cut -d' ' -f4
root

If ""root"" is not returned as a result, this is a finding.","Change the group of the directory /var/log to ""root"" by running
the following command:

# chgrp root /var/log","control ""V-89721"" do
  title ""The /var/log directory must be group-owned by root.""
  desc  ""Only authorized personnel should be aware of errors and the details of
the errors. Error messages are an indicator of an organization's operational
state or can identify the operating system or platform. Additionally,
Personally Identifiable Information (PII) and operational information must not
be revealed through error messages to unauthorized personnel or their
designated representatives.

    The structure and content of error messages must be carefully considered by
the organization and development team. The extent to which the information
system is able to identify and handle error conditions is guided by
organizational policy and operational requirements.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000206-GPOS-00084""
  tag ""gid"": ""V-89721""
  tag ""rid"": ""SV-100371r1_rule""
  tag ""stig_id"": ""VRAU-SL-000820""
  tag ""fix_id"": ""F-96463r1_fix""
  tag ""cci"": [""CCI-001314""]
  tag ""nist"": [""SI-11 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the /var/log directory is group-owned by \""root\"" by
running the following command:

# ls -lad /var/log | cut -d' ' -f4

The output must look like the following example:

ls -lad /var/log | cut -d' ' -f4
root

If \""root\"" is not returned as a result, this is a finding.""
  tag ""fix"": ""Change the group of the directory /var/log to \""root\"" by running
the following command:

# chgrp root /var/log""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89721.rb""}","","","","",""
V-89723,The /var/log directory must be owned by root.,"Only authorized personnel should be aware of errors and the details of
the errors. Error messages are an indicator of an organization's operational
state or can identify the operating system or platform. Additionally,
Personally Identifiable Information (PII) and operational information must not
be revealed through error messages to unauthorized personnel or their
designated representatives.

    The structure and content of error messages must be carefully considered by
the organization and development team. The extent to which the information
system is able to identify and handle error conditions is guided by
organizational policy and operational requirements.","[{""label""=>""default"", ""data""=>""Only authorized personnel should be aware of errors and the details of\nthe errors. Error messages are an indicator of an organization's operational\nstate or can identify the operating system or platform. Additionally,\nPersonally Identifiable Information (PII) and operational information must not\nbe revealed through error messages to unauthorized personnel or their\ndesignated representatives.\n\n    The structure and content of error messages must be carefully considered by\nthe organization and development team. The extent to which the information\nsystem is able to identify and handle error conditions is guided by\norganizational policy and operational requirements.""}]",0.5,[],"",SRG-OS-000206-GPOS-00084,V-89723,SV-100373r1_rule,VRAU-SL-000825,F-96465r1_fix,"[""CCI-001314""]","[""SI-11 b"", ""Rev_4""]","","","","","","","","","","","Verify that the /var/log directory is owned by ""root"" by
running the following command:

# ls -lad /var/log | cut -d' ' -f3

The output must look like the following example:

ls -lad /var/log | cut -d' ' -f3
root

If ""root"" is not returned as a result, this is a finding.","Change the owner of the directory /var/log to ""root"" by running
the following command:

# chown root /var/log","control ""V-89723"" do
  title ""The /var/log directory must be owned by root.""
  desc  ""Only authorized personnel should be aware of errors and the details of
the errors. Error messages are an indicator of an organization's operational
state or can identify the operating system or platform. Additionally,
Personally Identifiable Information (PII) and operational information must not
be revealed through error messages to unauthorized personnel or their
designated representatives.

    The structure and content of error messages must be carefully considered by
the organization and development team. The extent to which the information
system is able to identify and handle error conditions is guided by
organizational policy and operational requirements.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000206-GPOS-00084""
  tag ""gid"": ""V-89723""
  tag ""rid"": ""SV-100373r1_rule""
  tag ""stig_id"": ""VRAU-SL-000825""
  tag ""fix_id"": ""F-96465r1_fix""
  tag ""cci"": [""CCI-001314""]
  tag ""nist"": [""SI-11 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that the /var/log directory is owned by \""root\"" by
running the following command:

# ls -lad /var/log | cut -d' ' -f3

The output must look like the following example:

ls -lad /var/log | cut -d' ' -f3
root

If \""root\"" is not returned as a result, this is a finding.""
  tag ""fix"": ""Change the owner of the directory /var/log to \""root\"" by running
the following command:

# chown root /var/log""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89723.rb""}","","","","",""
V-89725,The /var/log directory must have mode 0750 or less permissive.,"Only authorized personnel should be aware of errors and the details of
the errors. Error messages are an indicator of an organization's operational
state or can identify the operating system or platform. Additionally,
Personally Identifiable Information (PII) and operational information must not
be revealed through error messages to unauthorized personnel or their
designated representatives.

    The structure and content of error messages must be carefully considered by
the organization and development team. The extent to which the information
system is able to identify and handle error conditions is guided by
organizational policy and operational requirements.","[{""label""=>""default"", ""data""=>""Only authorized personnel should be aware of errors and the details of\nthe errors. Error messages are an indicator of an organization's operational\nstate or can identify the operating system or platform. Additionally,\nPersonally Identifiable Information (PII) and operational information must not\nbe revealed through error messages to unauthorized personnel or their\ndesignated representatives.\n\n    The structure and content of error messages must be carefully considered by\nthe organization and development team. The extent to which the information\nsystem is able to identify and handle error conditions is guided by\norganizational policy and operational requirements.""}]",0.5,[],"",SRG-OS-000206-GPOS-00084,V-89725,SV-100375r1_rule,VRAU-SL-000830,F-96467r1_fix,"[""CCI-001314""]","[""SI-11 b"", ""Rev_4""]","","","","","","","","","","","Verify that the /var/log directory has mode 0750 or less by
running the following command:

# ls -lad /var/log | cut -d' ' -f1

The output must look like the following example:

ls -lad /var/log | cut -d' ' -f1
drwxr-x---

If ""drwxr-x---"" is not returned as a result, this is a finding.","Change the permissions of the directory /var/log to ""0750"" by
running the following command:

# chmod 0750 /var/log","control ""V-89725"" do
  title ""The /var/log directory must have mode 0750 or less permissive.""
  desc  ""Only authorized personnel should be aware of errors and the details of
the errors. Error messages are an indicator of an organization's operational
state or can identify the operating system or platform. Additionally,
Personally Identifiable Information (PII) and operational information must not
be revealed through error messages to unauthorized personnel or their
designated representatives.

    The structure and content of error messages must be carefully considered by
the organization and development team. The extent to which the information
system is able to identify and handle error conditions is guided by
organizational policy and operational requirements.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000206-GPOS-00084""
  tag ""gid"": ""V-89725""
  tag ""rid"": ""SV-100375r1_rule""
  tag ""stig_id"": ""VRAU-SL-000830""
  tag ""fix_id"": ""F-96467r1_fix""
  tag ""cci"": [""CCI-001314""]
  tag ""nist"": [""SI-11 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that the /var/log directory has mode 0750 or less by
running the following command:

# ls -lad /var/log | cut -d' ' -f1

The output must look like the following example:

ls -lad /var/log | cut -d' ' -f1
drwxr-x---

If \""drwxr-x---\"" is not returned as a result, this is a finding.""
  tag ""fix"": ""Change the permissions of the directory /var/log to \""0750\"" by
running the following command:

# chmod 0750 /var/log""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89725.rb""}","","","","",""
V-89727,The /var/log/messages file must be group-owned by root.,"Only authorized personnel should be aware of errors and the details of
the errors. Error messages are an indicator of an organization's operational
state or can identify the operating system or platform. Additionally,
Personally Identifiable Information (PII) and operational information must not
be revealed through error messages to unauthorized personnel or their
designated representatives.

    The structure and content of error messages must be carefully considered by
the organization and development team. The extent to which the information
system is able to identify and handle error conditions is guided by
organizational policy and operational requirements.","[{""label""=>""default"", ""data""=>""Only authorized personnel should be aware of errors and the details of\nthe errors. Error messages are an indicator of an organization's operational\nstate or can identify the operating system or platform. Additionally,\nPersonally Identifiable Information (PII) and operational information must not\nbe revealed through error messages to unauthorized personnel or their\ndesignated representatives.\n\n    The structure and content of error messages must be carefully considered by\nthe organization and development team. The extent to which the information\nsystem is able to identify and handle error conditions is guided by\norganizational policy and operational requirements.""}]",0.5,[],"",SRG-OS-000206-GPOS-00084,V-89727,SV-100377r1_rule,VRAU-SL-000835,F-96469r1_fix,"[""CCI-001314""]","[""SI-11 b"", ""Rev_4""]","","","","","","","","","","","Verify that the /var/log/messages file is group-owned by
""root"" by running the following command:

# ls -la /var/log/messages | cut -d' ' -f4

The output must look like the following example:

ls -la /var/log/messages | cut -d' ' -f4
root

If ""root"" is not returned as a result, this is a finding.","Change the group of the file /var/log/messages to ""root"" by
running the following command:

# chgrp root /var/log/messages","control ""V-89727"" do
  title ""The /var/log/messages file must be group-owned by root.""
  desc  ""Only authorized personnel should be aware of errors and the details of
the errors. Error messages are an indicator of an organization's operational
state or can identify the operating system or platform. Additionally,
Personally Identifiable Information (PII) and operational information must not
be revealed through error messages to unauthorized personnel or their
designated representatives.

    The structure and content of error messages must be carefully considered by
the organization and development team. The extent to which the information
system is able to identify and handle error conditions is guided by
organizational policy and operational requirements.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000206-GPOS-00084""
  tag ""gid"": ""V-89727""
  tag ""rid"": ""SV-100377r1_rule""
  tag ""stig_id"": ""VRAU-SL-000835""
  tag ""fix_id"": ""F-96469r1_fix""
  tag ""cci"": [""CCI-001314""]
  tag ""nist"": [""SI-11 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that the /var/log/messages file is group-owned by
\""root\"" by running the following command:

# ls -la /var/log/messages | cut -d' ' -f4

The output must look like the following example:

ls -la /var/log/messages | cut -d' ' -f4
root

If \""root\"" is not returned as a result, this is a finding.""
  tag ""fix"": ""Change the group of the file /var/log/messages to \""root\"" by
running the following command:

# chgrp root /var/log/messages""

describe file('/var/log/messages') do
  its('group') { should cmp 'root'}
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89727.rb""}",passed,"File /var/log/messages group should cmp == ""root""",0.1430922,2019-08-01T08:47:33-07:00,""
V-89729,The /var/log/messages file must be owned by root.,"Only authorized personnel should be aware of errors and the details of
the errors. Error messages are an indicator of an organization's operational
state or can identify the operating system or platform. Additionally,
Personally Identifiable Information (PII) and operational information must not
be revealed through error messages to unauthorized personnel or their
designated representatives.

    The structure and content of error messages must be carefully considered by
the organization and development team. The extent to which the information
system is able to identify and handle error conditions is guided by
organizational policy and operational requirements.","[{""label""=>""default"", ""data""=>""Only authorized personnel should be aware of errors and the details of\nthe errors. Error messages are an indicator of an organization's operational\nstate or can identify the operating system or platform. Additionally,\nPersonally Identifiable Information (PII) and operational information must not\nbe revealed through error messages to unauthorized personnel or their\ndesignated representatives.\n\n    The structure and content of error messages must be carefully considered by\nthe organization and development team. The extent to which the information\nsystem is able to identify and handle error conditions is guided by\norganizational policy and operational requirements.""}]",0.5,[],"",SRG-OS-000206-GPOS-00084,V-89729,SV-100379r1_rule,VRAU-SL-000840,F-96471r1_fix,"[""CCI-001314""]","[""SI-11 b"", ""Rev_4""]","","","","","","","","","","","Verify that the /var/log/messages file is owned by ""root"" by
running the following command:

# ls -la /var/log/messages | cut -d' ' -f3

The output must look like the following example:

ls -la /var/log/messages | cut -d' ' -f3
root

If ""root"" is not returned as a result, this is a finding.","Change the owner of the file /var/log/messages to ""root"" by
running the following command:

# chown root /var/log/messages","control ""V-89729"" do
  title ""The /var/log/messages file must be owned by root.""
  desc  ""Only authorized personnel should be aware of errors and the details of
the errors. Error messages are an indicator of an organization's operational
state or can identify the operating system or platform. Additionally,
Personally Identifiable Information (PII) and operational information must not
be revealed through error messages to unauthorized personnel or their
designated representatives.

    The structure and content of error messages must be carefully considered by
the organization and development team. The extent to which the information
system is able to identify and handle error conditions is guided by
organizational policy and operational requirements.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000206-GPOS-00084""
  tag ""gid"": ""V-89729""
  tag ""rid"": ""SV-100379r1_rule""
  tag ""stig_id"": ""VRAU-SL-000840""
  tag ""fix_id"": ""F-96471r1_fix""
  tag ""cci"": [""CCI-001314""]
  tag ""nist"": [""SI-11 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that the /var/log/messages file is owned by \""root\"" by
running the following command:

# ls -la /var/log/messages | cut -d' ' -f3

The output must look like the following example:

ls -la /var/log/messages | cut -d' ' -f3
root

If \""root\"" is not returned as a result, this is a finding.""
  tag ""fix"": ""Change the owner of the file /var/log/messages to \""root\"" by
running the following command:

# chown root /var/log/messages""

describe file('/var/log/messages') do
  its('owner') { should cmp 'root'}
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89729.rb""}",passed,"File /var/log/messages owner should cmp == ""root""",0.0002923,2019-08-01T08:47:33-07:00,""
V-89731,The /var/log/messages file must have mode 0640 or less permissive.,"Only authorized personnel should be aware of errors and the details of
the errors. Error messages are an indicator of an organization's operational
state or can identify the operating system or platform. Additionally,
Personally Identifiable Information (PII) and operational information must not
be revealed through error messages to unauthorized personnel or their
designated representatives.

    The structure and content of error messages must be carefully considered by
the organization and development team. The extent to which the information
system is able to identify and handle error conditions is guided by
organizational policy and operational requirements.","[{""label""=>""default"", ""data""=>""Only authorized personnel should be aware of errors and the details of\nthe errors. Error messages are an indicator of an organization's operational\nstate or can identify the operating system or platform. Additionally,\nPersonally Identifiable Information (PII) and operational information must not\nbe revealed through error messages to unauthorized personnel or their\ndesignated representatives.\n\n    The structure and content of error messages must be carefully considered by\nthe organization and development team. The extent to which the information\nsystem is able to identify and handle error conditions is guided by\norganizational policy and operational requirements.""}]",0.5,[],"",SRG-OS-000206-GPOS-00084,V-89731,SV-100381r1_rule,VRAU-SL-000845,F-96473r1_fix,"[""CCI-001314""]","[""SI-11 b"", ""Rev_4""]","","","","","","","","","","","Verify that the /var/log/messages file has mode 0640 or less by
running the following command:

# ls -lad /var/log/messages | cut -d' ' -f1

The output must look like the following example:

ls -lad /var/log/messages | cut -d' ' -f1
-rw-r-----

If ""-rw-r-----"" is not returned as a result, this is a finding.","Change the permissions of the file /var/log/messages to ""0640""
by running the following command:

# chmod 0640 /var/log/messages","control ""V-89731"" do
  title ""The /var/log/messages file must have mode 0640 or less permissive.""
  desc  ""Only authorized personnel should be aware of errors and the details of
the errors. Error messages are an indicator of an organization's operational
state or can identify the operating system or platform. Additionally,
Personally Identifiable Information (PII) and operational information must not
be revealed through error messages to unauthorized personnel or their
designated representatives.

    The structure and content of error messages must be carefully considered by
the organization and development team. The extent to which the information
system is able to identify and handle error conditions is guided by
organizational policy and operational requirements.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000206-GPOS-00084""
  tag ""gid"": ""V-89731""
  tag ""rid"": ""SV-100381r1_rule""
  tag ""stig_id"": ""VRAU-SL-000845""
  tag ""fix_id"": ""F-96473r1_fix""
  tag ""cci"": [""CCI-001314""]
  tag ""nist"": [""SI-11 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that the /var/log/messages file has mode 0640 or less by
running the following command:

# ls -lad /var/log/messages | cut -d' ' -f1

The output must look like the following example:

ls -lad /var/log/messages | cut -d' ' -f1
-rw-r-----

If \""-rw-r-----\"" is not returned as a result, this is a finding.""
  tag ""fix"": ""Change the permissions of the file /var/log/messages to \""0640\""
by running the following command:

# chmod 0640 /var/log/messages""

describe file('/var/log/messages') do
  it { should_not be_more_permissive_than('0640') }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89731.rb""}",passed,"File /var/log/messages should not be more permissive than ""0640""",0.1451142,2019-08-01T08:47:33-07:00,""
V-89733,"The SLES for vRealize must reveal error messages only to authorized
users.","Only authorized personnel should be aware of errors and the details of
the errors. Error messages are an indicator of an organization's operational
state or can identify the operating system or platform. Additionally,
Personally Identifiable Information (PII) and operational information must not
be revealed through error messages to unauthorized personnel or their
designated representatives.

    The structure and content of error messages must be carefully considered by
the organization and development team. The extent to which the information
system is able to identify and handle error conditions is guided by
organizational policy and operational requirements.","[{""label""=>""default"", ""data""=>""Only authorized personnel should be aware of errors and the details of\nthe errors. Error messages are an indicator of an organization's operational\nstate or can identify the operating system or platform. Additionally,\nPersonally Identifiable Information (PII) and operational information must not\nbe revealed through error messages to unauthorized personnel or their\ndesignated representatives.\n\n    The structure and content of error messages must be carefully considered by\nthe organization and development team. The extent to which the information\nsystem is able to identify and handle error conditions is guided by\norganizational policy and operational requirements.""}]",0.5,[],"",SRG-OS-000206-GPOS-00084,V-89733,SV-100383r1_rule,VRAU-SL-000850,F-96475r1_fix,"[""CCI-001314""]","[""SI-11 b"", ""Rev_4""]","","","","","","","","","","","Check the permissions of the syslog configuration file(s):

# ls -lL /etc/syslog-ng/syslog-ng.conf

If the mode of the file is more permissive than ""0640"", this is a finding.","Change the permissions of the syslog configuration file(s):

# chmod 640 /etc/syslog-ng/syslog-ng.conf","control ""V-89733"" do
  title ""The SLES for vRealize must reveal error messages only to authorized
users.""
  desc  ""Only authorized personnel should be aware of errors and the details of
the errors. Error messages are an indicator of an organization's operational
state or can identify the operating system or platform. Additionally,
Personally Identifiable Information (PII) and operational information must not
be revealed through error messages to unauthorized personnel or their
designated representatives.

    The structure and content of error messages must be carefully considered by
the organization and development team. The extent to which the information
system is able to identify and handle error conditions is guided by
organizational policy and operational requirements.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000206-GPOS-00084""
  tag ""gid"": ""V-89733""
  tag ""rid"": ""SV-100383r1_rule""
  tag ""stig_id"": ""VRAU-SL-000850""
  tag ""fix_id"": ""F-96475r1_fix""
  tag ""cci"": [""CCI-001314""]
  tag ""nist"": [""SI-11 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the permissions of the syslog configuration file(s):

# ls -lL /etc/syslog-ng/syslog-ng.conf

If the mode of the file is more permissive than \""0640\"", this is a finding.""
  tag ""fix"": ""Change the permissions of the syslog configuration file(s):

# chmod 640 /etc/syslog-ng/syslog-ng.conf""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89733.rb""}","","","","",""
V-89735,"The SLES for vRealize must reveal error messages only to authorized
users.","Only authorized personnel should be aware of errors and the details of
the errors. Error messages are an indicator of an organization's operational
state or can identify the operating system or platform. Additionally,
Personally Identifiable Information (PII) and operational information must not
be revealed through error messages to unauthorized personnel or their
designated representatives.

    The structure and content of error messages must be carefully considered by
the organization and development team. The extent to which the information
system is able to identify and handle error conditions is guided by
organizational policy and operational requirements.","[{""label""=>""default"", ""data""=>""Only authorized personnel should be aware of errors and the details of\nthe errors. Error messages are an indicator of an organization's operational\nstate or can identify the operating system or platform. Additionally,\nPersonally Identifiable Information (PII) and operational information must not\nbe revealed through error messages to unauthorized personnel or their\ndesignated representatives.\n\n    The structure and content of error messages must be carefully considered by\nthe organization and development team. The extent to which the information\nsystem is able to identify and handle error conditions is guided by\norganizational policy and operational requirements.""}]",0.5,[],"",SRG-OS-000206-GPOS-00084,V-89735,SV-100385r1_rule,VRAU-SL-000855,F-96477r1_fix,"[""CCI-001314""]","[""SI-11 b"", ""Rev_4""]","","","","","","","","","","","Check the permissions of the syslog configuration file(s):

# ls -lL /etc/syslog-ng/syslog-ng.conf

If the file is not owned by ""root"", this is a finding.","Use the chown command to set the owner to ""root"":

# chown root /etc/syslog-ng/syslog-ng.conf","control ""V-89735"" do
  title ""The SLES for vRealize must reveal error messages only to authorized
users.""
  desc  ""Only authorized personnel should be aware of errors and the details of
the errors. Error messages are an indicator of an organization's operational
state or can identify the operating system or platform. Additionally,
Personally Identifiable Information (PII) and operational information must not
be revealed through error messages to unauthorized personnel or their
designated representatives.

    The structure and content of error messages must be carefully considered by
the organization and development team. The extent to which the information
system is able to identify and handle error conditions is guided by
organizational policy and operational requirements.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000206-GPOS-00084""
  tag ""gid"": ""V-89735""
  tag ""rid"": ""SV-100385r1_rule""
  tag ""stig_id"": ""VRAU-SL-000855""
  tag ""fix_id"": ""F-96477r1_fix""
  tag ""cci"": [""CCI-001314""]
  tag ""nist"": [""SI-11 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the permissions of the syslog configuration file(s):

# ls -lL /etc/syslog-ng/syslog-ng.conf

If the file is not owned by \""root\"", this is a finding.""
  tag ""fix"": ""Use the chown command to set the owner to \""root\"":

# chown root /etc/syslog-ng/syslog-ng.conf""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89735.rb""}","","","","",""
V-89737,"The SLES for vRealize must reveal error messages only to authorized
users.","Only authorized personnel should be aware of errors and the details of
the errors. Error messages are an indicator of an organization's operational
state or can identify the operating system or platform. Additionally,
Personally Identifiable Information (PII) and operational information must not
be revealed through error messages to unauthorized personnel or their
designated representatives.

    The structure and content of error messages must be carefully considered by
the organization and development team. The extent to which the information
system is able to identify and handle error conditions is guided by
organizational policy and operational requirements.","[{""label""=>""default"", ""data""=>""Only authorized personnel should be aware of errors and the details of\nthe errors. Error messages are an indicator of an organization's operational\nstate or can identify the operating system or platform. Additionally,\nPersonally Identifiable Information (PII) and operational information must not\nbe revealed through error messages to unauthorized personnel or their\ndesignated representatives.\n\n    The structure and content of error messages must be carefully considered by\nthe organization and development team. The extent to which the information\nsystem is able to identify and handle error conditions is guided by\norganizational policy and operational requirements.""}]",0.5,[],"",SRG-OS-000206-GPOS-00084,V-89737,SV-100387r1_rule,VRAU-SL-000860,F-96479r1_fix,"[""CCI-001314""]","[""SI-11 b"", ""Rev_4""]","","","","","","","","","","","Check the permissions of the syslog configuration file(s):

# ls -lL /etc/syslog-ng/syslog-ng.conf

If the file is not group-owned by ""root"", this is a finding.","Change the group-owner of the /etc/rsyslog.conf file to ""root"":

# chgrp root /etc/syslog-ng/syslog-ng.conf","control ""V-89737"" do
  title ""The SLES for vRealize must reveal error messages only to authorized
users.""
  desc  ""Only authorized personnel should be aware of errors and the details of
the errors. Error messages are an indicator of an organization's operational
state or can identify the operating system or platform. Additionally,
Personally Identifiable Information (PII) and operational information must not
be revealed through error messages to unauthorized personnel or their
designated representatives.

    The structure and content of error messages must be carefully considered by
the organization and development team. The extent to which the information
system is able to identify and handle error conditions is guided by
organizational policy and operational requirements.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000206-GPOS-00084""
  tag ""gid"": ""V-89737""
  tag ""rid"": ""SV-100387r1_rule""
  tag ""stig_id"": ""VRAU-SL-000860""
  tag ""fix_id"": ""F-96479r1_fix""
  tag ""cci"": [""CCI-001314""]
  tag ""nist"": [""SI-11 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the permissions of the syslog configuration file(s):

# ls -lL /etc/syslog-ng/syslog-ng.conf

If the file is not group-owned by \""root\"", this is a finding.""
  tag ""fix"": ""Change the group-owner of the /etc/rsyslog.conf file to \""root\"":

# chgrp root /etc/syslog-ng/syslog-ng.conf""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89737.rb""}","","","","",""
V-89739,"Any publically accessible connection to the SLES for vRealize must
display the Standard Mandatory DoD Notice and Consent Banner before granting
access to the system.","Display of a standardized and approved use notification before
granting access to the publicly accessible operating system ensures privacy and
security notification verbiage used is consistent with applicable federal laws,
Executive Orders, directives, policies, regulations, standards, and guidance.

    System use notifications are required only for access via logon interfaces
with human users and are not required when such human interfaces do not exist.

    The banner must be formatted in accordance with applicable DoD policy. Use
the following verbiage for operating systems that can accommodate banners of
1300 characters:

    ""You are accessing a U.S. Government (USG) Information System (IS) that is
provided for USG-authorized use only.

    By using this IS (which includes any device attached to this IS), you
consent to the following conditions:

    -The USG routinely intercepts and monitors communications on this IS for
purposes including, but not limited to, penetration testing, COMSEC monitoring,
network operations and defense, personnel misconduct (PM), law enforcement
(LE), and counterintelligence (CI) investigations.

    -At any time, the USG may inspect and seize data stored on this IS.

    -Communications using, or data stored on, this IS are not private, are
subject to routine monitoring, interception, and search, and may be disclosed
or used for any USG-authorized purpose.

    -This IS includes security measures (e.g., authentication and access
controls) to protect USG interests--not for your personal benefit or privacy.

    -Notwithstanding the above, using this IS does not constitute consent to
PM, LE or CI investigative searching or monitoring of the content of privileged
communications, or work product, related to personal representation or services
by attorneys, psychotherapists, or clergy, and their assistants. Such
communications and work product are private and confidential. See User
Agreement for details.""

    Use the following verbiage for operating systems that have severe
limitations on the number of characters that can be displayed in the banner:

    ""I've read and consent to terms in IS user agreem't.""","[{""label""=>""default"", ""data""=>""Display of a standardized and approved use notification before\ngranting access to the publicly accessible operating system ensures privacy and\nsecurity notification verbiage used is consistent with applicable federal laws,\nExecutive Orders, directives, policies, regulations, standards, and guidance.\n\n    System use notifications are required only for access via logon interfaces\nwith human users and are not required when such human interfaces do not exist.\n\n    The banner must be formatted in accordance with applicable DoD policy. Use\nthe following verbiage for operating systems that can accommodate banners of\n1300 characters:\n\n    \""You are accessing a U.S. Government (USG) Information System (IS) that is\nprovided for USG-authorized use only.\n\n    By using this IS (which includes any device attached to this IS), you\nconsent to the following conditions:\n\n    -The USG routinely intercepts and monitors communications on this IS for\npurposes including, but not limited to, penetration testing, COMSEC monitoring,\nnetwork operations and defense, personnel misconduct (PM), law enforcement\n(LE), and counterintelligence (CI) investigations.\n\n    -At any time, the USG may inspect and seize data stored on this IS.\n\n    -Communications using, or data stored on, this IS are not private, are\nsubject to routine monitoring, interception, and search, and may be disclosed\nor used for any USG-authorized purpose.\n\n    -This IS includes security measures (e.g., authentication and access\ncontrols) to protect USG interests--not for your personal benefit or privacy.\n\n    -Notwithstanding the above, using this IS does not constitute consent to\nPM, LE or CI investigative searching or monitoring of the content of privileged\ncommunications, or work product, related to personal representation or services\nby attorneys, psychotherapists, or clergy, and their assistants. Such\ncommunications and work product are private and confidential. See User\nAgreement for details.\""\n\n    Use the following verbiage for operating systems that have severe\nlimitations on the number of characters that can be displayed in the banner:\n\n    \""I've read and consent to terms in IS user agreem't.\""""}]",0.5,[],"",SRG-OS-000228-GPOS-00088,V-89739,SV-100389r1_rule,VRAU-SL-000865,F-96481r1_fix,"[""CCI-001384"", ""CCI-001385"", ""CCI-001386"", ""CCI-001387"", ""CCI-001388""]","[""AC-8 c 1"", ""AC-8 c 2"", ""AC-8 c 2"", ""AC-8 c 2"", ""AC-8 c 3"", ""Rev_4""]","","","","","","","","","","","Check the issue file to verify that it contains one of the DoD
required banners:

# cat /etc/issue

""You are accessing a U.S. Government (USG) Information System (IS) that is
provided for USG-authorized use only.

By using this IS (which includes any device attached to this IS), you consent
to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for
purposes including, but not limited to, penetration testing, COMSEC monitoring,
network operations and defense, personnel misconduct (PM), law enforcement
(LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject
to routine monitoring, interception, and search, and may be disclosed or used
for any USG-authorized purpose.

-This IS includes security measures (e.g., authentication and access controls)
to protect USG interests--not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE
or CI investigative searching or monitoring of the content of privileged
communications, or work product, related to personal representation or services
by attorneys, psychotherapists, or clergy, and their assistants. Such
communications and work product are private and confidential. See User
Agreement for details.""

Use the following verbiage for SLES for vRealize that have severe limitations
on the number of characters that can be displayed in the banner:

""I've read & consent to terms in IS user agreem't.""

If it does not, this is a finding.","To configure the system to display the Standard Mandatory DoD
Notice and Consent Banner, run the dodscript with the following command as root:

# /etc/dodscript.sh","control ""V-89739"" do
  title ""Any publically accessible connection to the SLES for vRealize must
display the Standard Mandatory DoD Notice and Consent Banner before granting
access to the system.""
  desc  ""Display of a standardized and approved use notification before
granting access to the publicly accessible operating system ensures privacy and
security notification verbiage used is consistent with applicable federal laws,
Executive Orders, directives, policies, regulations, standards, and guidance.

    System use notifications are required only for access via logon interfaces
with human users and are not required when such human interfaces do not exist.

    The banner must be formatted in accordance with applicable DoD policy. Use
the following verbiage for operating systems that can accommodate banners of
1300 characters:

    \""You are accessing a U.S. Government (USG) Information System (IS) that is
provided for USG-authorized use only.

    By using this IS (which includes any device attached to this IS), you
consent to the following conditions:

    -The USG routinely intercepts and monitors communications on this IS for
purposes including, but not limited to, penetration testing, COMSEC monitoring,
network operations and defense, personnel misconduct (PM), law enforcement
(LE), and counterintelligence (CI) investigations.

    -At any time, the USG may inspect and seize data stored on this IS.

    -Communications using, or data stored on, this IS are not private, are
subject to routine monitoring, interception, and search, and may be disclosed
or used for any USG-authorized purpose.

    -This IS includes security measures (e.g., authentication and access
controls) to protect USG interests--not for your personal benefit or privacy.

    -Notwithstanding the above, using this IS does not constitute consent to
PM, LE or CI investigative searching or monitoring of the content of privileged
communications, or work product, related to personal representation or services
by attorneys, psychotherapists, or clergy, and their assistants. Such
communications and work product are private and confidential. See User
Agreement for details.\""

    Use the following verbiage for operating systems that have severe
limitations on the number of characters that can be displayed in the banner:

    \""I've read and consent to terms in IS user agreem't.\""
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000228-GPOS-00088""
  tag ""gid"": ""V-89739""
  tag ""rid"": ""SV-100389r1_rule""
  tag ""stig_id"": ""VRAU-SL-000865""
  tag ""fix_id"": ""F-96481r1_fix""
  tag ""cci"": [""CCI-001384"", ""CCI-001385"", ""CCI-001386"", ""CCI-001387"",
""CCI-001388""]
  tag ""nist"": [""AC-8 c 1"", ""AC-8 c 2"", ""AC-8 c 2"", ""AC-8 c 2"", ""AC-8 c 3"",
""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the issue file to verify that it contains one of the DoD
required banners:

# cat /etc/issue

\""You are accessing a U.S. Government (USG) Information System (IS) that is
provided for USG-authorized use only.

By using this IS (which includes any device attached to this IS), you consent
to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for
purposes including, but not limited to, penetration testing, COMSEC monitoring,
network operations and defense, personnel misconduct (PM), law enforcement
(LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject
to routine monitoring, interception, and search, and may be disclosed or used
for any USG-authorized purpose.

-This IS includes security measures (e.g., authentication and access controls)
to protect USG interests--not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE
or CI investigative searching or monitoring of the content of privileged
communications, or work product, related to personal representation or services
by attorneys, psychotherapists, or clergy, and their assistants. Such
communications and work product are private and confidential. See User
Agreement for details.\""

Use the following verbiage for SLES for vRealize that have severe limitations
on the number of characters that can be displayed in the banner:

\""I've read & consent to terms in IS user agreem't.\""

If it does not, this is a finding.""
  tag ""fix"": ""To configure the system to display the Standard Mandatory DoD
Notice and Consent Banner, run the dodscript with the following command as root:

# /etc/dodscript.sh""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89739.rb""}","","","","",""
V-89741,The SLES for vRealize must audit all account modifications.,"Once an attacker establishes initial access to a system, the attacker
often attempts to create a persistent method of reestablishing access. One way
to accomplish this is for the attacker to simply modify an existing account.
Auditing of account modification is one method for mitigating this risk.

    To address access requirements, many operating systems can be integrated
with enterprise-level authentication/access/auditing mechanisms that meet or
exceed access control policy requirements.","[{""label""=>""default"", ""data""=>""Once an attacker establishes initial access to a system, the attacker\noften attempts to create a persistent method of reestablishing access. One way\nto accomplish this is for the attacker to simply modify an existing account.\nAuditing of account modification is one method for mitigating this risk.\n\n    To address access requirements, many operating systems can be integrated\nwith enterprise-level authentication/access/auditing mechanisms that meet or\nexceed access control policy requirements.""}]",0.5,[],"",SRG-OS-000239-GPOS-00089,V-89741,SV-100391r1_rule,VRAU-SL-000870,F-96483r1_fix,"[""CCI-001403""]","[""AC-2 (4)"", ""Rev_4""]","","","","","","","","","","","Determine if execution of the usermod and groupmod executable
are audited.

# auditctl -l | egrep '(usermod|groupmod)' | grep perm=x

If either usermod or groupmod are not listed with a permissions filter of at
least 'x', this is a finding.","Configure execute auditing of the usermod and groupmod
executables run the dodscript with the following command as root:

# /etc/dodscript.sh

OR....

Configure execute auditing of the usermod and groupmod executables. Add the
following to the audit.rules file:
-w /usr/sbin/usermod -p x -k usermod
-w /usr/sbin/groupmod -p x -k groupmod

Restart the auditd service.
# service auditd restart","control ""V-89741"" do
  title ""The SLES for vRealize must audit all account modifications.""
  desc  ""Once an attacker establishes initial access to a system, the attacker
often attempts to create a persistent method of reestablishing access. One way
to accomplish this is for the attacker to simply modify an existing account.
Auditing of account modification is one method for mitigating this risk.

    To address access requirements, many operating systems can be integrated
with enterprise-level authentication/access/auditing mechanisms that meet or
exceed access control policy requirements.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000239-GPOS-00089""
  tag ""gid"": ""V-89741""
  tag ""rid"": ""SV-100391r1_rule""
  tag ""stig_id"": ""VRAU-SL-000870""
  tag ""fix_id"": ""F-96483r1_fix""
  tag ""cci"": [""CCI-001403""]
  tag ""nist"": [""AC-2 (4)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Determine if execution of the usermod and groupmod executable
are audited.

# auditctl -l | egrep '(usermod|groupmod)' | grep perm=x

If either usermod or groupmod are not listed with a permissions filter of at
least 'x', this is a finding.""
  tag ""fix"": ""Configure execute auditing of the usermod and groupmod
executables run the dodscript with the following command as root:

# /etc/dodscript.sh

OR....

Configure execute auditing of the usermod and groupmod executables. Add the
following to the audit.rules file:
-w /usr/sbin/usermod -p x -k usermod
-w /usr/sbin/groupmod -p x -k groupmod

Restart the auditd service.
# service auditd restart""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89741.rb""}","","","","",""
V-89743,The SLES for vRealize must audit all account modifications.,"Once an attacker establishes initial access to a system, the attacker
often attempts to create a persistent method of reestablishing access. One way
to accomplish this is for the attacker to simply modify an existing account.
Auditing of account modification is one method for mitigating this risk.

    To address access requirements, many operating systems can be integrated
with enterprise-level authentication/access/auditing mechanisms that meet or
exceed access control policy requirements.","[{""label""=>""default"", ""data""=>""Once an attacker establishes initial access to a system, the attacker\noften attempts to create a persistent method of reestablishing access. One way\nto accomplish this is for the attacker to simply modify an existing account.\nAuditing of account modification is one method for mitigating this risk.\n\n    To address access requirements, many operating systems can be integrated\nwith enterprise-level authentication/access/auditing mechanisms that meet or\nexceed access control policy requirements.""}]",0.5,[],"",SRG-OS-000239-GPOS-00089,V-89743,SV-100393r1_rule,VRAU-SL-000875,F-96485r1_fix,"[""CCI-001403""]","[""AC-2 (4)"", ""Rev_4""]","","","","","","","","","","","Determine if /etc/passwd, /etc/shadow, /etc/group, and
/etc/gshadow are audited for writing.

# auditctl -l | egrep '(/etc/passwd|/etc/shadow|/etc/group|/etc/gshadow)' |
grep perm=w

If any of these are not listed with a permissions filter of at least ""w"",
this is a finding.","Configure append auditing of the ""passwd"", ""shadow"",
""group"", and ""gshadow"" files run ""dodscript"" with the following command
as ""root"":

# /etc/dodscript.sh

OR

Configure auditing of the ""passwd"", ""shadow"", ""group"", and ""gshadow""
files. Add the following to the audit.rules file:
-w /etc/passwd -p w -k passwd
-w /etc/shadow -p w -k shadow
-w /etc/group -p w -k group
-w /etc/gshadow -p w -k gshadow

Restart the auditd service:

# service auditd restart","control ""V-89743"" do
  title ""The SLES for vRealize must audit all account modifications.""
  desc  ""Once an attacker establishes initial access to a system, the attacker
often attempts to create a persistent method of reestablishing access. One way
to accomplish this is for the attacker to simply modify an existing account.
Auditing of account modification is one method for mitigating this risk.

    To address access requirements, many operating systems can be integrated
with enterprise-level authentication/access/auditing mechanisms that meet or
exceed access control policy requirements.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000239-GPOS-00089""
  tag ""gid"": ""V-89743""
  tag ""rid"": ""SV-100393r1_rule""
  tag ""stig_id"": ""VRAU-SL-000875""
  tag ""fix_id"": ""F-96485r1_fix""
  tag ""cci"": [""CCI-001403""]
  tag ""nist"": [""AC-2 (4)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Determine if /etc/passwd, /etc/shadow, /etc/group, and
/etc/gshadow are audited for writing.

# auditctl -l | egrep '(/etc/passwd|/etc/shadow|/etc/group|/etc/gshadow)' |
grep perm=w

If any of these are not listed with a permissions filter of at least \""w\"",
this is a finding.""
  tag ""fix"": ""Configure append auditing of the \""passwd\"", \""shadow\"",
\""group\"", and \""gshadow\"" files run \""dodscript\"" with the following command
as \""root\"":

# /etc/dodscript.sh

OR

Configure auditing of the \""passwd\"", \""shadow\"", \""group\"", and \""gshadow\""
files. Add the following to the audit.rules file:
-w /etc/passwd -p w -k passwd
-w /etc/shadow -p w -k shadow
-w /etc/group -p w -k group
-w /etc/gshadow -p w -k gshadow

Restart the auditd service:

# service auditd restart""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89743.rb""}","","","","",""
V-89745,The SLES for vRealize must audit all account disabling actions.,"When operating system accounts are disabled, user accessibility is
affected. Accounts are utilized for identifying individual users or for
identifying the operating system processes themselves. In order to detect and
respond to events affecting user accessibility and system processing, operating
systems must audit account disabling actions and, as required, notify the
appropriate individuals so they can investigate the event. Such a capability
greatly reduces the risk that operating system accessibility will be negatively
affected for extended periods of time and provides logging that can be used for
forensic purposes.

    To address access requirements, many operating systems can be integrated
with enterprise-level authentication/access/auditing mechanisms that meet or
exceed access control policy requirements.","[{""label""=>""default"", ""data""=>""When operating system accounts are disabled, user accessibility is\naffected. Accounts are utilized for identifying individual users or for\nidentifying the operating system processes themselves. In order to detect and\nrespond to events affecting user accessibility and system processing, operating\nsystems must audit account disabling actions and, as required, notify the\nappropriate individuals so they can investigate the event. Such a capability\ngreatly reduces the risk that operating system accessibility will be negatively\naffected for extended periods of time and provides logging that can be used for\nforensic purposes.\n\n    To address access requirements, many operating systems can be integrated\nwith enterprise-level authentication/access/auditing mechanisms that meet or\nexceed access control policy requirements.""}]",0.5,[],"",SRG-OS-000240-GPOS-00090,V-89745,SV-100395r1_rule,VRAU-SL-000880,F-96487r2_fix,"[""CCI-001404""]","[""AC-2 (4)"", ""Rev_4""]","","","","","","","","","","","Determine if execution of the ""passwd"" executable is audited:

# auditctl -l | grep watch=/usr/bin/passwd

If /usr/bin/passwd is not listed with a permissions filter of at least ""x"",
this is a finding.","Configure the SLES for vRealize to automatically audit account
disabling actions by running the following command:

# /etc/dodscript.sh

OR

# echo '-w /usr/bin/passwd -p x -k passwd' >> /etc/audit/audit.rules

Restart the auditd service:

# service auditd restart","control ""V-89745"" do
  title ""The SLES for vRealize must audit all account disabling actions.""
  desc  ""When operating system accounts are disabled, user accessibility is
affected. Accounts are utilized for identifying individual users or for
identifying the operating system processes themselves. In order to detect and
respond to events affecting user accessibility and system processing, operating
systems must audit account disabling actions and, as required, notify the
appropriate individuals so they can investigate the event. Such a capability
greatly reduces the risk that operating system accessibility will be negatively
affected for extended periods of time and provides logging that can be used for
forensic purposes.

    To address access requirements, many operating systems can be integrated
with enterprise-level authentication/access/auditing mechanisms that meet or
exceed access control policy requirements.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000240-GPOS-00090""
  tag ""gid"": ""V-89745""
  tag ""rid"": ""SV-100395r1_rule""
  tag ""stig_id"": ""VRAU-SL-000880""
  tag ""fix_id"": ""F-96487r2_fix""
  tag ""cci"": [""CCI-001404""]
  tag ""nist"": [""AC-2 (4)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Determine if execution of the \""passwd\"" executable is audited:

# auditctl -l | grep watch=/usr/bin/passwd

If /usr/bin/passwd is not listed with a permissions filter of at least \""x\"",
this is a finding.""
  tag ""fix"": ""Configure the SLES for vRealize to automatically audit account
disabling actions by running the following command:

# /etc/dodscript.sh

OR

# echo '-w /usr/bin/passwd -p x -k passwd' >> /etc/audit/audit.rules

Restart the auditd service:

# service auditd restart""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89745.rb""}","","","","",""
V-89747,The SLES for vRealize must audit all account removal actions.,"When operating system accounts are removed, user accessibility is
affected. Accounts are utilized for identifying individual users or for
identifying the operating system processes themselves. In order to detect and
respond to events affecting user accessibility and system processing, operating
systems must audit account removal actions and, as required, notify the
appropriate individuals so they can investigate the event. Such a capability
greatly reduces the risk that operating system accessibility will be negatively
affected for extended periods of time and provides logging that can be used for
forensic purposes.

    To address access requirements, many operating systems can be integrated
with enterprise-level authentication/access/auditing mechanisms that meet or
exceed access control policy requirements.","[{""label""=>""default"", ""data""=>""When operating system accounts are removed, user accessibility is\naffected. Accounts are utilized for identifying individual users or for\nidentifying the operating system processes themselves. In order to detect and\nrespond to events affecting user accessibility and system processing, operating\nsystems must audit account removal actions and, as required, notify the\nappropriate individuals so they can investigate the event. Such a capability\ngreatly reduces the risk that operating system accessibility will be negatively\naffected for extended periods of time and provides logging that can be used for\nforensic purposes.\n\n    To address access requirements, many operating systems can be integrated\nwith enterprise-level authentication/access/auditing mechanisms that meet or\nexceed access control policy requirements.""}]",0.5,[],"",SRG-OS-000241-GPOS-00091,V-89747,SV-100397r1_rule,VRAU-SL-000885,F-96489r2_fix,"[""CCI-001405""]","[""AC-2 (4)"", ""Rev_4""]","","","","","","","","","","","Determine if execution of the ""userdel"" and ""groupdel""
executable are audited:

# auditctl -l | egrep '(userdel|groupdel)'

If either ""userdel"" or ""groupdel"" are not listed with a permissions filter
of at least ""x"", this is a finding.","Configure execute auditing of the ""userdel"" and ""groupdel""
executables. Add the following to the /etc/audit/audit.rules file:

-w /usr/sbin/userdel -p x -k userdel
-w /usr/sbin/groupdel -p x -k groupdel","control ""V-89747"" do
  title ""The SLES for vRealize must audit all account removal actions.""
  desc  ""When operating system accounts are removed, user accessibility is
affected. Accounts are utilized for identifying individual users or for
identifying the operating system processes themselves. In order to detect and
respond to events affecting user accessibility and system processing, operating
systems must audit account removal actions and, as required, notify the
appropriate individuals so they can investigate the event. Such a capability
greatly reduces the risk that operating system accessibility will be negatively
affected for extended periods of time and provides logging that can be used for
forensic purposes.

    To address access requirements, many operating systems can be integrated
with enterprise-level authentication/access/auditing mechanisms that meet or
exceed access control policy requirements.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000241-GPOS-00091""
  tag ""gid"": ""V-89747""
  tag ""rid"": ""SV-100397r1_rule""
  tag ""stig_id"": ""VRAU-SL-000885""
  tag ""fix_id"": ""F-96489r2_fix""
  tag ""cci"": [""CCI-001405""]
  tag ""nist"": [""AC-2 (4)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Determine if execution of the \""userdel\"" and \""groupdel\""
executable are audited:

# auditctl -l | egrep '(userdel|groupdel)'

If either \""userdel\"" or \""groupdel\"" are not listed with a permissions filter
of at least \""x\"", this is a finding.""
  tag ""fix"": ""Configure execute auditing of the \""userdel\"" and \""groupdel\""
executables. Add the following to the /etc/audit/audit.rules file:

-w /usr/sbin/userdel -p x -k userdel
-w /usr/sbin/groupdel -p x -k groupdel""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89747.rb""}","","","","",""
V-89749,"The SLES for vRealize must implement cryptography to protect the
integrity of remote access sessions.","Without cryptographic integrity protections, information can be
altered by unauthorized users without detection.

    Remote access (e.g., RDP) is access to DoD nonpublic information systems by
an authorized user (or an information system) communicating through an
external, non-organization-controlled network. Remote access methods include,
for example, dial-up, broadband, and wireless.

    Cryptographic mechanisms used for protecting the integrity of information
include, for example, signed hash functions using asymmetric cryptography
enabling distribution of the public key to verify the hash information while
maintaining the confidentiality of the secret key used to generate the hash.","[{""label""=>""default"", ""data""=>""Without cryptographic integrity protections, information can be\naltered by unauthorized users without detection.\n\n    Remote access (e.g., RDP) is access to DoD nonpublic information systems by\nan authorized user (or an information system) communicating through an\nexternal, non-organization-controlled network. Remote access methods include,\nfor example, dial-up, broadband, and wireless.\n\n    Cryptographic mechanisms used for protecting the integrity of information\ninclude, for example, signed hash functions using asymmetric cryptography\nenabling distribution of the public key to verify the hash information while\nmaintaining the confidentiality of the secret key used to generate the hash.""}]",0.5,[],"",SRG-OS-000250-GPOS-00093,V-89749,SV-100399r1_rule,VRAU-SL-000890,F-96491r2_fix,"[""CCI-001453""]","[""AC-17 (2)"", ""Rev_4""]","","","","","","","","","","","Check the SSH daemon configuration for DoD-approved encryption
to protect the confidentiality of SSH remote connections by performing the
following commands:

Check the ""Ciphers"" setting in the ""sshd_config"" file.

# grep -i Ciphers /etc/ssh/sshd_config  | grep -v '#'

The output must contain either nothing or any number of the following
algorithms:

aes128-ctr, aes256-ctr.

If the output contains an algorithm not listed above, this is a finding.

Expected Output:
Ciphers aes256-ctr,aes128-ctr","Update the ""Ciphers"" directive with the following command:

# sed -i ""/^[^#]*Ciphers/ c\Ciphers aes256-ctr,aes128-ctr""
/etc/ssh/sshd_config

Save and close the file.

Restart the sshd process:

# service sshd restart","control ""V-89749"" do
  title ""The SLES for vRealize must implement cryptography to protect the
integrity of remote access sessions.""
  desc  ""Without cryptographic integrity protections, information can be
altered by unauthorized users without detection.

    Remote access (e.g., RDP) is access to DoD nonpublic information systems by
an authorized user (or an information system) communicating through an
external, non-organization-controlled network. Remote access methods include,
for example, dial-up, broadband, and wireless.

    Cryptographic mechanisms used for protecting the integrity of information
include, for example, signed hash functions using asymmetric cryptography
enabling distribution of the public key to verify the hash information while
maintaining the confidentiality of the secret key used to generate the hash.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000250-GPOS-00093""
  tag ""gid"": ""V-89749""
  tag ""rid"": ""SV-100399r1_rule""
  tag ""stig_id"": ""VRAU-SL-000890""
  tag ""fix_id"": ""F-96491r2_fix""
  tag ""cci"": [""CCI-001453""]
  tag ""nist"": [""AC-17 (2)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the SSH daemon configuration for DoD-approved encryption
to protect the confidentiality of SSH remote connections by performing the
following commands:

Check the \""Ciphers\"" setting in the \""sshd_config\"" file.

# grep -i Ciphers /etc/ssh/sshd_config  | grep -v '#'

The output must contain either nothing or any number of the following
algorithms:

aes128-ctr, aes256-ctr.

If the output contains an algorithm not listed above, this is a finding.

Expected Output:
Ciphers aes256-ctr,aes128-ctr""
  tag ""fix"": ""Update the \""Ciphers\"" directive with the following command:

# sed -i \""/^[^#]*Ciphers/ c\\Ciphers aes256-ctr,aes128-ctr\""
/etc/ssh/sshd_config

Save and close the file.

Restart the sshd process:

# service sshd restart""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89749.rb""}","","","","",""
V-89751,The SLES for vRealize must initiate session audits at system start-up.,"If auditing is enabled late in the start-up process, the actions of
some start-up processes may not be audited. Some audit systems also maintain
state information only available if auditing is enabled before a given process
is created.","[{""label""=>""default"", ""data""=>""If auditing is enabled late in the start-up process, the actions of\nsome start-up processes may not be audited. Some audit systems also maintain\nstate information only available if auditing is enabled before a given process\nis created.""}]",0.5,[],"",SRG-OS-000254-GPOS-00095,V-89751,SV-100401r1_rule,VRAU-SL-000895,F-96493r1_fix,"[""CCI-001464""]","[""AU-14 (1)"", ""Rev_4""]","","","","","","","","","","","Check for the ""audit=1"" kernel parameter.

# grep ""audit=1"" /proc/cmdline

If no results are returned, this is a finding.","Edit the grub bootloader file /boot/grub/menu.lst by appending
the ""audit=1"" parameter to the kernel boot line.

Reboot the system for the change to take effect.","control ""V-89751"" do
  title ""The SLES for vRealize must initiate session audits at system start-up.""
  desc  ""If auditing is enabled late in the start-up process, the actions of
some start-up processes may not be audited. Some audit systems also maintain
state information only available if auditing is enabled before a given process
is created.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000254-GPOS-00095""
  tag ""gid"": ""V-89751""
  tag ""rid"": ""SV-100401r1_rule""
  tag ""stig_id"": ""VRAU-SL-000895""
  tag ""fix_id"": ""F-96493r1_fix""
  tag ""cci"": [""CCI-001464""]
  tag ""nist"": [""AU-14 (1)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check for the \""audit=1\"" kernel parameter.

# grep \""audit=1\"" /proc/cmdline

If no results are returned, this is a finding.""
  tag ""fix"": ""Edit the grub bootloader file /boot/grub/menu.lst by appending
the \""audit=1\"" parameter to the kernel boot line.

Reboot the system for the change to take effect.""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89751.rb""}","","","","",""
V-89753,"The SLES for vRealize must produce audit records containing
information to establish the identity of any individual or process associated
with the event.","Without information that establishes the identity of the subjects
(i.e., users or processes acting on behalf of users) associated with the
events, security personnel cannot determine responsibility for the potentially
harmful event.","[{""label""=>""default"", ""data""=>""Without information that establishes the identity of the subjects\n(i.e., users or processes acting on behalf of users) associated with the\nevents, security personnel cannot determine responsibility for the potentially\nharmful event.""}]",0.5,[],"",SRG-OS-000255-GPOS-00096,V-89753,SV-100403r1_rule,VRAU-SL-000900,F-96495r1_fix,"[""CCI-001487""]","[""AU-3"", ""Rev_4""]","","","","","","","","","","","Verify the SLES for vRealize produces audit records by running
the following command to determine the current status of the ""auditd"" service:

# service auditd status

If the service is enabled, the returned message must contain the following text:

Checking for service auditd                running

If the service is not ""running"", this is a finding.","Enable the ""auditd"" service by performing the following
commands:

# chkconfig auditd on
# service auditd start","control ""V-89753"" do
  title ""The SLES for vRealize must produce audit records containing
information to establish the identity of any individual or process associated
with the event.""
  desc  ""Without information that establishes the identity of the subjects
(i.e., users or processes acting on behalf of users) associated with the
events, security personnel cannot determine responsibility for the potentially
harmful event.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000255-GPOS-00096""
  tag ""gid"": ""V-89753""
  tag ""rid"": ""SV-100403r1_rule""
  tag ""stig_id"": ""VRAU-SL-000900""
  tag ""fix_id"": ""F-96495r1_fix""
  tag ""cci"": [""CCI-001487""]
  tag ""nist"": [""AU-3"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the SLES for vRealize produces audit records by running
the following command to determine the current status of the \""auditd\"" service:

# service auditd status

If the service is enabled, the returned message must contain the following text:

Checking for service auditd                running

If the service is not \""running\"", this is a finding.""
  tag ""fix"": ""Enable the \""auditd\"" service by performing the following
commands:

# chkconfig auditd on
# service auditd start""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89753.rb""}","","","","",""
V-89755,"The SLES for vRealize must protect audit tools from unauthorized
access.","Protecting audit information also includes identifying and protecting
the tools used to view and manipulate log data. Therefore, protecting audit
tools is necessary to prevent unauthorized operation on audit information.

    Operating systems providing tools to interface with audit information will
leverage user permissions and roles identifying the user accessing the tools
and the corresponding rights the user enjoys in order to make access decisions
regarding the access to audit tools.

    Audit tools include, but are not limited to, vendor-provided and open
source audit tools needed to successfully view and manipulate audit information
system activity and records. Audit tools include custom queries and report
generators.","[{""label""=>""default"", ""data""=>""Protecting audit information also includes identifying and protecting\nthe tools used to view and manipulate log data. Therefore, protecting audit\ntools is necessary to prevent unauthorized operation on audit information.\n\n    Operating systems providing tools to interface with audit information will\nleverage user permissions and roles identifying the user accessing the tools\nand the corresponding rights the user enjoys in order to make access decisions\nregarding the access to audit tools.\n\n    Audit tools include, but are not limited to, vendor-provided and open\nsource audit tools needed to successfully view and manipulate audit information\nsystem activity and records. Audit tools include custom queries and report\ngenerators.""}]",0.5,[],"",SRG-OS-000256-GPOS-00097,V-89755,SV-100405r1_rule,VRAU-SL-000905,F-96497r1_fix,"[""CCI-001493""]","[""AU-9"", ""Rev_4""]","","","","","","","","","","","The following command will list which audit files on the system
have permissions different from what is expected by the RPM database:

# rpm -V audit | grep '^.M'

If there is any output, for each file or directory found, compare the
RPM-expected permissions with the permissions on the file or directory:

# rpm -q --queryformat ""[%{FILENAMES} %{FILEMODES:perms}]"" audit | grep [filename]
# ls -lL [filename]

If the existing permissions are more permissive than those expected by RPM,
this is a finding.","Run the following command to reset audit permissions to the
correct values:

sudo rpm --setperms audit-1.8-0.34.26","control ""V-89755"" do
  title ""The SLES for vRealize must protect audit tools from unauthorized
access.""
  desc  ""Protecting audit information also includes identifying and protecting
the tools used to view and manipulate log data. Therefore, protecting audit
tools is necessary to prevent unauthorized operation on audit information.

    Operating systems providing tools to interface with audit information will
leverage user permissions and roles identifying the user accessing the tools
and the corresponding rights the user enjoys in order to make access decisions
regarding the access to audit tools.

    Audit tools include, but are not limited to, vendor-provided and open
source audit tools needed to successfully view and manipulate audit information
system activity and records. Audit tools include custom queries and report
generators.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000256-GPOS-00097""
  tag ""gid"": ""V-89755""
  tag ""rid"": ""SV-100405r1_rule""
  tag ""stig_id"": ""VRAU-SL-000905""
  tag ""fix_id"": ""F-96497r1_fix""
  tag ""cci"": [""CCI-001493""]
  tag ""nist"": [""AU-9"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""The following command will list which audit files on the system
have permissions different from what is expected by the RPM database:

# rpm -V audit | grep '^.M'

If there is any output, for each file or directory found, compare the
RPM-expected permissions with the permissions on the file or directory:

# rpm -q --queryformat \""[%{FILENAMES} %{FILEMODES:perms}\
]\"" audit | grep [filename]
# ls -lL [filename]

If the existing permissions are more permissive than those expected by RPM,
this is a finding.""
  tag ""fix"": ""Run the following command to reset audit permissions to the
correct values:

sudo rpm --setperms audit-1.8-0.34.26""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89755.rb""}","","","","",""
V-89757,"The SLES for vRealize must protect audit tools from unauthorized
modification.","Protecting audit information also includes identifying and protecting
the tools used to view and manipulate log data. Therefore, protecting audit
tools is necessary to prevent unauthorized operation on audit information.

    Operating systems providing tools to interface with audit information will
leverage user permissions and roles identifying the user accessing the tools
and the corresponding rights the user has in order to make access decisions
regarding the modification of audit tools.

    Audit tools include, but are not limited to, vendor-provided and open
source audit tools needed to successfully view and manipulate audit information
system activity and records. Audit tools include custom queries and report
generators.","[{""label""=>""default"", ""data""=>""Protecting audit information also includes identifying and protecting\nthe tools used to view and manipulate log data. Therefore, protecting audit\ntools is necessary to prevent unauthorized operation on audit information.\n\n    Operating systems providing tools to interface with audit information will\nleverage user permissions and roles identifying the user accessing the tools\nand the corresponding rights the user has in order to make access decisions\nregarding the modification of audit tools.\n\n    Audit tools include, but are not limited to, vendor-provided and open\nsource audit tools needed to successfully view and manipulate audit information\nsystem activity and records. Audit tools include custom queries and report\ngenerators.""}]",0.5,[],"",SRG-OS-000257-GPOS-00098,V-89757,SV-100407r1_rule,VRAU-SL-000910,F-96499r1_fix,"[""CCI-001494""]","[""AU-9"", ""Rev_4""]","","","","","","","","","","","The following command will list which audit files on the system
where the group-ownership has been modified:

# rpm -V audit | grep '^......G'

If there is output, this is a finding.","Run the following command to reset audit permissions to the
correct values:

sudo rpm --setperms audit-1.8-0.34.26","control ""V-89757"" do
  title ""The SLES for vRealize must protect audit tools from unauthorized
modification.""
  desc  ""Protecting audit information also includes identifying and protecting
the tools used to view and manipulate log data. Therefore, protecting audit
tools is necessary to prevent unauthorized operation on audit information.

    Operating systems providing tools to interface with audit information will
leverage user permissions and roles identifying the user accessing the tools
and the corresponding rights the user has in order to make access decisions
regarding the modification of audit tools.

    Audit tools include, but are not limited to, vendor-provided and open
source audit tools needed to successfully view and manipulate audit information
system activity and records. Audit tools include custom queries and report
generators.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000257-GPOS-00098""
  tag ""gid"": ""V-89757""
  tag ""rid"": ""SV-100407r1_rule""
  tag ""stig_id"": ""VRAU-SL-000910""
  tag ""fix_id"": ""F-96499r1_fix""
  tag ""cci"": [""CCI-001494""]
  tag ""nist"": [""AU-9"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""The following command will list which audit files on the system
where the group-ownership has been modified:

# rpm -V audit | grep '^......G'

If there is output, this is a finding.""
  tag ""fix"": ""Run the following command to reset audit permissions to the
correct values:

sudo rpm --setperms audit-1.8-0.34.26""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89757.rb""}","","","","",""
V-89759,"The SLES for vRealize must protect audit tools from unauthorized
deletion.","Protecting audit information also includes identifying and protecting
the tools used to view and manipulate log data. Therefore, protecting audit
tools is necessary to prevent unauthorized operation on audit information.

    Operating systems providing tools to interface with audit information will
leverage user permissions and roles identifying the user accessing the tools
and the corresponding rights the user has in order to make access decisions
regarding the deletion of audit tools.

    Audit tools include, but are not limited to, vendor-provided and open
source audit tools needed to successfully view and manipulate audit information
system activity and records. Audit tools include custom queries and report
generators.","[{""label""=>""default"", ""data""=>""Protecting audit information also includes identifying and protecting\nthe tools used to view and manipulate log data. Therefore, protecting audit\ntools is necessary to prevent unauthorized operation on audit information.\n\n    Operating systems providing tools to interface with audit information will\nleverage user permissions and roles identifying the user accessing the tools\nand the corresponding rights the user has in order to make access decisions\nregarding the deletion of audit tools.\n\n    Audit tools include, but are not limited to, vendor-provided and open\nsource audit tools needed to successfully view and manipulate audit information\nsystem activity and records. Audit tools include custom queries and report\ngenerators.""}]",0.5,[],"",SRG-OS-000258-GPOS-00099,V-89759,SV-100409r1_rule,VRAU-SL-000915,F-96501r1_fix,"[""CCI-001495""]","[""AU-9"", ""Rev_4""]","","","","","","","","","","","The following command will list which audit files on the system
where the ownership has been modified:

# rpm -V audit | grep '^.....U'

If there is output, this is a finding.","Run the following command to reset audit permissions to the
correct values:

sudo rpm --setperms audit-1.8-0.34.26","control ""V-89759"" do
  title ""The SLES for vRealize must protect audit tools from unauthorized
deletion.""
  desc  ""Protecting audit information also includes identifying and protecting
the tools used to view and manipulate log data. Therefore, protecting audit
tools is necessary to prevent unauthorized operation on audit information.

    Operating systems providing tools to interface with audit information will
leverage user permissions and roles identifying the user accessing the tools
and the corresponding rights the user has in order to make access decisions
regarding the deletion of audit tools.

    Audit tools include, but are not limited to, vendor-provided and open
source audit tools needed to successfully view and manipulate audit information
system activity and records. Audit tools include custom queries and report
generators.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000258-GPOS-00099""
  tag ""gid"": ""V-89759""
  tag ""rid"": ""SV-100409r1_rule""
  tag ""stig_id"": ""VRAU-SL-000915""
  tag ""fix_id"": ""F-96501r1_fix""
  tag ""cci"": [""CCI-001495""]
  tag ""nist"": [""AU-9"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""The following command will list which audit files on the system
where the ownership has been modified:

# rpm -V audit | grep '^.....U'

If there is output, this is a finding.""
  tag ""fix"": ""Run the following command to reset audit permissions to the
correct values:

sudo rpm --setperms audit-1.8-0.34.26""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89759.rb""}","","","","",""
V-89761,The shared library files must have restrictive permissions.,"If the operating system were to allow any user to make changes to
software libraries, then those changes might be implemented without undergoing
the appropriate testing and approvals that are part of a robust change
management process.

    This requirement applies to operating systems with software libraries that
are accessible and configurable, as in the case of interpreted languages.
Software libraries also include privileged programs that execute with escalated
privileges. Only qualified and authorized individuals must be allowed to obtain
access to information system components for purposes of initiating changes,
including upgrades and modifications.","[{""label""=>""default"", ""data""=>""If the operating system were to allow any user to make changes to\nsoftware libraries, then those changes might be implemented without undergoing\nthe appropriate testing and approvals that are part of a robust change\nmanagement process.\n\n    This requirement applies to operating systems with software libraries that\nare accessible and configurable, as in the case of interpreted languages.\nSoftware libraries also include privileged programs that execute with escalated\nprivileges. Only qualified and authorized individuals must be allowed to obtain\naccess to information system components for purposes of initiating changes,\nincluding upgrades and modifications.""}]",0.5,[],"",SRG-OS-000259-GPOS-00100,V-89761,SV-100411r1_rule,VRAU-SL-000920,F-96503r2_fix,"[""CCI-001499""]","[""CM-5 (6)"", ""Rev_4""]","","","","","","","","","","","Verify that that system wide shared library files are not
group-writable or world writable with the following command:

ls -l /lib /lib64 /usr/lib /usr/lib64 /lib/modules

If any library files are group-writable or world writable, this is a finding.","For any shared library file that was a finding:

sudo chmod go-w <filename>","control ""V-89761"" do
  title ""The shared library files must have restrictive permissions.""
  desc  ""If the operating system were to allow any user to make changes to
software libraries, then those changes might be implemented without undergoing
the appropriate testing and approvals that are part of a robust change
management process.

    This requirement applies to operating systems with software libraries that
are accessible and configurable, as in the case of interpreted languages.
Software libraries also include privileged programs that execute with escalated
privileges. Only qualified and authorized individuals must be allowed to obtain
access to information system components for purposes of initiating changes,
including upgrades and modifications.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000259-GPOS-00100""
  tag ""gid"": ""V-89761""
  tag ""rid"": ""SV-100411r1_rule""
  tag ""stig_id"": ""VRAU-SL-000920""
  tag ""fix_id"": ""F-96503r2_fix""
  tag ""cci"": [""CCI-001499""]
  tag ""nist"": [""CM-5 (6)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that that system wide shared library files are not
group-writable or world writable with the following command:

ls -l /lib /lib64 /usr/lib /usr/lib64 /lib/modules

If any library files are group-writable or world writable, this is a finding.""
  tag ""fix"": ""For any shared library file that was a finding:

sudo chmod go-w <filename>""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89761.rb""}","","","","",""
V-89763,Shared library files must have root ownership.,"If the operating system were to allow any user to make changes to
software libraries, then those changes might be implemented without undergoing
the appropriate testing and approvals that are part of a robust change
management process.

    This requirement applies to operating systems with software libraries that
are accessible and configurable, as in the case of interpreted languages.
Software libraries also include privileged programs which execute with
escalated privileges. Only qualified and authorized individuals must be allowed
to obtain access to information system components for purposes of initiating
changes, including upgrades and modifications.","[{""label""=>""default"", ""data""=>""If the operating system were to allow any user to make changes to\nsoftware libraries, then those changes might be implemented without undergoing\nthe appropriate testing and approvals that are part of a robust change\nmanagement process.\n\n    This requirement applies to operating systems with software libraries that\nare accessible and configurable, as in the case of interpreted languages.\nSoftware libraries also include privileged programs which execute with\nescalated privileges. Only qualified and authorized individuals must be allowed\nto obtain access to information system components for purposes of initiating\nchanges, including upgrades and modifications.""}]",0.5,[],"",SRG-OS-000259-GPOS-00100,V-89763,SV-100413r1_rule,VRAU-SL-000921,F-96505r1_fix,"[""CCI-001499""]","[""CM-5 (6)"", ""Rev_4""]","","","","","","","","","","","Verify that that system wide shared library files have root
ownership with the following command:

ls -l /lib /lib64 /usr/lib /usr/lib64 /lib/modules

If any library files are not root owned, this is a finding.","For any shared library file that was a finding:

sudo chown root <filename>","control ""V-89763"" do
  title ""Shared library files must have root ownership.""
  desc  "" If the operating system were to allow any user to make changes to
software libraries, then those changes might be implemented without undergoing
the appropriate testing and approvals that are part of a robust change
management process.

    This requirement applies to operating systems with software libraries that
are accessible and configurable, as in the case of interpreted languages.
Software libraries also include privileged programs which execute with
escalated privileges. Only qualified and authorized individuals must be allowed
to obtain access to information system components for purposes of initiating
changes, including upgrades and modifications.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000259-GPOS-00100""
  tag ""gid"": ""V-89763""
  tag ""rid"": ""SV-100413r1_rule""
  tag ""stig_id"": ""VRAU-SL-000921""
  tag ""fix_id"": ""F-96505r1_fix""
  tag ""cci"": [""CCI-001499""]
  tag ""nist"": [""CM-5 (6)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that that system wide shared library files have root
ownership with the following command:

ls -l /lib /lib64 /usr/lib /usr/lib64 /lib/modules

If any library files are not root owned, this is a finding.""
  tag ""fix"": ""For any shared library file that was a finding:

sudo chown root <filename>""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89763.rb""}","","","","",""
V-89765,System executables must have restrictive permissions.,"If the operating system were to allow any user to make changes to
software libraries, then those changes might be implemented without undergoing
the appropriate testing and approvals that are part of a robust change
management process.

    This requirement applies to operating systems with software libraries that
are accessible and configurable, as in the case of interpreted languages.
Software libraries also include privileged programs which execute with
escalated privileges. Only qualified and authorized individuals must be allowed
to obtain access to information system components for purposes of initiating
changes, including upgrades and modifications.","[{""label""=>""default"", ""data""=>""If the operating system were to allow any user to make changes to\nsoftware libraries, then those changes might be implemented without undergoing\nthe appropriate testing and approvals that are part of a robust change\nmanagement process.\n\n    This requirement applies to operating systems with software libraries that\nare accessible and configurable, as in the case of interpreted languages.\nSoftware libraries also include privileged programs which execute with\nescalated privileges. Only qualified and authorized individuals must be allowed\nto obtain access to information system components for purposes of initiating\nchanges, including upgrades and modifications.""}]",0.5,[],"",SRG-OS-000259-GPOS-00100,V-89765,SV-100415r1_rule,VRAU-SL-000922,F-96507r2_fix,"[""CCI-001499""]","[""CM-5 (6)"", ""Rev_4""]","","","","","","","","","","","Verify that that system executables are not group-writable or
world writable with the following command:

ls -l /bin /sbin /usr/bin /usr/libexec /usr/local/bin /usr/local/sbin /usr/sbin

If any  files are group-writable or world writable, this is a finding.","For any file that was a finding:

sudo chmod go-w <filename>","control ""V-89765"" do
  title ""System executables must have restrictive permissions.""
  desc  "" If the operating system were to allow any user to make changes to
software libraries, then those changes might be implemented without undergoing
the appropriate testing and approvals that are part of a robust change
management process.

    This requirement applies to operating systems with software libraries that
are accessible and configurable, as in the case of interpreted languages.
Software libraries also include privileged programs which execute with
escalated privileges. Only qualified and authorized individuals must be allowed
to obtain access to information system components for purposes of initiating
changes, including upgrades and modifications.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000259-GPOS-00100""
  tag ""gid"": ""V-89765""
  tag ""rid"": ""SV-100415r1_rule""
  tag ""stig_id"": ""VRAU-SL-000922""
  tag ""fix_id"": ""F-96507r2_fix""
  tag ""cci"": [""CCI-001499""]
  tag ""nist"": [""CM-5 (6)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that that system executables are not group-writable or
world writable with the following command:

ls -l /bin /sbin /usr/bin /usr/libexec /usr/local/bin /usr/local/sbin /usr/sbin

If any  files are group-writable or world writable, this is a finding.""
  tag ""fix"": ""For any file that was a finding:

sudo chmod go-w <filename>""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89765.rb""}","","","","",""
V-89767,System executables must have root ownership.,"If the operating system were to allow any user to make changes to
software libraries, then those changes might be implemented without undergoing
the appropriate testing and approvals that are part of a robust change
management process.

    This requirement applies to operating systems with software libraries that
are accessible and configurable, as in the case of interpreted languages.
Software libraries also include privileged programs which execute with
escalated privileges. Only qualified and authorized individuals must be allowed
to obtain access to information system components for purposes of initiating
changes, including upgrades and modifications.","[{""label""=>""default"", ""data""=>""If the operating system were to allow any user to make changes to\nsoftware libraries, then those changes might be implemented without undergoing\nthe appropriate testing and approvals that are part of a robust change\nmanagement process.\n\n    This requirement applies to operating systems with software libraries that\nare accessible and configurable, as in the case of interpreted languages.\nSoftware libraries also include privileged programs which execute with\nescalated privileges. Only qualified and authorized individuals must be allowed\nto obtain access to information system components for purposes of initiating\nchanges, including upgrades and modifications.""}]",0.5,[],"",SRG-OS-000259-GPOS-00100,V-89767,SV-100417r1_rule,VRAU-SL-000923,F-96509r1_fix,"[""CCI-001499""]","[""CM-5 (6)"", ""Rev_4""]","","","","","","","","","","","Verify that that system executable files have root ownership
with the following command:

ls -l /bin /sbin /usr/bin /usr/libexec /usr/local/bin /usr/local/sbin /usr/sbin

If any library files are not root owned, this is a finding.","For any file that was a finding:

sudo chown root <filename>","control ""V-89767"" do
  title ""System executables must have root ownership.""
  desc  ""If the operating system were to allow any user to make changes to
software libraries, then those changes might be implemented without undergoing
the appropriate testing and approvals that are part of a robust change
management process.

    This requirement applies to operating systems with software libraries that
are accessible and configurable, as in the case of interpreted languages.
Software libraries also include privileged programs which execute with
escalated privileges. Only qualified and authorized individuals must be allowed
to obtain access to information system components for purposes of initiating
changes, including upgrades and modifications.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000259-GPOS-00100""
  tag ""gid"": ""V-89767""
  tag ""rid"": ""SV-100417r1_rule""
  tag ""stig_id"": ""VRAU-SL-000923""
  tag ""fix_id"": ""F-96509r1_fix""
  tag ""cci"": [""CCI-001499""]
  tag ""nist"": [""CM-5 (6)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that that system executable files have root ownership
with the following command:

ls -l /bin /sbin /usr/bin /usr/libexec /usr/local/bin /usr/local/sbin /usr/sbin

If any library files are not root owned, this is a finding.""
  tag ""fix"": ""For any file that was a finding:

sudo chown root <filename>""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89767.rb""}","","","","",""
V-89769,"The SLES for vRealize must enforce password complexity by requiring
that at least one special character be used.","Use of a complex password helps to increase the time and resources
required to compromise the password. Password complexity or strength is a
measure of the effectiveness of a password in resisting attempts at guessing
and brute-force attacks.

    Password complexity is one factor in determining how long it takes to crack
a password. The more complex the password, the greater the number of possible
combinations that need to be tested before the password is compromised.

    Special characters are those characters that are not alphanumeric. Examples
include: ~ ! @ # $ % ^ *.","[{""label""=>""default"", ""data""=>""Use of a complex password helps to increase the time and resources\nrequired to compromise the password. Password complexity or strength is a\nmeasure of the effectiveness of a password in resisting attempts at guessing\nand brute-force attacks.\n\n    Password complexity is one factor in determining how long it takes to crack\na password. The more complex the password, the greater the number of possible\ncombinations that need to be tested before the password is compromised.\n\n    Special characters are those characters that are not alphanumeric. Examples\ninclude: ~ ! @ # $ % ^ *.""}]",0.5,[],"",SRG-OS-000266-GPOS-00101,V-89769,SV-100419r1_rule,VRAU-SL-000925,F-96511r1_fix,"[""CCI-001619""]","[""IA-5 (1) (a)"", ""Rev_4""]","","","","","","","","","","","Verify the SLES for vRealize enforces password complexity by
requiring that at least one special character be used by using the following
command:

Check the password ""ocredit"" option:

# grep pam_cracklib.so /etc/pam.d/common-password

Confirm the ""ocredit"" option is set to ""-1"" as in the example:

password requisite pam_cracklib.so ocredit=-1

There may be other options on the line.

If no such line is found, or the ""ocredit"" is not ""-1"", this is a finding.","Configure the SLES for vRealize to enforce password complexity by
requiring that at least one special character be used:

If ""ocredit"" was not set at all in /etc/pam.d/common-password-vmware.local
then run the following command:

# sed -i '/pam_cracklib.so/ s/$/ ocredit=-1/'
/etc/pam.d/common-password-vmware.local

If ""ocredit"" was set incorrectly then run the following command:

# sed -i '/pam_cracklib.so/ s/ocredit=../ocredit=-1/'
/etc/pam.d/common-password-vmware.local","control ""V-89769"" do
  title ""The SLES for vRealize must enforce password complexity by requiring
that at least one special character be used.""
  desc  ""Use of a complex password helps to increase the time and resources
required to compromise the password. Password complexity or strength is a
measure of the effectiveness of a password in resisting attempts at guessing
and brute-force attacks.

    Password complexity is one factor in determining how long it takes to crack
a password. The more complex the password, the greater the number of possible
combinations that need to be tested before the password is compromised.

    Special characters are those characters that are not alphanumeric. Examples
include: ~ ! @ # $ % ^ *.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000266-GPOS-00101""
  tag ""gid"": ""V-89769""
  tag ""rid"": ""SV-100419r1_rule""
  tag ""stig_id"": ""VRAU-SL-000925""
  tag ""fix_id"": ""F-96511r1_fix""
  tag ""cci"": [""CCI-001619""]
  tag ""nist"": [""IA-5 (1) (a)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the SLES for vRealize enforces password complexity by
requiring that at least one special character be used by using the following
command:

Check the password \""ocredit\"" option:

# grep pam_cracklib.so /etc/pam.d/common-password

Confirm the \""ocredit\"" option is set to \""-1\"" as in the example:

password requisite pam_cracklib.so ocredit=-1

There may be other options on the line.

If no such line is found, or the \""ocredit\"" is not \""-1\"", this is a finding.""
  tag ""fix"": ""Configure the SLES for vRealize to enforce password complexity by
requiring that at least one special character be used:

If \""ocredit\"" was not set at all in /etc/pam.d/common-password-vmware.local
then run the following command:

# sed -i '/pam_cracklib.so/ s/$/ ocredit=-1/'
/etc/pam.d/common-password-vmware.local

If \""ocredit\"" was set incorrectly then run the following command:

# sed -i '/pam_cracklib.so/ s/ocredit=../ocredit=-1/'
/etc/pam.d/common-password-vmware.local""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89769.rb""}","","","","",""
V-89771,"The SLES for vRealize must automatically terminate a user session
after inactivity time-outs have expired or at shutdown.","Automatic session termination addresses the termination of
user-initiated logical sessions in contrast to the termination of network
connections that are associated with communications sessions (i.e., network
disconnect). A logical session (for local, network, and remote access) is
initiated whenever a user (or process acting on behalf of a user) accesses an
organizational information system. Such user sessions can be terminated (and
thus terminate user access) without terminating network sessions.

    Session termination terminates all processes associated with a user's
logical session except those processes that are specifically created by the
user (i.e., session owner) to continue after the session is terminated.

    Conditions or trigger events requiring automatic session termination can
include, for example, organization-defined periods of user inactivity, targeted
responses to certain types of incidents, and time-of-day restrictions on
information system use.

    This capability is typically reserved for specific operating system
functionality where the system owner, data owner, or organization requires
additional assurance.","[{""label""=>""default"", ""data""=>""Automatic session termination addresses the termination of\nuser-initiated logical sessions in contrast to the termination of network\nconnections that are associated with communications sessions (i.e., network\ndisconnect). A logical session (for local, network, and remote access) is\ninitiated whenever a user (or process acting on behalf of a user) accesses an\norganizational information system. Such user sessions can be terminated (and\nthus terminate user access) without terminating network sessions.\n\n    Session termination terminates all processes associated with a user's\nlogical session except those processes that are specifically created by the\nuser (i.e., session owner) to continue after the session is terminated.\n\n    Conditions or trigger events requiring automatic session termination can\ninclude, for example, organization-defined periods of user inactivity, targeted\nresponses to certain types of incidents, and time-of-day restrictions on\ninformation system use.\n\n    This capability is typically reserved for specific operating system\nfunctionality where the system owner, data owner, or organization requires\nadditional assurance.""}]",0.5,[],"",SRG-OS-000279-GPOS-00109,V-89771,SV-100421r1_rule,VRAU-SL-000960,F-96513r1_fix,"[""CCI-002361""]","[""AC-12"", ""Rev_4""]","","","","","","","","","","","Check for the existence of the /etc/profile.d/tmout.sh file:

# ls -al /etc/profile.d/tmout.sh

Check for the presence of the ""TMOUT"" variable:

# grep TMOUT /etc/profile.d/tmout.sh

The value of ""TMOUT"" should be set to ""900"" seconds (15 minutes).

If the file does not exist, or the ""TMOUT"" variable is not set to ""900"",
this is a finding.","Ensure the file exists and is owned by ""root"". If the files
does not exist, use the following commands to create the file:

# touch /etc/profile.d/tmout.sh
# chown root:root /etc/profile.d/tmout.sh
# chmod 644 /etc/profile.d/tmout.sh

Edit the file /etc/profile.d/tmout.sh, and add the following lines:

TMOUT=900
readonly TMOUT
export TMOUT
mesg n 2>/dev/null","control ""V-89771"" do
  title ""The SLES for vRealize must automatically terminate a user session
after inactivity time-outs have expired or at shutdown.""
  desc  ""Automatic session termination addresses the termination of
user-initiated logical sessions in contrast to the termination of network
connections that are associated with communications sessions (i.e., network
disconnect). A logical session (for local, network, and remote access) is
initiated whenever a user (or process acting on behalf of a user) accesses an
organizational information system. Such user sessions can be terminated (and
thus terminate user access) without terminating network sessions.

    Session termination terminates all processes associated with a user's
logical session except those processes that are specifically created by the
user (i.e., session owner) to continue after the session is terminated.

    Conditions or trigger events requiring automatic session termination can
include, for example, organization-defined periods of user inactivity, targeted
responses to certain types of incidents, and time-of-day restrictions on
information system use.

    This capability is typically reserved for specific operating system
functionality where the system owner, data owner, or organization requires
additional assurance.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000279-GPOS-00109""
  tag ""gid"": ""V-89771""
  tag ""rid"": ""SV-100421r1_rule""
  tag ""stig_id"": ""VRAU-SL-000960""
  tag ""fix_id"": ""F-96513r1_fix""
  tag ""cci"": [""CCI-002361""]
  tag ""nist"": [""AC-12"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check for the existence of the /etc/profile.d/tmout.sh file:

# ls -al /etc/profile.d/tmout.sh

Check for the presence of the \""TMOUT\"" variable:

# grep TMOUT /etc/profile.d/tmout.sh

The value of \""TMOUT\"" should be set to \""900\"" seconds (15 minutes).

If the file does not exist, or the \""TMOUT\"" variable is not set to \""900\"",
this is a finding.""
  tag ""fix"": ""Ensure the file exists and is owned by \""root\"". If the files
does not exist, use the following commands to create the file:

# touch /etc/profile.d/tmout.sh
# chown root:root /etc/profile.d/tmout.sh
# chmod 644 /etc/profile.d/tmout.sh

Edit the file /etc/profile.d/tmout.sh, and add the following lines:

TMOUT=900
readonly TMOUT
export TMOUT
mesg n 2>/dev/null""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89771.rb""}","","","","",""
V-89773,The SLES for vRealize must control remote access methods.,"Remote access services, such as those providing remote access to
network devices and information systems, which lack automated control
capabilities, increase risk and make remote user access management difficult at
best.

    Remote access is access to DoD nonpublic information systems by an
authorized user (or an information system) communicating through an external,
non-organization-controlled network. Remote access methods include, for
example, dial-up, broadband, and wireless.

    Operating system functionality (e.g., RDP) must be capable of taking
enforcement action if the audit reveals unauthorized activity. Automated
control of remote access sessions allows organizations to ensure ongoing
compliance with remote access policies by enforcing connection rules of remote
access applications on a variety of information system components (e.g.,
servers, workstations, notebook computers, smartphones, and tablets).","[{""label""=>""default"", ""data""=>""Remote access services, such as those providing remote access to\nnetwork devices and information systems, which lack automated control\ncapabilities, increase risk and make remote user access management difficult at\nbest.\n\n    Remote access is access to DoD nonpublic information systems by an\nauthorized user (or an information system) communicating through an external,\nnon-organization-controlled network. Remote access methods include, for\nexample, dial-up, broadband, and wireless.\n\n    Operating system functionality (e.g., RDP) must be capable of taking\nenforcement action if the audit reveals unauthorized activity. Automated\ncontrol of remote access sessions allows organizations to ensure ongoing\ncompliance with remote access policies by enforcing connection rules of remote\naccess applications on a variety of information system components (e.g.,\nservers, workstations, notebook computers, smartphones, and tablets).""}]",0.5,[],"",SRG-OS-000297-GPOS-00115,V-89773,SV-100423r1_rule,VRAU-SL-000975,F-96515r2_fix,"[""CCI-002314""]","[""AC-17 (1)"", ""Rev_4""]","","","","","","","","","","","Check the SSH daemon configuration for listening network
addresses:

# grep -i Listen /etc/ssh/sshd_config | grep -v '^#'

If no configuration is returned, or if a returned ""Listen"" configuration
contains addresses not designated for management traffic, this is a finding.","Edit the SSH daemon configuration /etc/ssh/sshd_config to specify
listening network addresses designated for management traffic with the
following command:

sed -i ""/^ListenAddress/ c\ListenAddress x.x.x.x"" /etc/ssh/sshd_config

Note: Replace x.x.x.x with the desired remote access IP address.","control ""V-89773"" do
  title ""The SLES for vRealize must control remote access methods.""
  desc  ""Remote access services, such as those providing remote access to
network devices and information systems, which lack automated control
capabilities, increase risk and make remote user access management difficult at
best.

    Remote access is access to DoD nonpublic information systems by an
authorized user (or an information system) communicating through an external,
non-organization-controlled network. Remote access methods include, for
example, dial-up, broadband, and wireless.

    Operating system functionality (e.g., RDP) must be capable of taking
enforcement action if the audit reveals unauthorized activity. Automated
control of remote access sessions allows organizations to ensure ongoing
compliance with remote access policies by enforcing connection rules of remote
access applications on a variety of information system components (e.g.,
servers, workstations, notebook computers, smartphones, and tablets).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000297-GPOS-00115""
  tag ""gid"": ""V-89773""
  tag ""rid"": ""SV-100423r1_rule""
  tag ""stig_id"": ""VRAU-SL-000975""
  tag ""fix_id"": ""F-96515r2_fix""
  tag ""cci"": [""CCI-002314""]
  tag ""nist"": [""AC-17 (1)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the SSH daemon configuration for listening network
addresses:

# grep -i Listen /etc/ssh/sshd_config | grep -v '^#'

If no configuration is returned, or if a returned \""Listen\"" configuration
contains addresses not designated for management traffic, this is a finding.""
  tag ""fix"": ""Edit the SSH daemon configuration /etc/ssh/sshd_config to specify
listening network addresses designated for management traffic with the
following command:

sed -i \""/^ListenAddress/ c\\ListenAddress x.x.x.x\"" /etc/ssh/sshd_config

Note: Replace x.x.x.x with the desired remote access IP address.""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89773.rb""}","","","","",""
V-89775,The SLES for vRealize must audit all account enabling actions.,"Once an attacker establishes initial access to a system, the attacker
often attempts to create a persistent method of reestablishing access. One way
to accomplish this is for the attacker to simply enable a new or disabled
account. Notification of account enabling is one method for mitigating this
risk. A comprehensive account management process will ensure an audit trail,
which documents the creation of operating system user accounts and notifies
System Administrators and Information System Security Officers (ISSO) that it
exists. Such a process greatly reduces the risk that accounts will be
surreptitiously created and provides logging that can be used for forensic
purposes.

    To address access requirements, many operating systems can be integrated
with enterprise-level authentication/access/auditing mechanisms that meet or
exceed access control policy requirements.","[{""label""=>""default"", ""data""=>""Once an attacker establishes initial access to a system, the attacker\noften attempts to create a persistent method of reestablishing access. One way\nto accomplish this is for the attacker to simply enable a new or disabled\naccount. Notification of account enabling is one method for mitigating this\nrisk. A comprehensive account management process will ensure an audit trail,\nwhich documents the creation of operating system user accounts and notifies\nSystem Administrators and Information System Security Officers (ISSO) that it\nexists. Such a process greatly reduces the risk that accounts will be\nsurreptitiously created and provides logging that can be used for forensic\npurposes.\n\n    To address access requirements, many operating systems can be integrated\nwith enterprise-level authentication/access/auditing mechanisms that meet or\nexceed access control policy requirements.""}]",0.5,[],"",SRG-OS-000303-GPOS-00120,V-89775,SV-100425r1_rule,VRAU-SL-000995,F-96517r1_fix,"[""CCI-002130""]","[""AC-2 (4)"", ""Rev_4""]","","","","","","","","","","","Determine if execution of the ""usermod"" and ""groupmod""
executable are audited:

# auditctl -l | egrep '(usermod|groupmod)'

If either ""usermod"" or ""groupmod"" are not listed with a permissions filter
of at least ""x"", this is a finding.

Determine if execution of the ""userdel"" and ""groupdel"" executable are
audited:

# auditctl -l | egrep '(userdel|groupdel)'

If either ""userdel"" or ""groupdel"" are not listed with a permissions filter
of at least ""x"", this is a finding.

Determine if execution of ""useradd"" and ""groupadd"" are audited:

# auditctl -l | egrep '(useradd|groupadd)'

If either ""useradd"" or ""groupadd"" are not listed with a permissions filter
of at least ""x"", this is a finding.

Determine if execution of the ""passwd"" executable is audited:

# auditctl -l | grep “/usr/bin/passwd”

If ""/usr/bin/passwd"" is not listed with a permissions filter of at least
""x"", this is a finding.

Determine if /etc/passwd, /etc/shadow, /etc/group, and /etc/security/opasswd
are audited for writing:

# auditctl -l | egrep
'(/etc/passwd|/etc/shadow|/etc/group|/etc/security/opasswd)'

If any of these are not listed with a permissions filter of at least ""w"",
this is a finding.","Configure ""execute"" auditing of the ""usermod"" and
""groupmod"" executables. Add the following to the /etc/audit/audit.rules file:

-w /usr/sbin/usermod -p x -k usermod
-w /usr/sbin/groupmod -p x -k groupmod

Configure ""execute"" auditing of the ""userdel"" and ""groupdel"" executables.
Add the following to the /etc/audit/audit.rules file:

-w /usr/sbin/userdel -p x -k userdel
-w /usr/sbin/groupdel -p x -k groupdel

Configure ""execute"" auditing of the ""useradd"" and ""groupadd"" executables.
Add the following to audit.rules:

-w /usr/sbin/useradd -p x -k useradd
-w /usr/sbin/groupadd -p x -k groupadd

Configure ""execute"" auditing of the ""passwd"" executable. Add the following
to the aud.rules:

-w /usr/bin/passwd -p x -k passwd

Configure ""write"" auditing of the ""passwd"", ""shadow"", ""group"", and
""opasswd"" files. Add the following to the /etc/audit/audit.rules file:

-w /etc/passwd -p wa -k passwd
-w /etc/shadow -p wa -k shadow
-w /etc/group -p wa -k group
-w /etc/security/opasswd -p wa -k opasswd

Restart the auditd service:

# service auditd restart","control ""V-89775"" do
  title ""The SLES for vRealize must audit all account enabling actions.""
  desc  ""Once an attacker establishes initial access to a system, the attacker
often attempts to create a persistent method of reestablishing access. One way
to accomplish this is for the attacker to simply enable a new or disabled
account. Notification of account enabling is one method for mitigating this
risk. A comprehensive account management process will ensure an audit trail,
which documents the creation of operating system user accounts and notifies
System Administrators and Information System Security Officers (ISSO) that it
exists. Such a process greatly reduces the risk that accounts will be
surreptitiously created and provides logging that can be used for forensic
purposes.

    To address access requirements, many operating systems can be integrated
with enterprise-level authentication/access/auditing mechanisms that meet or
exceed access control policy requirements.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000303-GPOS-00120""
  tag ""gid"": ""V-89775""
  tag ""rid"": ""SV-100425r1_rule""
  tag ""stig_id"": ""VRAU-SL-000995""
  tag ""fix_id"": ""F-96517r1_fix""
  tag ""cci"": [""CCI-002130""]
  tag ""nist"": [""AC-2 (4)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Determine if execution of the \""usermod\"" and \""groupmod\""
executable are audited:

# auditctl -l | egrep '(usermod|groupmod)'

If either \""usermod\"" or \""groupmod\"" are not listed with a permissions filter
of at least \""x\"", this is a finding.

Determine if execution of the \""userdel\"" and \""groupdel\"" executable are
audited:

# auditctl -l | egrep '(userdel|groupdel)'

If either \""userdel\"" or \""groupdel\"" are not listed with a permissions filter
of at least \""x\"", this is a finding.

Determine if execution of \""useradd\"" and \""groupadd\"" are audited:

# auditctl -l | egrep '(useradd|groupadd)'

If either \""useradd\"" or \""groupadd\"" are not listed with a permissions filter
of at least \""x\"", this is a finding.

Determine if execution of the \""passwd\"" executable is audited:

# auditctl -l | grep “/usr/bin/passwd”

If \""/usr/bin/passwd\"" is not listed with a permissions filter of at least
\""x\"", this is a finding.

Determine if /etc/passwd, /etc/shadow, /etc/group, and /etc/security/opasswd
are audited for writing:

# auditctl -l | egrep
'(/etc/passwd|/etc/shadow|/etc/group|/etc/security/opasswd)'

If any of these are not listed with a permissions filter of at least \""w\"",
this is a finding.""
  tag ""fix"": ""Configure \""execute\"" auditing of the \""usermod\"" and
\""groupmod\"" executables. Add the following to the /etc/audit/audit.rules file:

-w /usr/sbin/usermod -p x -k usermod
-w /usr/sbin/groupmod -p x -k groupmod

Configure \""execute\"" auditing of the \""userdel\"" and \""groupdel\"" executables.
Add the following to the /etc/audit/audit.rules file:

-w /usr/sbin/userdel -p x -k userdel
-w /usr/sbin/groupdel -p x -k groupdel

Configure \""execute\"" auditing of the \""useradd\"" and \""groupadd\"" executables.
Add the following to audit.rules:

-w /usr/sbin/useradd -p x -k useradd
-w /usr/sbin/groupadd -p x -k groupadd

Configure \""execute\"" auditing of the \""passwd\"" executable. Add the following
to the aud.rules:

-w /usr/bin/passwd -p x -k passwd

Configure \""write\"" auditing of the \""passwd\"", \""shadow\"", \""group\"", and
\""opasswd\"" files. Add the following to the /etc/audit/audit.rules file:

-w /etc/passwd -p wa -k passwd
-w /etc/shadow -p wa -k shadow
-w /etc/group -p wa -k group
-w /etc/security/opasswd -p wa -k opasswd

Restart the auditd service:

# service auditd restart""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89775.rb""}","","","","",""
V-89777,"The SLES for vRealize must notify System Administrators and
Information System Security Officers when accounts are created, or enabled when
previously disabled.","Once an attacker establishes initial access to a system, the attacker
often attempts to create a persistent method of reestablishing access. One way
to accomplish this is for the attacker to simply enable a new or disabled
account. Notification of account enabling is one method for mitigating this
risk. A comprehensive account management process will ensure an audit trail,
which documents the creation of operating system user accounts and notifies
System Administrators and Information System Security Officers (ISSO) that it
exists. Such a process greatly reduces the risk that accounts will be
surreptitiously enabled and provides logging that can be used for forensic
purposes.

    In order to detect and respond to events that affect user accessibility and
application processing, operating systems must audit account enabling actions
and, as required, notify the appropriate individuals so they can investigate
the event.

    To address access requirements, many operating systems can be integrated
with enterprise-level authentication/access/auditing mechanisms that meet or
exceed access control policy requirements.","[{""label""=>""default"", ""data""=>""Once an attacker establishes initial access to a system, the attacker\noften attempts to create a persistent method of reestablishing access. One way\nto accomplish this is for the attacker to simply enable a new or disabled\naccount. Notification of account enabling is one method for mitigating this\nrisk. A comprehensive account management process will ensure an audit trail,\nwhich documents the creation of operating system user accounts and notifies\nSystem Administrators and Information System Security Officers (ISSO) that it\nexists. Such a process greatly reduces the risk that accounts will be\nsurreptitiously enabled and provides logging that can be used for forensic\npurposes.\n\n    In order to detect and respond to events that affect user accessibility and\napplication processing, operating systems must audit account enabling actions\nand, as required, notify the appropriate individuals so they can investigate\nthe event.\n\n    To address access requirements, many operating systems can be integrated\nwith enterprise-level authentication/access/auditing mechanisms that meet or\nexceed access control policy requirements.""}]",0.5,[],"",SRG-OS-000304-GPOS-00121,V-89777,SV-100427r1_rule,VRAU-SL-001000,F-96519r1_fix,"[""CCI-002132""]","[""AC-2 (4)"", ""Rev_4""]","","","","","","","","","","","Determine if execution of the ""usermod"" and ""groupmod""
executable are audited:

# auditctl -l | egrep '(usermod|groupmod)'

If either ""usermod"" or ""groupmod"" are not listed with a permissions filter
of at least ""x"", this is a finding.

Determine if execution of the ""userdel"" and ""groupdel"" executable are
audited:

# auditctl -l | egrep '(userdel|groupdel)'

If either ""userdel"" or ""groupdel"" are not listed with a permissions filter
of at least ""x"", this is a finding.

Determine if execution of ""useradd"" and ""groupadd"" are audited:

# auditctl -l | egrep '(useradd|groupadd)'

If either ""useradd"" or ""groupadd"" are not listed with a permissions filter
of at least ""x"", this is a finding.

Determine if execution of the ""passwd"" executable is audited:

# auditctl -l | grep “/usr/bin/passwd”

If ""/usr/bin/passwd"" is not listed with a permissions filter of at least
""x"", this is a finding.

Determine if /etc/passwd, /etc/shadow, /etc/group, and /etc/security/opasswd
are audited for writing:

# auditctl -l | egrep
'(/etc/passwd|/etc/shadow|/etc/group|/etc/security/opasswd)'

If any of these are not listed with a permissions filter of at least ""w"",
this is a finding.","Configure ""execute"" auditing of the ""usermod"" and
""groupmod"" executables. Add the following to the /etc/audit/audit.rules file:

-w /usr/sbin/usermod -p x -k usermod
-w /usr/sbin/groupmod -p x -k groupmod

Configure ""execute"" auditing of the ""userdel"" and ""groupdel"" executables.
Add the following to the /etc/audit/audit.rules file:

-w /usr/sbin/userdel -p x -k userdel
-w /usr/sbin/groupdel -p x -k groupdel

Configure ""execute"" auditing of the ""useradd"" and ""groupadd"" executables.
Add the following to audit.rules:

-w /usr/sbin/useradd -p x -k useradd
-w /usr/sbin/groupadd -p x -k groupadd

Configure ""execute"" auditing of the ""passwd"" executable. Add the following
to the aud.rules:

-w /usr/bin/passwd -p x -k passwd

Configure ""write"" auditing of the ""passwd"", ""shadow"", ""group"", and
""opasswd"" files. Add the following to the /etc/audit/audit.rules file:

-w /etc/passwd -p wa -k passwd
-w /etc/shadow -p wa -k shadow
-w /etc/group -p wa -k group
-w /etc/security/opasswd -p wa -k opasswd

Restart the auditd service:

# service auditd restart","control ""V-89777"" do
  title ""The SLES for vRealize must notify System Administrators and
Information System Security Officers when accounts are created, or enabled when
previously disabled.""
  desc  ""Once an attacker establishes initial access to a system, the attacker
often attempts to create a persistent method of reestablishing access. One way
to accomplish this is for the attacker to simply enable a new or disabled
account. Notification of account enabling is one method for mitigating this
risk. A comprehensive account management process will ensure an audit trail,
which documents the creation of operating system user accounts and notifies
System Administrators and Information System Security Officers (ISSO) that it
exists. Such a process greatly reduces the risk that accounts will be
surreptitiously enabled and provides logging that can be used for forensic
purposes.

    In order to detect and respond to events that affect user accessibility and
application processing, operating systems must audit account enabling actions
and, as required, notify the appropriate individuals so they can investigate
the event.

    To address access requirements, many operating systems can be integrated
with enterprise-level authentication/access/auditing mechanisms that meet or
exceed access control policy requirements.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000304-GPOS-00121""
  tag ""gid"": ""V-89777""
  tag ""rid"": ""SV-100427r1_rule""
  tag ""stig_id"": ""VRAU-SL-001000""
  tag ""fix_id"": ""F-96519r1_fix""
  tag ""cci"": [""CCI-002132""]
  tag ""nist"": [""AC-2 (4)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Determine if execution of the \""usermod\"" and \""groupmod\""
executable are audited:

# auditctl -l | egrep '(usermod|groupmod)'

If either \""usermod\"" or \""groupmod\"" are not listed with a permissions filter
of at least \""x\"", this is a finding.

Determine if execution of the \""userdel\"" and \""groupdel\"" executable are
audited:

# auditctl -l | egrep '(userdel|groupdel)'

If either \""userdel\"" or \""groupdel\"" are not listed with a permissions filter
of at least \""x\"", this is a finding.

Determine if execution of \""useradd\"" and \""groupadd\"" are audited:

# auditctl -l | egrep '(useradd|groupadd)'

If either \""useradd\"" or \""groupadd\"" are not listed with a permissions filter
of at least \""x\"", this is a finding.

Determine if execution of the \""passwd\"" executable is audited:

# auditctl -l | grep “/usr/bin/passwd”

If \""/usr/bin/passwd\"" is not listed with a permissions filter of at least
\""x\"", this is a finding.

Determine if /etc/passwd, /etc/shadow, /etc/group, and /etc/security/opasswd
are audited for writing:

# auditctl -l | egrep
'(/etc/passwd|/etc/shadow|/etc/group|/etc/security/opasswd)'

If any of these are not listed with a permissions filter of at least \""w\"",
this is a finding.""
  tag ""fix"": ""Configure \""execute\"" auditing of the \""usermod\"" and
\""groupmod\"" executables. Add the following to the /etc/audit/audit.rules file:

-w /usr/sbin/usermod -p x -k usermod
-w /usr/sbin/groupmod -p x -k groupmod

Configure \""execute\"" auditing of the \""userdel\"" and \""groupdel\"" executables.
Add the following to the /etc/audit/audit.rules file:

-w /usr/sbin/userdel -p x -k userdel
-w /usr/sbin/groupdel -p x -k groupdel

Configure \""execute\"" auditing of the \""useradd\"" and \""groupadd\"" executables.
Add the following to audit.rules:

-w /usr/sbin/useradd -p x -k useradd
-w /usr/sbin/groupadd -p x -k groupadd

Configure \""execute\"" auditing of the \""passwd\"" executable. Add the following
to the aud.rules:

-w /usr/bin/passwd -p x -k passwd

Configure \""write\"" auditing of the \""passwd\"", \""shadow\"", \""group\"", and
\""opasswd\"" files. Add the following to the /etc/audit/audit.rules file:

-w /etc/passwd -p wa -k passwd
-w /etc/shadow -p wa -k shadow
-w /etc/group -p wa -k group
-w /etc/security/opasswd -p wa -k opasswd

Restart the auditd service:

# service auditd restart""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89777.rb""}","","","","",""
V-89779,"The SLES for vRealize must audit the execution of privileged
functions.","Misuse of privileged functions, either intentionally or
unintentionally by authorized users, or by unauthorized external entities that
have compromised information system accounts, is a serious and ongoing concern
and can have significant adverse impacts on organizations. Auditing the use of
privileged functions is one way to detect such misuse and identify the risk
from insider threats and the advanced persistent threat.","[{""label""=>""default"", ""data""=>""Misuse of privileged functions, either intentionally or\nunintentionally by authorized users, or by unauthorized external entities that\nhave compromised information system accounts, is a serious and ongoing concern\nand can have significant adverse impacts on organizations. Auditing the use of\nprivileged functions is one way to detect such misuse and identify the risk\nfrom insider threats and the advanced persistent threat.""}]",0.3,[],"",SRG-OS-000327-GPOS-00127,V-89779,SV-100429r1_rule,VRAU-SL-001030,F-96521r1_fix,"[""CCI-002234""]","[""AC-6 (9)"", ""Rev_4""]","","","","","","","","","","","To verify that auditing of privileged command use is
configured, run the following command to find relevant setuid programs:

# find / -xdev -type f -perm -4000 -o -perm -2000 2>/dev/null

Run the following command to verify entries in the audit rules for all programs
found with the previous command:

# grep path /etc/audit/audit.rules

It should be the case that all relevant setuid programs have a line in the
audit rules.

If it is not the case, this is a finding.","At a minimum, the audit system should collect the execution of
privileged commands for all users and ""root"". To find the relevant setuid
programs:

# find / -xdev -type f -perm -4000 -o -perm -2000 2>/dev/null

Then, for each setuid program on the system, add a line of the following form
to ""/etc/audit/audit.rules"", where [SETUID_PROG_PATH] is the full path to
each setuid program in the list:

-a always,exit -F path=[SETUID_PROG_PATH] -F perm=x -F auid>=500 -k privileged

OR

# /etc/dodscript.sh","control ""V-89779"" do
  title ""The SLES for vRealize must audit the execution of privileged
functions.""
  desc  ""Misuse of privileged functions, either intentionally or
unintentionally by authorized users, or by unauthorized external entities that
have compromised information system accounts, is a serious and ongoing concern
and can have significant adverse impacts on organizations. Auditing the use of
privileged functions is one way to detect such misuse and identify the risk
from insider threats and the advanced persistent threat.""
  impact 0.3
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000327-GPOS-00127""
  tag ""gid"": ""V-89779""
  tag ""rid"": ""SV-100429r1_rule""
  tag ""stig_id"": ""VRAU-SL-001030""
  tag ""fix_id"": ""F-96521r1_fix""
  tag ""cci"": [""CCI-002234""]
  tag ""nist"": [""AC-6 (9)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To verify that auditing of privileged command use is
configured, run the following command to find relevant setuid programs:

# find / -xdev -type f -perm -4000 -o -perm -2000 2>/dev/null

Run the following command to verify entries in the audit rules for all programs
found with the previous command:

# grep path /etc/audit/audit.rules

It should be the case that all relevant setuid programs have a line in the
audit rules.

If it is not the case, this is a finding.""
  tag ""fix"": ""At a minimum, the audit system should collect the execution of
privileged commands for all users and \""root\"". To find the relevant setuid
programs:

# find / -xdev -type f -perm -4000 -o -perm -2000 2>/dev/null

Then, for each setuid program on the system, add a line of the following form
to \""/etc/audit/audit.rules\"", where [SETUID_PROG_PATH] is the full path to
each setuid program in the list:

-a always,exit -F path=[SETUID_PROG_PATH] -F perm=x -F auid>=500 -k privileged

OR

# /etc/dodscript.sh""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89779.rb""}","","","","",""
V-89781,"The SLES for vRealize must automatically lock an account until the
locked account is released by an administrator when three unsuccessful logon
attempts in 15 minutes occur.","By limiting the number of failed logon attempts, the risk of
unauthorized system access via user password guessing, otherwise known as
brute-forcing, is reduced. Limits are imposed by locking the account.","[{""label""=>""default"", ""data""=>""By limiting the number of failed logon attempts, the risk of\nunauthorized system access via user password guessing, otherwise known as\nbrute-forcing, is reduced. Limits are imposed by locking the account.""}]",0.3,[],"",SRG-OS-000329-GPOS-00128,V-89781,SV-100431r1_rule,VRAU-SL-001035,F-96523r1_fix,"[""CCI-002238""]","[""AC-7 b"", ""Rev_4""]","","","","","","","","","","","Check the ""pam_tally2"" configuration:

# more /etc/pam.d/common-auth

Confirm the following line is configured:

auth required pam_tally2.so deny=3 onerr=fail even_deny_root unlock_time=86400
root_unlock_time=300

# more /etc/pam.d/common-account

Confirm the following line is configured:

account required pam_tally2.so

If no such lines are found, this is a finding.","Edit ""/etc/pam.d/common-auth"" and add the following line:

auth required pam_tally2.so deny=3 onerr=fail even_deny_root unlock_time=86400
root_unlock_time=300

Edit ""/etc/pam.d/common-account"" and add the following line:

account required pam_tally2.so","control ""V-89781"" do
  title ""The SLES for vRealize must automatically lock an account until the
locked account is released by an administrator when three unsuccessful logon
attempts in 15 minutes occur.""
  desc  ""By limiting the number of failed logon attempts, the risk of
unauthorized system access via user password guessing, otherwise known as
brute-forcing, is reduced. Limits are imposed by locking the account.""
  impact 0.3
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000329-GPOS-00128""
  tag ""gid"": ""V-89781""
  tag ""rid"": ""SV-100431r1_rule""
  tag ""stig_id"": ""VRAU-SL-001035""
  tag ""fix_id"": ""F-96523r1_fix""
  tag ""cci"": [""CCI-002238""]
  tag ""nist"": [""AC-7 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the \""pam_tally2\"" configuration:

# more /etc/pam.d/common-auth

Confirm the following line is configured:

auth required pam_tally2.so deny=3 onerr=fail even_deny_root unlock_time=86400
root_unlock_time=300

# more /etc/pam.d/common-account

Confirm the following line is configured:

account required pam_tally2.so

If no such lines are found, this is a finding.""
  tag ""fix"": ""Edit \""/etc/pam.d/common-auth\"" and add the following line:

auth required pam_tally2.so deny=3 onerr=fail even_deny_root unlock_time=86400
root_unlock_time=300

Edit \""/etc/pam.d/common-account\"" and add the following line:

account required pam_tally2.so""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89781.rb""}","","","","",""
V-89783,"The SLES for vRealize must off-load audit records onto a different
system or media from the system being audited.","Information stored in one location is vulnerable to accidental or
incidental deletion or alteration.

    Off-loading is a common process in information systems with limited audit
storage capacity.","[{""label""=>""default"", ""data""=>""Information stored in one location is vulnerable to accidental or\nincidental deletion or alteration.\n\n    Off-loading is a common process in information systems with limited audit\nstorage capacity.""}]",0.3,[],"",SRG-OS-000342-GPOS-00133,V-89783,SV-100433r1_rule,VRAU-SL-001060,F-96525r1_fix,"[""CCI-001851""]","[""AU-4 (1)"", ""Rev_4""]","","","","","","","","","","","Check the syslog configuration file for remote syslog servers:

# cat /etc/syslog-ng/syslog-ng.conf | grep logserver

If no line is returned, or ""logserver"" is commented out, this is a finding.","Edit the syslog configuration file and add an appropriate remote
syslog server:

In the /etc/syslog-ng/syslog-ng.conf file, the remote logging entries must be
uncommented and the IP address must be modified to point to the remote syslog
server:

#
# Enable this and adopt IP to send log messages to a log server.
#
destination logserver { udp(""x.x.x.x"" port(514)); };
log { source(src); destination(logserver); };

Note: Replace x.x.x.x with the appropriate IP address.","control ""V-89783"" do
  title ""The SLES for vRealize must off-load audit records onto a different
system or media from the system being audited.""
  desc  ""Information stored in one location is vulnerable to accidental or
incidental deletion or alteration.

    Off-loading is a common process in information systems with limited audit
storage capacity.
  ""
  impact 0.3
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000342-GPOS-00133""
  tag ""gid"": ""V-89783""
  tag ""rid"": ""SV-100433r1_rule""
  tag ""stig_id"": ""VRAU-SL-001060""
  tag ""fix_id"": ""F-96525r1_fix""
  tag ""cci"": [""CCI-001851""]
  tag ""nist"": [""AU-4 (1)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the syslog configuration file for remote syslog servers:

# cat /etc/syslog-ng/syslog-ng.conf | grep logserver

If no line is returned, or \""logserver\"" is commented out, this is a finding.""
  tag ""fix"": ""Edit the syslog configuration file and add an appropriate remote
syslog server:

In the /etc/syslog-ng/syslog-ng.conf file, the remote logging entries must be
uncommented and the IP address must be modified to point to the remote syslog
server:

#
# Enable this and adopt IP to send log messages to a log server.
#
destination logserver { udp(\""x.x.x.x\"" port(514)); };
log { source(src); destination(logserver); };

Note: Replace x.x.x.x with the appropriate IP address.""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89783.rb""}","","","","",""
V-89785,"The SLES for vRealize must immediately notify the SA and ISSO (at a
minimum) when allocated audit record storage volume reaches 75% of the
repository maximum audit record storage capacity.","If security personnel are not notified immediately when storage volume
reaches 75% utilization, they are unable to plan for audit record storage
capacity expansion.","[{""label""=>""default"", ""data""=>""If security personnel are not notified immediately when storage volume\nreaches 75% utilization, they are unable to plan for audit record storage\ncapacity expansion.""}]",0.5,[],"",SRG-OS-000343-GPOS-00134,V-89785,SV-100435r1_rule,VRAU-SL-001065,F-96527r1_fix,"[""CCI-001855""]","[""AU-5 (1)"", ""Rev_4""]","","","","","","","","","","","Check ""/etc/audit/auditd.conf"" for the"" space_left_action""
with the following command:

# cat /etc/audit/auditd.conf | grep space_left_action

If the ""space_left_action"" parameter is missing, set to ""ignore"", set to
""suspend"", set to ""single"", set to ""halt"", or is blank, this is a finding.

Expected Result:
space_left_action = SYSLOG

NOTES:
If the space_left_action is set to ""exec"" the system executes a designated
script. If this script informs the SA of the event, this is not a finding.

If the space_left_action is set to ""email"" and the ""action_mail_acct""
parameter is not set to the email address of the system administrator, this is
a finding.

The ""action_mail_acct parameter"", if missing, defaults to ""root"". Note that
if the email address of the system administrator is on a remote system
""sendmail"" must be available.","Set the ""space_left_action"" parameter to the valid setting
""SYSLOG"",  by running the following command:

# sed -i ""/^[^#]*space_left_action/ c\admin_space_left_action = SYSLOG""
/etc/audit/auditd.conf

Restart the audit service:

# service auditd restart","control ""V-89785"" do
  title ""The SLES for vRealize must immediately notify the SA and ISSO (at a
minimum) when allocated audit record storage volume reaches 75% of the
repository maximum audit record storage capacity.""
  desc  ""If security personnel are not notified immediately when storage volume
reaches 75% utilization, they are unable to plan for audit record storage
capacity expansion.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000343-GPOS-00134""
  tag ""gid"": ""V-89785""
  tag ""rid"": ""SV-100435r1_rule""
  tag ""stig_id"": ""VRAU-SL-001065""
  tag ""fix_id"": ""F-96527r1_fix""
  tag ""cci"": [""CCI-001855""]
  tag ""nist"": [""AU-5 (1)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check \""/etc/audit/auditd.conf\"" for the\"" space_left_action\""
with the following command:

# cat /etc/audit/auditd.conf | grep space_left_action

If the \""space_left_action\"" parameter is missing, set to \""ignore\"", set to
\""suspend\"", set to \""single\"", set to \""halt\"", or is blank, this is a finding.

Expected Result:
space_left_action = SYSLOG

NOTES:
If the space_left_action is set to \""exec\"" the system executes a designated
script. If this script informs the SA of the event, this is not a finding.

If the space_left_action is set to \""email\"" and the \""action_mail_acct\""
parameter is not set to the email address of the system administrator, this is
a finding.

The \""action_mail_acct parameter\"", if missing, defaults to \""root\"". Note that
if the email address of the system administrator is on a remote system
\""sendmail\"" must be available.""
  tag ""fix"": ""Set the \""space_left_action\"" parameter to the valid setting
\""SYSLOG\"",  by running the following command:

# sed -i \""/^[^#]*space_left_action/ c\\admin_space_left_action = SYSLOG\""
/etc/audit/auditd.conf

Restart the audit service:

# service auditd restart""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89785.rb""}","","","","",""
V-89787,"The SLES for vRealize must provide an immediate real-time alert to the
SA and ISSO, at a minimum, of all audit failure events requiring real-time
alerts.","It is critical for the appropriate personnel to be aware if a system
is at risk of failing to process audit logs as required. Without a real-time
alert, security personnel may be unaware of an impending failure of the audit
capability and system operation may be adversely affected.

    Alerts provide organizations with urgent messages. Real-time alerts provide
these messages immediately (i.e., the time from event detection to alert occurs
in seconds or less).","[{""label""=>""default"", ""data""=>""It is critical for the appropriate personnel to be aware if a system\nis at risk of failing to process audit logs as required. Without a real-time\nalert, security personnel may be unaware of an impending failure of the audit\ncapability and system operation may be adversely affected.\n\n    Alerts provide organizations with urgent messages. Real-time alerts provide\nthese messages immediately (i.e., the time from event detection to alert occurs\nin seconds or less).""}]",0.5,[],"",SRG-OS-000344-GPOS-00135,V-89787,SV-100437r1_rule,VRAU-SL-001070,F-96529r1_fix,"[""CCI-001858""]","[""AU-5 (2)"", ""Rev_4""]","","","","","","","","","","","Check ""/etc/audit/auditd.conf"" for the ""space_left_action""
with the following command:

# cat /etc/audit/auditd.conf | grep space_left_action

If the ""space_left_action"" parameter is missing, set to ""ignore"", set to
""suspend"", set to ""single"", set to ""halt"", or is blank, this is a finding.

Expected Result:
space_left_action = SYSLOG

NOTES:
If the ""space_left_action"" is set to ""exec"" the system executes a
designated script. If this script informs the SA of the event, this is not a
finding.

If the ""space_left_action"" is set to ""email"" and the ""action_mail_acct""
parameter is not set to the email address of the system administrator, this is
a finding.

The ""action_mail_acct parameter"", if missing, defaults to ""root"". Note that
if the email address of the system administrator is on a remote system
""sendmail"" must be available.","Set the ""space_left_action"" parameter to the valid setting
""SYSLOG"",  by running the following command:

# sed -i ""/^[^#]*space_left_action/ c\admin_space_left_action = SYSLOG""
/etc/audit/auditd.conf

Restart the audit service:

# service auditd restart","control ""V-89787"" do
  title ""The SLES for vRealize must provide an immediate real-time alert to the
SA and ISSO, at a minimum, of all audit failure events requiring real-time
alerts.""
  desc  ""It is critical for the appropriate personnel to be aware if a system
is at risk of failing to process audit logs as required. Without a real-time
alert, security personnel may be unaware of an impending failure of the audit
capability and system operation may be adversely affected.

    Alerts provide organizations with urgent messages. Real-time alerts provide
these messages immediately (i.e., the time from event detection to alert occurs
in seconds or less).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000344-GPOS-00135""
  tag ""gid"": ""V-89787""
  tag ""rid"": ""SV-100437r1_rule""
  tag ""stig_id"": ""VRAU-SL-001070""
  tag ""fix_id"": ""F-96529r1_fix""
  tag ""cci"": [""CCI-001858""]
  tag ""nist"": [""AU-5 (2)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check \""/etc/audit/auditd.conf\"" for the \""space_left_action\""
with the following command:

# cat /etc/audit/auditd.conf | grep space_left_action

If the \""space_left_action\"" parameter is missing, set to \""ignore\"", set to
\""suspend\"", set to \""single\"", set to \""halt\"", or is blank, this is a finding.

Expected Result:
space_left_action = SYSLOG

NOTES:
If the \""space_left_action\"" is set to \""exec\"" the system executes a
designated script. If this script informs the SA of the event, this is not a
finding.

If the \""space_left_action\"" is set to \""email\"" and the \""action_mail_acct\""
parameter is not set to the email address of the system administrator, this is
a finding.

The \""action_mail_acct parameter\"", if missing, defaults to \""root\"". Note that
if the email address of the system administrator is on a remote system
\""sendmail\"" must be available.""
  tag ""fix"": ""Set the \""space_left_action\"" parameter to the valid setting
\""SYSLOG\"",  by running the following command:

# sed -i \""/^[^#]*space_left_action/ c\\admin_space_left_action = SYSLOG\""
/etc/audit/auditd.conf

Restart the audit service:

# service auditd restart""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89787.rb""}","","","","",""
V-89789,"The SLES for vRealize must, for networked systems, compare internal
information system clocks at least every 24 hours with a server which is
synchronized to one of the redundant United States Naval Observatory (USNO)
time servers, or a time server designated for the appropriate DoD network
(NIPRNet/SIPRNet), and/or the Global Positioning System (GPS).","Inaccurate time stamps make it more difficult to correlate events and
can lead to an inaccurate analysis. Determining the correct time a particular
event occurred on a system is critical when conducting forensic analysis and
investigating system events. Sources outside the configured acceptable
allowance (drift) may be inaccurate.

    Synchronizing internal information system clocks provides uniformity of
time stamps for information systems with multiple system clocks and systems
connected over a network.

    Organizations should consider endpoints that may not have regular access to
the authoritative time server (e.g., mobile, teleworking, and tactical
endpoints).","[{""label""=>""default"", ""data""=>""Inaccurate time stamps make it more difficult to correlate events and\ncan lead to an inaccurate analysis. Determining the correct time a particular\nevent occurred on a system is critical when conducting forensic analysis and\ninvestigating system events. Sources outside the configured acceptable\nallowance (drift) may be inaccurate.\n\n    Synchronizing internal information system clocks provides uniformity of\ntime stamps for information systems with multiple system clocks and systems\nconnected over a network.\n\n    Organizations should consider endpoints that may not have regular access to\nthe authoritative time server (e.g., mobile, teleworking, and tactical\nendpoints).""}]",0.5,[],"",SRG-OS-000355-GPOS-00143,V-89789,SV-100439r1_rule,VRAU-SL-001110,F-96531r1_fix,"[""CCI-001891""]","[""AU-8 (1) (a)"", ""Rev_4""]","","","","","","","","","","","A remote NTP server should be configured for time
synchronization. To verify one is configured, open the following file:

# cat /etc/ntp.conf | grep server | grep -v '^#'
# cat /etc/ntp.conf | grep peer | grep -v '^#'
# cat /etc/ntp.conf | grep multicastclient | grep -v '^#'

Confirm the servers and peers or multicastclient (as applicable) are local or
an authoritative U.S. DoD source.

If a non-local/non-authoritative time-server is used, this is a finding.","To specify a remote NTP server for time synchronization, edit the
file ""/etc/ntp.conf"". Add or correct the following lines, substituting the IP
or hostname of a remote NTP server for ""ntpserver"" by using the following
command:

# echo ""server [ntpserver]"" >> /etc/ntp.conf

Replace [ntpserver] with one of the USNO time servers. This instructs the NTP
software to contact that remote server to obtain time data.

Restart the service with:

# service ntp restart","control ""V-89789"" do
  title ""The SLES for vRealize must, for networked systems, compare internal
information system clocks at least every 24 hours with a server which is
synchronized to one of the redundant United States Naval Observatory (USNO)
time servers, or a time server designated for the appropriate DoD network
(NIPRNet/SIPRNet), and/or the Global Positioning System (GPS).""
  desc  ""Inaccurate time stamps make it more difficult to correlate events and
can lead to an inaccurate analysis. Determining the correct time a particular
event occurred on a system is critical when conducting forensic analysis and
investigating system events. Sources outside the configured acceptable
allowance (drift) may be inaccurate.

    Synchronizing internal information system clocks provides uniformity of
time stamps for information systems with multiple system clocks and systems
connected over a network.

    Organizations should consider endpoints that may not have regular access to
the authoritative time server (e.g., mobile, teleworking, and tactical
endpoints).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000355-GPOS-00143""
  tag ""gid"": ""V-89789""
  tag ""rid"": ""SV-100439r1_rule""
  tag ""stig_id"": ""VRAU-SL-001110""
  tag ""fix_id"": ""F-96531r1_fix""
  tag ""cci"": [""CCI-001891""]
  tag ""nist"": [""AU-8 (1) (a)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""A remote NTP server should be configured for time
synchronization. To verify one is configured, open the following file:

# cat /etc/ntp.conf | grep server | grep -v '^#'
# cat /etc/ntp.conf | grep peer | grep -v '^#'
# cat /etc/ntp.conf | grep multicastclient | grep -v '^#'

Confirm the servers and peers or multicastclient (as applicable) are local or
an authoritative U.S. DoD source.

If a non-local/non-authoritative time-server is used, this is a finding.""
  tag ""fix"": ""To specify a remote NTP server for time synchronization, edit the
file \""/etc/ntp.conf\"". Add or correct the following lines, substituting the IP
or hostname of a remote NTP server for \""ntpserver\"" by using the following
command:

# echo \""server [ntpserver]\"" >> /etc/ntp.conf

Replace [ntpserver] with one of the USNO time servers. This instructs the NTP
software to contact that remote server to obtain time data.

Restart the service with:

# service ntp restart""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89789.rb""}","","","","",""
V-89791,"The time synchronization configuration file (such as /etc/ntp.conf)
must be owned by root.","A synchronized system clock is critical for the enforcement of
time-based policies and the correlation of logs and audit records with other
systems. If an illicit time source is used for synchronization, the integrity
of system logs and the security of the system could be compromised. If the
configuration files controlling time synchronization are not owned by a system
account, unauthorized modifications could result in the failure of time
synchronization.","[{""label""=>""default"", ""data""=>""A synchronized system clock is critical for the enforcement of\ntime-based policies and the correlation of logs and audit records with other\nsystems. If an illicit time source is used for synchronization, the integrity\nof system logs and the security of the system could be compromised. If the\nconfiguration files controlling time synchronization are not owned by a system\naccount, unauthorized modifications could result in the failure of time\nsynchronization.""}]",0.5,[],"",SRG-OS-000355-GPOS-00143,V-89791,SV-100441r1_rule,VRAU-SL-001115,F-96533r1_fix,"[""CCI-001891""]","[""AU-8 (1) (a)"", ""Rev_4""]","","","","","","","","","","","Check the ownership of the NTP configuration file:

# ls -l /etc/ntp.conf

If the owner is not ""root"", this is a finding.","Change the owner of the NTP configuration file:

# chown root /etc/ntp.conf","control ""V-89791"" do
  title ""The time synchronization configuration file (such as /etc/ntp.conf)
must be owned by root.""
  desc  ""A synchronized system clock is critical for the enforcement of
time-based policies and the correlation of logs and audit records with other
systems. If an illicit time source is used for synchronization, the integrity
of system logs and the security of the system could be compromised. If the
configuration files controlling time synchronization are not owned by a system
account, unauthorized modifications could result in the failure of time
synchronization.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000355-GPOS-00143""
  tag ""gid"": ""V-89791""
  tag ""rid"": ""SV-100441r1_rule""
  tag ""stig_id"": ""VRAU-SL-001115""
  tag ""fix_id"": ""F-96533r1_fix""
  tag ""cci"": [""CCI-001891""]
  tag ""nist"": [""AU-8 (1) (a)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the ownership of the NTP configuration file:

# ls -l /etc/ntp.conf

If the owner is not \""root\"", this is a finding.""
  tag ""fix"": ""Change the owner of the NTP configuration file:

# chown root /etc/ntp.conf""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89791.rb""}","","","","",""
V-89793,"The time synchronization configuration file (such as /etc/ntp.conf)
must be group-owned by root, bin, sys, or system.","A synchronized system clock is critical for the enforcement of
time-based policies and the correlation of logs and audit records with other
systems. If an illicit time source is used for synchronization, the integrity
of system logs and the security of the system could be compromised. If the
configuration files controlling time synchronization are not owned by a system
group, unauthorized modifications could result in the failure of time
synchronization.","[{""label""=>""default"", ""data""=>""A synchronized system clock is critical for the enforcement of\ntime-based policies and the correlation of logs and audit records with other\nsystems. If an illicit time source is used for synchronization, the integrity\nof system logs and the security of the system could be compromised. If the\nconfiguration files controlling time synchronization are not owned by a system\ngroup, unauthorized modifications could result in the failure of time\nsynchronization.""}]",0.5,[],"",SRG-OS-000355-GPOS-00143,V-89793,SV-100443r1_rule,VRAU-SL-001120,F-96535r1_fix,"[""CCI-001891""]","[""AU-8 (1) (a)"", ""Rev_4""]","","","","","","","","","","","Check the group-ownership of the NTP configuration file:

# ls -lL /etc/ntp.conf

If the group-owner is not ""root"", ""bin"", ""sys"", or ""system"", this is a
finding.","Change the group-owner of the NTP configuration file:

# chgrp root /etc/ntp.conf","control ""V-89793"" do
  title ""The time synchronization configuration file (such as /etc/ntp.conf)
must be group-owned by root, bin, sys, or system.""
  desc  ""A synchronized system clock is critical for the enforcement of
time-based policies and the correlation of logs and audit records with other
systems. If an illicit time source is used for synchronization, the integrity
of system logs and the security of the system could be compromised. If the
configuration files controlling time synchronization are not owned by a system
group, unauthorized modifications could result in the failure of time
synchronization.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000355-GPOS-00143""
  tag ""gid"": ""V-89793""
  tag ""rid"": ""SV-100443r1_rule""
  tag ""stig_id"": ""VRAU-SL-001120""
  tag ""fix_id"": ""F-96535r1_fix""
  tag ""cci"": [""CCI-001891""]
  tag ""nist"": [""AU-8 (1) (a)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the group-ownership of the NTP configuration file:

# ls -lL /etc/ntp.conf

If the group-owner is not \""root\"", \""bin\"", \""sys\"", or \""system\"", this is a
finding.""
  tag ""fix"": ""Change the group-owner of the NTP configuration file:

# chgrp root /etc/ntp.conf""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89793.rb""}","","","","",""
V-89795,"The time synchronization configuration file (such as /etc/ntp.conf)
must have mode 0640 or less permissive.","A synchronized system clock is critical for the enforcement of
time-based policies and the correlation of logs and audit records with other
systems. If an illicit time source is used for synchronization, the integrity
of system logs and the security of the system could be compromised. If the
configuration files controlling time synchronization are not protected,
unauthorized modifications could result in the failure of time synchronization.","[{""label""=>""default"", ""data""=>""A synchronized system clock is critical for the enforcement of\ntime-based policies and the correlation of logs and audit records with other\nsystems. If an illicit time source is used for synchronization, the integrity\nof system logs and the security of the system could be compromised. If the\nconfiguration files controlling time synchronization are not protected,\nunauthorized modifications could result in the failure of time synchronization.""}]",0.5,[],"",SRG-OS-000355-GPOS-00143,V-89795,SV-100445r1_rule,VRAU-SL-001125,F-96537r1_fix,"[""CCI-001891""]","[""AU-8 (1) (a)"", ""Rev_4""]","","","","","","","","","","","Check that the mode for the NTP configuration file is not more
permissive than ""0640"":

# ls -l /etc/ntp.conf

If the mode is more permissive than ""0640"", this is a finding.","Change the mode of the NTP configuration file to ""0640"" or less
permissive:

# chmod 0640 /etc/ntp.conf","control ""V-89795"" do
  title ""The time synchronization configuration file (such as /etc/ntp.conf)
must have mode 0640 or less permissive.""
  desc  ""A synchronized system clock is critical for the enforcement of
time-based policies and the correlation of logs and audit records with other
systems. If an illicit time source is used for synchronization, the integrity
of system logs and the security of the system could be compromised. If the
configuration files controlling time synchronization are not protected,
unauthorized modifications could result in the failure of time synchronization.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000355-GPOS-00143""
  tag ""gid"": ""V-89795""
  tag ""rid"": ""SV-100445r1_rule""
  tag ""stig_id"": ""VRAU-SL-001125""
  tag ""fix_id"": ""F-96537r1_fix""
  tag ""cci"": [""CCI-001891""]
  tag ""nist"": [""AU-8 (1) (a)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check that the mode for the NTP configuration file is not more
permissive than \""0640\"":

# ls -l /etc/ntp.conf

If the mode is more permissive than \""0640\"", this is a finding.""
  tag ""fix"": ""Change the mode of the NTP configuration file to \""0640\"" or less
permissive:

# chmod 0640 /etc/ntp.conf""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89795.rb""}","","","","",""
V-89797,"The SLES for vRealize must synchronize internal information system
clocks to the authoritative time source when the time difference is greater
than one second.","Inaccurate time stamps make it more difficult to correlate events and
can lead to an inaccurate analysis. Determining the correct time a particular
event occurred on a system is critical when conducting forensic analysis and
investigating system events.

    Synchronizing internal information system clocks provides uniformity of
time stamps for information systems with multiple system clocks and systems
connected over a network. Organizations should consider setting time periods
for different types of systems (e.g., financial, legal, or mission-critical
systems).

    Organizations should also consider endpoints that may not have regular
access to the authoritative time server (e.g., mobile, teleworking, and
tactical endpoints). This requirement is related to the comparison done every
24 hours in SRG-OS-000355 because a comparison must be done in order to
determine the time difference.","[{""label""=>""default"", ""data""=>""Inaccurate time stamps make it more difficult to correlate events and\ncan lead to an inaccurate analysis. Determining the correct time a particular\nevent occurred on a system is critical when conducting forensic analysis and\ninvestigating system events.\n\n    Synchronizing internal information system clocks provides uniformity of\ntime stamps for information systems with multiple system clocks and systems\nconnected over a network. Organizations should consider setting time periods\nfor different types of systems (e.g., financial, legal, or mission-critical\nsystems).\n\n    Organizations should also consider endpoints that may not have regular\naccess to the authoritative time server (e.g., mobile, teleworking, and\ntactical endpoints). This requirement is related to the comparison done every\n24 hours in SRG-OS-000355 because a comparison must be done in order to\ndetermine the time difference.""}]",0.5,[],"",SRG-OS-000356-GPOS-00144,V-89797,SV-100447r1_rule,VRAU-SL-001130,F-96539r2_fix,"[""CCI-002046""]","[""AU-8 (1) (b)"", ""Rev_4""]","","","","","","","","","","","Run the following command to determine the current status of
the ""ntpd"" service:

# service ntp status

If the service is configured, the command should show a list of the ntp servers
and the status of the synchronization.

If it does not, this is a finding.","The ""ntp"" service can be enabled with the following command:

# chkconfig ntp on
# service ntp start

Configure the time server for the authoritative time source with the following
steps:

1. Edit /etc/ntp.conf and locate the ""server"" entry.
2. Replace the address with the address of the authoritative time source.
3. Save the /etc/ntp.conf file.
4. Restart the ntp daemon with /etc/init.d/ntp start.","control ""V-89797"" do
  title ""The SLES for vRealize must synchronize internal information system
clocks to the authoritative time source when the time difference is greater
than one second.""
  desc  ""Inaccurate time stamps make it more difficult to correlate events and
can lead to an inaccurate analysis. Determining the correct time a particular
event occurred on a system is critical when conducting forensic analysis and
investigating system events.

    Synchronizing internal information system clocks provides uniformity of
time stamps for information systems with multiple system clocks and systems
connected over a network. Organizations should consider setting time periods
for different types of systems (e.g., financial, legal, or mission-critical
systems).

    Organizations should also consider endpoints that may not have regular
access to the authoritative time server (e.g., mobile, teleworking, and
tactical endpoints). This requirement is related to the comparison done every
24 hours in SRG-OS-000355 because a comparison must be done in order to
determine the time difference.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000356-GPOS-00144""
  tag ""gid"": ""V-89797""
  tag ""rid"": ""SV-100447r1_rule""
  tag ""stig_id"": ""VRAU-SL-001130""
  tag ""fix_id"": ""F-96539r2_fix""
  tag ""cci"": [""CCI-002046""]
  tag ""nist"": [""AU-8 (1) (b)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Run the following command to determine the current status of
the \""ntpd\"" service:

# service ntp status

If the service is configured, the command should show a list of the ntp servers
and the status of the synchronization.

If it does not, this is a finding.""
  tag ""fix"": ""The \""ntp\"" service can be enabled with the following command:

# chkconfig ntp on
# service ntp start

Configure the time server for the authoritative time source with the following
steps:

1. Edit /etc/ntp.conf and locate the \""server\"" entry.
2. Replace the address with the address of the authoritative time source.
3. Save the /etc/ntp.conf file.
4. Restart the ntp daemon with /etc/init.d/ntp start.""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89797.rb""}","","","","",""
V-89799,"The SLES for vRealize must audit the enforcement actions used to
restrict access associated with changes to the system.","Without auditing the enforcement of access restrictions against
changes to the application configuration, it will be difficult to identify
attempted attacks and an audit trail will not be available for forensic
investigation for after-the-fact actions.

    Enforcement actions are the methods or mechanisms used to prevent
unauthorized changes to configuration settings. Enforcement action methods may
be as simple as denying access to a file based on the application of file
permissions (access restriction). Audit items may consist of lists of actions
blocked by access restrictions or changes identified after the fact.","[{""label""=>""default"", ""data""=>""Without auditing the enforcement of access restrictions against\nchanges to the application configuration, it will be difficult to identify\nattempted attacks and an audit trail will not be available for forensic\ninvestigation for after-the-fact actions.\n\n    Enforcement actions are the methods or mechanisms used to prevent\nunauthorized changes to configuration settings. Enforcement action methods may\nbe as simple as denying access to a file based on the application of file\npermissions (access restriction). Audit items may consist of lists of actions\nblocked by access restrictions or changes identified after the fact.""}]",0.5,[],"",SRG-OS-000365-GPOS-00152,V-89799,SV-100449r1_rule,VRAU-SL-001165,F-96541r1_fix,"[""CCI-001814""]","[""CM-5 (1)"", ""Rev_4""]","","","","","","","","","","","Verify the SLES for vRealize produces audit records by running
the following command to determine the current status of the ""auditd"" service:

# service auditd status

If the service is enabled, the returned message must contain the following text:

Checking for service auditd                running

If the service is not ""running"", this is a finding.","Enable the ""auditd"" service by performing the following
commands:

# chkconfig auditd on
# service auditd start","control ""V-89799"" do
  title ""The SLES for vRealize must audit the enforcement actions used to
restrict access associated with changes to the system.""
  desc  ""Without auditing the enforcement of access restrictions against
changes to the application configuration, it will be difficult to identify
attempted attacks and an audit trail will not be available for forensic
investigation for after-the-fact actions.

    Enforcement actions are the methods or mechanisms used to prevent
unauthorized changes to configuration settings. Enforcement action methods may
be as simple as denying access to a file based on the application of file
permissions (access restriction). Audit items may consist of lists of actions
blocked by access restrictions or changes identified after the fact.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000365-GPOS-00152""
  tag ""gid"": ""V-89799""
  tag ""rid"": ""SV-100449r1_rule""
  tag ""stig_id"": ""VRAU-SL-001165""
  tag ""fix_id"": ""F-96541r1_fix""
  tag ""cci"": [""CCI-001814""]
  tag ""nist"": [""CM-5 (1)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the SLES for vRealize produces audit records by running
the following command to determine the current status of the \""auditd\"" service:

# service auditd status

If the service is enabled, the returned message must contain the following text:

Checking for service auditd                running

If the service is not \""running\"", this is a finding.""
  tag ""fix"": ""Enable the \""auditd\"" service by performing the following
commands:

# chkconfig auditd on
# service auditd start""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89799.rb""}","","","","",""
V-89801,"The RPM package management tool must cryptographically verify the
authenticity of all software packages during installation.","Changes to any software components can have significant effects on the
overall security of the operating system. This requirement ensures the software
has not been tampered with and that it has been provided by a trusted vendor.

    Accordingly, patches, service packs, device drivers, or operating system
components must be signed with a certificate recognized and approved by the
organization.

    Verifying the authenticity of the software prior to installation validates
the integrity of the patch or upgrade received from a vendor. This ensures the
software has not been tampered with and that it has been provided by a trusted
vendor. Self-signed certificates are disallowed by this requirement. The
operating system should not have to verify the software again. This requirement
does not mandate DoD certificates for this purpose; however, the certificate
used to verify the software must be from an approved CA.","[{""label""=>""default"", ""data""=>""Changes to any software components can have significant effects on the\noverall security of the operating system. This requirement ensures the software\nhas not been tampered with and that it has been provided by a trusted vendor.\n\n    Accordingly, patches, service packs, device drivers, or operating system\ncomponents must be signed with a certificate recognized and approved by the\norganization.\n\n    Verifying the authenticity of the software prior to installation validates\nthe integrity of the patch or upgrade received from a vendor. This ensures the\nsoftware has not been tampered with and that it has been provided by a trusted\nvendor. Self-signed certificates are disallowed by this requirement. The\noperating system should not have to verify the software again. This requirement\ndoes not mandate DoD certificates for this purpose; however, the certificate\nused to verify the software must be from an approved CA.""}]",0.5,[],"",SRG-OS-000366-GPOS-00153,V-89801,SV-100451r1_rule,VRAU-SL-001170,F-96543r1_fix,"[""CCI-001749""]","[""CM-5 (3)"", ""Rev_4""]","","","","","","","","","","","Verify RPM signature validation is not disabled:

# grep nosignature /usr/lib/rpm/rpmrc ~root/.rpmrc

The result should either respond with no such file or directory, or an empty
return.

If any configuration is found, this is a finding.","Edit the RPM configuration files containing the ""nosignature""
option and remove the option.","control ""V-89801"" do
  title ""The RPM package management tool must cryptographically verify the
authenticity of all software packages during installation.""
  desc  ""Changes to any software components can have significant effects on the
overall security of the operating system. This requirement ensures the software
has not been tampered with and that it has been provided by a trusted vendor.

    Accordingly, patches, service packs, device drivers, or operating system
components must be signed with a certificate recognized and approved by the
organization.

    Verifying the authenticity of the software prior to installation validates
the integrity of the patch or upgrade received from a vendor. This ensures the
software has not been tampered with and that it has been provided by a trusted
vendor. Self-signed certificates are disallowed by this requirement. The
operating system should not have to verify the software again. This requirement
does not mandate DoD certificates for this purpose; however, the certificate
used to verify the software must be from an approved CA.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000366-GPOS-00153""
  tag ""gid"": ""V-89801""
  tag ""rid"": ""SV-100451r1_rule""
  tag ""stig_id"": ""VRAU-SL-001170""
  tag ""fix_id"": ""F-96543r1_fix""
  tag ""cci"": [""CCI-001749""]
  tag ""nist"": [""CM-5 (3)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify RPM signature validation is not disabled:

# grep nosignature /usr/lib/rpm/rpmrc ~root/.rpmrc

The result should either respond with no such file or directory, or an empty
return.

If any configuration is found, this is a finding.""
  tag ""fix"": ""Edit the RPM configuration files containing the \""nosignature\""
option and remove the option.""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89801.rb""}","","","","",""
V-89803,"The SLES for vRealize must audit all activities performed during
nonlocal maintenance and diagnostic sessions.","If events associated with nonlocal administrative access or diagnostic
sessions are not logged, a major tool for assessing and investigating attacks
would not be available.

    This requirement addresses auditing-related issues associated with
maintenance tools used specifically for diagnostic and repair actions on
organizational information systems.

    Nonlocal maintenance and diagnostic activities are those activities
conducted by individuals communicating through a network, either an external
network (e.g., the Internet) or an internal network. Local maintenance and
diagnostic activities are those activities carried out by individuals
physically present at the information system or information system component
and not communicating across a network connection.

    This requirement applies to hardware/software diagnostic test equipment or
tools. This requirement does not cover hardware/software components that may
support information system maintenance, yet are a part of the system, for
example, the software implementing ""ping,"" ""ls,"" ""ipconfig,"" or the
hardware and software implementing the monitoring port of an Ethernet switch.","[{""label""=>""default"", ""data""=>""If events associated with nonlocal administrative access or diagnostic\nsessions are not logged, a major tool for assessing and investigating attacks\nwould not be available.\n\n    This requirement addresses auditing-related issues associated with\nmaintenance tools used specifically for diagnostic and repair actions on\norganizational information systems.\n\n    Nonlocal maintenance and diagnostic activities are those activities\nconducted by individuals communicating through a network, either an external\nnetwork (e.g., the Internet) or an internal network. Local maintenance and\ndiagnostic activities are those activities carried out by individuals\nphysically present at the information system or information system component\nand not communicating across a network connection.\n\n    This requirement applies to hardware/software diagnostic test equipment or\ntools. This requirement does not cover hardware/software components that may\nsupport information system maintenance, yet are a part of the system, for\nexample, the software implementing \""ping,\"" \""ls,\"" \""ipconfig,\"" or the\nhardware and software implementing the monitoring port of an Ethernet switch.""}]",0.5,[],"",SRG-OS-000392-GPOS-00172,V-89803,SV-100453r1_rule,VRAU-SL-001245,F-96545r1_fix,"[""CCI-002884""]","[""MA-4 (1) (a)"", ""Rev_4""]","","","","","","","","","","","Verify that all commands run by ""root"" are being audited with
the following command:

# cat /etc/audit/audit.rules | grep execve

If the following lines are not displayed, this is a finding.

-a exit,always -F arch=b64 -F euid=0 -S execve
-a exit,always -F arch=b32 -F euid=0 -S execve","Configure the system to log all commands run by ""root"" with the
following command:

# echo ""-a exit,always -F arch=b64 -F euid=0 -S execve"" >>
/etc/audit/audit.rules

# echo ""-a exit,always -F arch=b32 -F euid=0 -S execve"" >>
/etc/audit/audit.rules

Restart the audit service:

# service auditd restart","control ""V-89803"" do
  title ""The SLES for vRealize must audit all activities performed during
nonlocal maintenance and diagnostic sessions.""
  desc  ""If events associated with nonlocal administrative access or diagnostic
sessions are not logged, a major tool for assessing and investigating attacks
would not be available.

    This requirement addresses auditing-related issues associated with
maintenance tools used specifically for diagnostic and repair actions on
organizational information systems.

    Nonlocal maintenance and diagnostic activities are those activities
conducted by individuals communicating through a network, either an external
network (e.g., the Internet) or an internal network. Local maintenance and
diagnostic activities are those activities carried out by individuals
physically present at the information system or information system component
and not communicating across a network connection.

    This requirement applies to hardware/software diagnostic test equipment or
tools. This requirement does not cover hardware/software components that may
support information system maintenance, yet are a part of the system, for
example, the software implementing \""ping,\"" \""ls,\"" \""ipconfig,\"" or the
hardware and software implementing the monitoring port of an Ethernet switch.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000392-GPOS-00172""
  tag ""gid"": ""V-89803""
  tag ""rid"": ""SV-100453r1_rule""
  tag ""stig_id"": ""VRAU-SL-001245""
  tag ""fix_id"": ""F-96545r1_fix""
  tag ""cci"": [""CCI-002884""]
  tag ""nist"": [""MA-4 (1) (a)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify that all commands run by \""root\"" are being audited with
the following command:

# cat /etc/audit/audit.rules | grep execve

If the following lines are not displayed, this is a finding.

-a exit,always -F arch=b64 -F euid=0 -S execve
-a exit,always -F arch=b32 -F euid=0 -S execve""
  tag ""fix"": ""Configure the system to log all commands run by \""root\"" with the
following command:

# echo \""-a exit,always -F arch=b64 -F euid=0 -S execve\"" >>
/etc/audit/audit.rules

# echo \""-a exit,always -F arch=b32 -F euid=0 -S execve\"" >>
/etc/audit/audit.rules

Restart the audit service:

# service auditd restart""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89803.rb""}","","","","",""
V-89805,"The SLES for vRealize must implement cryptographic mechanisms to
protect the integrity of nonlocal maintenance and diagnostic communications,
when used for nonlocal maintenance sessions.","Privileged access contains control and configuration information and
is particularly sensitive, so additional protections are necessary. This is
maintained by using cryptographic mechanisms, such as a hash function or
digital signature, to protect integrity.

    Nonlocal maintenance and diagnostic activities are those activities
conducted by individuals communicating through a network, either an external
network (e.g., the Internet) or an internal network. Local maintenance and
diagnostic activities are those activities carried out by individuals
physically present at the information system or information system component
and not communicating across a network connection.

    The operating system can meet this requirement through leveraging a
cryptographic module. This requirement does not cover hardware/software
components that may support information system maintenance, yet are a part of
the system (e.g., the software implementing ""ping,"" ""ls,"" ""ipconfig,"" or
the hardware and software implementing the monitoring port of an Ethernet
switch).","[{""label""=>""default"", ""data""=>""Privileged access contains control and configuration information and\nis particularly sensitive, so additional protections are necessary. This is\nmaintained by using cryptographic mechanisms, such as a hash function or\ndigital signature, to protect integrity.\n\n    Nonlocal maintenance and diagnostic activities are those activities\nconducted by individuals communicating through a network, either an external\nnetwork (e.g., the Internet) or an internal network. Local maintenance and\ndiagnostic activities are those activities carried out by individuals\nphysically present at the information system or information system component\nand not communicating across a network connection.\n\n    The operating system can meet this requirement through leveraging a\ncryptographic module. This requirement does not cover hardware/software\ncomponents that may support information system maintenance, yet are a part of\nthe system (e.g., the software implementing \""ping,\"" \""ls,\"" \""ipconfig,\"" or\nthe hardware and software implementing the monitoring port of an Ethernet\nswitch).""}]",0.5,[],"",SRG-OS-000393-GPOS-00173,V-89805,SV-100455r1_rule,VRAU-SL-001250,F-96547r2_fix,"[""CCI-002890""]","[""MA-4 (6)"", ""Rev_4""]","","","","","","","","","","","Check the SSH daemon configuration for DoD-approved encryption
to protect the confidentiality of SSH remote connections by performing the
following commands:

Check the ""Ciphers"" setting in the ""sshd_config"" file.

# grep -i Ciphers /etc/ssh/sshd_config  | grep -v '#'

The output must contain either nothing or any number of the following
algorithms:

aes128-ctr, aes256-ctr.

If the output contains an algorithm not listed above, this is a finding.

Expected Output:
Ciphers aes256-ctr,aes128-ctr","Update the ""Ciphers"" directive with the following command:

# sed -i '/^[^#]*Ciphers/ c\Ciphers aes256-ctr,aes128-ctr' /etc/ssh/sshd_config

Save and close the file.

Restart the sshd process:

# service sshd restart","control ""V-89805"" do
  title ""The SLES for vRealize must implement cryptographic mechanisms to
protect the integrity of nonlocal maintenance and diagnostic communications,
when used for nonlocal maintenance sessions.""
  desc  ""Privileged access contains control and configuration information and
is particularly sensitive, so additional protections are necessary. This is
maintained by using cryptographic mechanisms, such as a hash function or
digital signature, to protect integrity.

    Nonlocal maintenance and diagnostic activities are those activities
conducted by individuals communicating through a network, either an external
network (e.g., the Internet) or an internal network. Local maintenance and
diagnostic activities are those activities carried out by individuals
physically present at the information system or information system component
and not communicating across a network connection.

    The operating system can meet this requirement through leveraging a
cryptographic module. This requirement does not cover hardware/software
components that may support information system maintenance, yet are a part of
the system (e.g., the software implementing \""ping,\"" \""ls,\"" \""ipconfig,\"" or
the hardware and software implementing the monitoring port of an Ethernet
switch).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000393-GPOS-00173""
  tag ""gid"": ""V-89805""
  tag ""rid"": ""SV-100455r1_rule""
  tag ""stig_id"": ""VRAU-SL-001250""
  tag ""fix_id"": ""F-96547r2_fix""
  tag ""cci"": [""CCI-002890""]
  tag ""nist"": [""MA-4 (6)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the SSH daemon configuration for DoD-approved encryption
to protect the confidentiality of SSH remote connections by performing the
following commands:

Check the \""Ciphers\"" setting in the \""sshd_config\"" file.

# grep -i Ciphers /etc/ssh/sshd_config  | grep -v '#'

The output must contain either nothing or any number of the following
algorithms:

aes128-ctr, aes256-ctr.

If the output contains an algorithm not listed above, this is a finding.

Expected Output:
Ciphers aes256-ctr,aes128-ctr""
  tag ""fix"": ""Update the \""Ciphers\"" directive with the following command:

# sed -i '/^[^#]*Ciphers/ c\\Ciphers aes256-ctr,aes128-ctr' /etc/ssh/sshd_config

Save and close the file.

Restart the sshd process:

# service sshd restart""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89805.rb""}","","","","",""
V-89807,"The SLES for vRealize must implement cryptographic mechanisms to
protect the confidentiality of nonlocal maintenance and diagnostic
communications, when used for nonlocal maintenance sessions.","Privileged access contains control and configuration information and
is particularly sensitive, so additional protections are necessary. This is
maintained by using cryptographic mechanisms such as encryption to protect
confidentiality.

    Nonlocal maintenance and diagnostic activities are those activities
conducted by individuals communicating through a network, either an external
network (e.g., the Internet) or an internal network. Local maintenance and
diagnostic activities are those activities carried out by individuals
physically present at the information system or information system component
and not communicating across a network connection.

    This requirement applies to hardware/software diagnostic test equipment or
tools. This requirement does not cover hardware/software components that may
support information system maintenance, yet are a part of the system (e.g., the
software implementing ""ping,"" ""ls,"" ""ipconfig,"" or the hardware and
software implementing the monitoring port of an Ethernet switch).

    The operating system can meet this requirement through leveraging a
cryptographic module.","[{""label""=>""default"", ""data""=>""Privileged access contains control and configuration information and\nis particularly sensitive, so additional protections are necessary. This is\nmaintained by using cryptographic mechanisms such as encryption to protect\nconfidentiality.\n\n    Nonlocal maintenance and diagnostic activities are those activities\nconducted by individuals communicating through a network, either an external\nnetwork (e.g., the Internet) or an internal network. Local maintenance and\ndiagnostic activities are those activities carried out by individuals\nphysically present at the information system or information system component\nand not communicating across a network connection.\n\n    This requirement applies to hardware/software diagnostic test equipment or\ntools. This requirement does not cover hardware/software components that may\nsupport information system maintenance, yet are a part of the system (e.g., the\nsoftware implementing \""ping,\"" \""ls,\"" \""ipconfig,\"" or the hardware and\nsoftware implementing the monitoring port of an Ethernet switch).\n\n    The operating system can meet this requirement through leveraging a\ncryptographic module.""}]",0.5,[],"",SRG-OS-000394-GPOS-00174,V-89807,SV-100457r1_rule,VRAU-SL-001255,F-96549r2_fix,"[""CCI-003123""]","[""MA-4 (6)"", ""Rev_4""]","","","","","","","","","","","Check the SSH daemon configuration for allowed MACs:

# grep -i macs /etc/ssh/sshd_config | grep -v '^#'

If no lines are returned, or the returned MACs list contains any MAC other than
""hmac-sha1"", this is a finding.","Edit the SSH daemon configuration and remove any MACs other than
""hmac-sha1"". If necessary, add a ""MACs"" line.

# sed -i ""/^[^#]*MACs/ c\MACs hmac-sha1"" /etc/ssh/sshd_config","control ""V-89807"" do
  title ""The SLES for vRealize must implement cryptographic mechanisms to
protect the confidentiality of nonlocal maintenance and diagnostic
communications, when used for nonlocal maintenance sessions.""
  desc  ""Privileged access contains control and configuration information and
is particularly sensitive, so additional protections are necessary. This is
maintained by using cryptographic mechanisms such as encryption to protect
confidentiality.

    Nonlocal maintenance and diagnostic activities are those activities
conducted by individuals communicating through a network, either an external
network (e.g., the Internet) or an internal network. Local maintenance and
diagnostic activities are those activities carried out by individuals
physically present at the information system or information system component
and not communicating across a network connection.

    This requirement applies to hardware/software diagnostic test equipment or
tools. This requirement does not cover hardware/software components that may
support information system maintenance, yet are a part of the system (e.g., the
software implementing \""ping,\"" \""ls,\"" \""ipconfig,\"" or the hardware and
software implementing the monitoring port of an Ethernet switch).

    The operating system can meet this requirement through leveraging a
cryptographic module.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000394-GPOS-00174""
  tag ""gid"": ""V-89807""
  tag ""rid"": ""SV-100457r1_rule""
  tag ""stig_id"": ""VRAU-SL-001255""
  tag ""fix_id"": ""F-96549r2_fix""
  tag ""cci"": [""CCI-003123""]
  tag ""nist"": [""MA-4 (6)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the SSH daemon configuration for allowed MACs:

# grep -i macs /etc/ssh/sshd_config | grep -v '^#'

If no lines are returned, or the returned MACs list contains any MAC other than
\""hmac-sha1\"", this is a finding.""
  tag ""fix"": ""Edit the SSH daemon configuration and remove any MACs other than
\""hmac-sha1\"". If necessary, add a \""MACs\"" line.

# sed -i \""/^[^#]*MACs/ c\\MACs hmac-sha1\"" /etc/ssh/sshd_config""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89807.rb""}","","","","",""
V-89809,"The SLES for vRealize must implement NSA-approved cryptography to
protect classified information in accordance with applicable federal laws,
Executive Orders, directives, policies, regulations, and standards.","Use of weak or untested encryption algorithms undermines the purposes
of utilizing encryption to protect data. The operating system must implement
cryptographic modules adhering to the higher standards approved by the federal
government since this provides assurance they have been tested and validated.","[{""label""=>""default"", ""data""=>""Use of weak or untested encryption algorithms undermines the purposes\nof utilizing encryption to protect data. The operating system must implement\ncryptographic modules adhering to the higher standards approved by the federal\ngovernment since this provides assurance they have been tested and validated.""}]",0.7,[],"",SRG-OS-000396-GPOS-00176,V-89809,SV-100459r1_rule,VRAU-SL-001265,F-96551r2_fix,"[""CCI-002450""]","[""SC-13"", ""Rev_4""]","","","","","","","","","","","Check the SSH daemon configuration for DoD-approved encryption
to protect the confidentiality of SSH remote connections by performing the
following commands:

Check the ""Ciphers"" setting in the ""sshd_config"" file.

# grep -i Ciphers /etc/ssh/sshd_config  | grep -v '#'

The output must contain either nothing or any number of the following
algorithms:

aes128-ctr, aes256-ctr.

If the output contains an algorithm not listed above, this is a finding.

Expected Output:
Ciphers aes256-ctr,aes128-ctr","Update the ""Ciphers"" directive with the following command:

# sed -i ""/^[^#]*Ciphers/ c\Ciphers aes256-ctr,aes128-ctr""
/etc/ssh/sshd_config

Save and close the file.

Restart the sshd process:

# service sshd restart","control ""V-89809"" do
  title ""The SLES for vRealize must implement NSA-approved cryptography to
protect classified information in accordance with applicable federal laws,
Executive Orders, directives, policies, regulations, and standards.""
  desc  ""Use of weak or untested encryption algorithms undermines the purposes
of utilizing encryption to protect data. The operating system must implement
cryptographic modules adhering to the higher standards approved by the federal
government since this provides assurance they have been tested and validated.""
  impact 0.7
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000396-GPOS-00176""
  tag ""gid"": ""V-89809""
  tag ""rid"": ""SV-100459r1_rule""
  tag ""stig_id"": ""VRAU-SL-001265""
  tag ""fix_id"": ""F-96551r2_fix""
  tag ""cci"": [""CCI-002450""]
  tag ""nist"": [""SC-13"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the SSH daemon configuration for DoD-approved encryption
to protect the confidentiality of SSH remote connections by performing the
following commands:

Check the \""Ciphers\"" setting in the \""sshd_config\"" file.

# grep -i Ciphers /etc/ssh/sshd_config  | grep -v '#'

The output must contain either nothing or any number of the following
algorithms:

aes128-ctr, aes256-ctr.

If the output contains an algorithm not listed above, this is a finding.

Expected Output:
Ciphers aes256-ctr,aes128-ctr""
  tag ""fix"": ""Update the \""Ciphers\"" directive with the following command:

# sed -i \""/^[^#]*Ciphers/ c\\Ciphers aes256-ctr,aes128-ctr\""
/etc/ssh/sshd_config

Save and close the file.

Restart the sshd process:

# service sshd restart""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89809.rb""}","","","","",""
V-89811,"The SLES for vRealize must protect against or limit the effects of
Denial of Service (DoS) attacks by ensuring the SLES for vRealize is
implementing rate-limiting measures on impacted network interfaces.","DoS is a condition when a resource is not available for legitimate
users. When this occurs, the organization either cannot accomplish its mission
or must operate at degraded capacity.

    This requirement addresses the configuration of the operating system to
mitigate the impact of DoS attacks that have occurred or are ongoing on system
availability. For each system, known and potential DoS attacks must be
identified and solutions for each type implemented. A variety of technologies
exist to limit or, in some cases, eliminate the effects of DoS attacks (e.g.,
limiting processes or establishing memory partitions). Employing increased
capacity and bandwidth, combined with service redundancy, may reduce the
susceptibility to some DoS attacks.","[{""label""=>""default"", ""data""=>""DoS is a condition when a resource is not available for legitimate\nusers. When this occurs, the organization either cannot accomplish its mission\nor must operate at degraded capacity.\n\n    This requirement addresses the configuration of the operating system to\nmitigate the impact of DoS attacks that have occurred or are ongoing on system\navailability. For each system, known and potential DoS attacks must be\nidentified and solutions for each type implemented. A variety of technologies\nexist to limit or, in some cases, eliminate the effects of DoS attacks (e.g.,\nlimiting processes or establishing memory partitions). Employing increased\ncapacity and bandwidth, combined with service redundancy, may reduce the\nsusceptibility to some DoS attacks.""}]",0.7,[],"",SRG-OS-000420-GPOS-00186,V-89811,SV-100461r1_rule,VRAU-SL-001305,F-96553r1_fix,"[""CCI-002385""]","[""SC-5"", ""Rev_4""]","","","","","","","","","","","Check that the system configured to use TCP syncookies when
experiencing a TCP SYN flood.

# cat /proc/sys/net/ipv4/tcp_syncookies

If the result is not ""1"", this is a finding.","Configure the system to use TCP syncookies when experiencing a
TCP SYN flood.

Check for the presence of ""net.ipv4.tcp_syncookies"" in the /etc/sysctl.conf
file:

# grep ""net.ipv4.tcp_syncookies"" /etc/sysctl.conf

If it exists, change the value to ""1"". If it does not exist, add a setting
for tcp_syncookies:

# echo ""net.ipv4.tcp_syncookies=1"" >> /etc/sysctl.conf

Reload sysctl to verify the new change:

# sysctl -p","control ""V-89811"" do
  title ""The SLES for vRealize must protect against or limit the effects of
Denial of Service (DoS) attacks by ensuring the SLES for vRealize is
implementing rate-limiting measures on impacted network interfaces.""
  desc  ""DoS is a condition when a resource is not available for legitimate
users. When this occurs, the organization either cannot accomplish its mission
or must operate at degraded capacity.

    This requirement addresses the configuration of the operating system to
mitigate the impact of DoS attacks that have occurred or are ongoing on system
availability. For each system, known and potential DoS attacks must be
identified and solutions for each type implemented. A variety of technologies
exist to limit or, in some cases, eliminate the effects of DoS attacks (e.g.,
limiting processes or establishing memory partitions). Employing increased
capacity and bandwidth, combined with service redundancy, may reduce the
susceptibility to some DoS attacks.
  ""
  impact 0.7
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000420-GPOS-00186""
  tag ""gid"": ""V-89811""
  tag ""rid"": ""SV-100461r1_rule""
  tag ""stig_id"": ""VRAU-SL-001305""
  tag ""fix_id"": ""F-96553r1_fix""
  tag ""cci"": [""CCI-002385""]
  tag ""nist"": [""SC-5"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check that the system configured to use TCP syncookies when
experiencing a TCP SYN flood.

# cat /proc/sys/net/ipv4/tcp_syncookies

If the result is not \""1\"", this is a finding.""
  tag ""fix"": ""Configure the system to use TCP syncookies when experiencing a
TCP SYN flood.

Check for the presence of \""net.ipv4.tcp_syncookies\"" in the /etc/sysctl.conf
file:

# grep \""net.ipv4.tcp_syncookies\"" /etc/sysctl.conf

If it exists, change the value to \""1\"". If it does not exist, add a setting
for tcp_syncookies:

# echo \""net.ipv4.tcp_syncookies=1\"" >> /etc/sysctl.conf

Reload sysctl to verify the new change:

# sysctl -p""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89811.rb""}","","","","",""
V-89813,"The SLES for vRealize must protect the confidentiality and integrity
of transmitted information.","Without protection of the transmitted information, confidentiality and
integrity may be compromised because unprotected communications can be
intercepted and either read or altered.

    This requirement applies to both internal and external networks and all
types of information system components from which information can be
transmitted (e.g., servers, mobile devices, notebook computers, printers,
copiers, scanners, and facsimile machines). Communication paths outside the
physical protection of a controlled boundary are exposed to the possibility of
interception and modification.

    Protecting the confidentiality and integrity of organizational information
can be accomplished by physical means (e.g., employing physical distribution
systems) or by logical means (e.g., employing cryptographic techniques). If
physical means of protection are employed, then logical means (cryptography) do
not have to be employed, and vice versa.","[{""label""=>""default"", ""data""=>""Without protection of the transmitted information, confidentiality and\nintegrity may be compromised because unprotected communications can be\nintercepted and either read or altered.\n\n    This requirement applies to both internal and external networks and all\ntypes of information system components from which information can be\ntransmitted (e.g., servers, mobile devices, notebook computers, printers,\ncopiers, scanners, and facsimile machines). Communication paths outside the\nphysical protection of a controlled boundary are exposed to the possibility of\ninterception and modification.\n\n    Protecting the confidentiality and integrity of organizational information\ncan be accomplished by physical means (e.g., employing physical distribution\nsystems) or by logical means (e.g., employing cryptographic techniques). If\nphysical means of protection are employed, then logical means (cryptography) do\nnot have to be employed, and vice versa.""}]",0.7,[],"",SRG-OS-000423-GPOS-00187,V-89813,SV-100463r1_rule,VRAU-SL-001310,F-96555r2_fix,"[""CCI-002418""]","[""SC-8"", ""Rev_4""]","","","","","","","","","","","Check the SSH daemon configuration for DoD-approved encryption
to protect the confidentiality of SSH remote connections by performing the
following commands:

Check the ""Ciphers"" setting in the ""sshd_config"" file.

# grep -i Ciphers /etc/ssh/sshd_config  | grep -v '#'

The output must contain either nothing or any number of the following
algorithms:

aes128-ctr, aes256-ctr.

If the output contains an algorithm not listed above, this is a finding.

Expected Output:
Ciphers aes256-ctr,aes128-ctr","Update the ""Ciphers"" directive with the following command:

# sed -i ""/^[^#]*Ciphers/ c\Ciphers aes256-ctr,aes128-ctr""
/etc/ssh/sshd_config

Save and close the file.

Restart the sshd process:

# service sshd restart","control ""V-89813"" do
  title ""The SLES for vRealize must protect the confidentiality and integrity
of transmitted information.""
  desc  ""Without protection of the transmitted information, confidentiality and
integrity may be compromised because unprotected communications can be
intercepted and either read or altered.

    This requirement applies to both internal and external networks and all
types of information system components from which information can be
transmitted (e.g., servers, mobile devices, notebook computers, printers,
copiers, scanners, and facsimile machines). Communication paths outside the
physical protection of a controlled boundary are exposed to the possibility of
interception and modification.

    Protecting the confidentiality and integrity of organizational information
can be accomplished by physical means (e.g., employing physical distribution
systems) or by logical means (e.g., employing cryptographic techniques). If
physical means of protection are employed, then logical means (cryptography) do
not have to be employed, and vice versa.
  ""
  impact 0.7
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000423-GPOS-00187""
  tag ""gid"": ""V-89813""
  tag ""rid"": ""SV-100463r1_rule""
  tag ""stig_id"": ""VRAU-SL-001310""
  tag ""fix_id"": ""F-96555r2_fix""
  tag ""cci"": [""CCI-002418""]
  tag ""nist"": [""SC-8"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the SSH daemon configuration for DoD-approved encryption
to protect the confidentiality of SSH remote connections by performing the
following commands:

Check the \""Ciphers\"" setting in the \""sshd_config\"" file.

# grep -i Ciphers /etc/ssh/sshd_config  | grep -v '#'

The output must contain either nothing or any number of the following
algorithms:

aes128-ctr, aes256-ctr.

If the output contains an algorithm not listed above, this is a finding.

Expected Output:
Ciphers aes256-ctr,aes128-ctr""
  tag ""fix"": ""Update the \""Ciphers\"" directive with the following command:

# sed -i \""/^[^#]*Ciphers/ c\\Ciphers aes256-ctr,aes128-ctr\""
/etc/ssh/sshd_config

Save and close the file.

Restart the sshd process:

# service sshd restart""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89813.rb""}","","","","",""
V-89815,"The SLES for vRealize must implement cryptographic mechanisms to
prevent unauthorized disclosure of information and/or detect changes to
information during transmission unless otherwise protected by alternative
physical safeguards, such as, at a minimum, a Protected Distribution System
(PDS).","Encrypting information for transmission protects information from
unauthorized disclosure and modification. Cryptographic mechanisms implemented
to protect information integrity include, for example, cryptographic hash
functions that have common application in digital signatures, checksums, and
message authentication codes.

    Use of this requirement will be limited to situations where the data owner
has a strict requirement for ensuring data integrity and confidentiality is
maintained at every step of the data transfer and handling process. When
transmitting data, operating systems need to leverage transmission protection
mechanisms such as TLS, SSL VPNs, or IPsec.

    Alternative physical protection measures include PDS. PDSs are used to
transmit unencrypted classified National Security Information (NSI) through an
area of lesser classification or control. Since the classified NSI is
unencrypted, the PDS must provide adequate electrical, electromagnetic, and
physical safeguards to deter exploitation.","[{""label""=>""default"", ""data""=>""Encrypting information for transmission protects information from\nunauthorized disclosure and modification. Cryptographic mechanisms implemented\nto protect information integrity include, for example, cryptographic hash\nfunctions that have common application in digital signatures, checksums, and\nmessage authentication codes.\n\n    Use of this requirement will be limited to situations where the data owner\nhas a strict requirement for ensuring data integrity and confidentiality is\nmaintained at every step of the data transfer and handling process. When\ntransmitting data, operating systems need to leverage transmission protection\nmechanisms such as TLS, SSL VPNs, or IPsec.\n\n    Alternative physical protection measures include PDS. PDSs are used to\ntransmit unencrypted classified National Security Information (NSI) through an\narea of lesser classification or control. Since the classified NSI is\nunencrypted, the PDS must provide adequate electrical, electromagnetic, and\nphysical safeguards to deter exploitation.""}]",0.7,[],"",SRG-OS-000424-GPOS-00188,V-89815,SV-100465r1_rule,VRAU-SL-001315,F-96557r1_fix,"[""CCI-002421""]","[""SC-8 (1)"", ""Rev_4""]","","","","","","","","","","","Check the SSH daemon configuration for allowed MACs:

# grep -i macs /etc/ssh/sshd_config | grep -v '^#'

If no lines are returned, or the returned MACs list contains any MAC other than
""hmac-sha1"", this is a finding.","Edit the SSH daemon configuration and remove any MACs other than
""hmac-sha1"". If necessary, add a ""MACs"" line.","control ""V-89815"" do
  title ""The SLES for vRealize must implement cryptographic mechanisms to
prevent unauthorized disclosure of information and/or detect changes to
information during transmission unless otherwise protected by alternative
physical safeguards, such as, at a minimum, a Protected Distribution System
(PDS).""
  desc  ""Encrypting information for transmission protects information from
unauthorized disclosure and modification. Cryptographic mechanisms implemented
to protect information integrity include, for example, cryptographic hash
functions that have common application in digital signatures, checksums, and
message authentication codes.

    Use of this requirement will be limited to situations where the data owner
has a strict requirement for ensuring data integrity and confidentiality is
maintained at every step of the data transfer and handling process. When
transmitting data, operating systems need to leverage transmission protection
mechanisms such as TLS, SSL VPNs, or IPsec.

    Alternative physical protection measures include PDS. PDSs are used to
transmit unencrypted classified National Security Information (NSI) through an
area of lesser classification or control. Since the classified NSI is
unencrypted, the PDS must provide adequate electrical, electromagnetic, and
physical safeguards to deter exploitation.
  ""
  impact 0.7
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000424-GPOS-00188""
  tag ""gid"": ""V-89815""
  tag ""rid"": ""SV-100465r1_rule""
  tag ""stig_id"": ""VRAU-SL-001315""
  tag ""fix_id"": ""F-96557r1_fix""
  tag ""cci"": [""CCI-002421""]
  tag ""nist"": [""SC-8 (1)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the SSH daemon configuration for allowed MACs:

# grep -i macs /etc/ssh/sshd_config | grep -v '^#'

If no lines are returned, or the returned MACs list contains any MAC other than
\""hmac-sha1\"", this is a finding.""
  tag ""fix"": ""Edit the SSH daemon configuration and remove any MACs other than
\""hmac-sha1\"". If necessary, add a \""MACs\"" line.""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89815.rb""}","","","","",""
V-89817,"The SLES for vRealize must implement non-executable data to protect
its memory from unauthorized code execution.","Some adversaries launch attacks with the intent of executing code in
non-executable regions of memory or in memory locations that are prohibited.
Security safeguards employed to protect memory include, for example, data
execution prevention and address space layout randomization. Data execution
prevention safeguards can either be hardware-enforced or software-enforced with
hardware providing the greater strength of mechanism.

    Examples of attacks are buffer overflow attacks.","[{""label""=>""default"", ""data""=>""Some adversaries launch attacks with the intent of executing code in\nnon-executable regions of memory or in memory locations that are prohibited.\nSecurity safeguards employed to protect memory include, for example, data\nexecution prevention and address space layout randomization. Data execution\nprevention safeguards can either be hardware-enforced or software-enforced with\nhardware providing the greater strength of mechanism.\n\n    Examples of attacks are buffer overflow attacks.""}]",0.5,[],"",SRG-OS-000433-GPOS-00192,V-89817,SV-100467r1_rule,VRAU-SL-001335,F-96559r1_fix,"[""CCI-002824""]","[""SI-16"", ""Rev_4""]","","","","","","","","","","","The stock kernel has support for non-executable program stacks
compiled in by default. Verify that the option was specified when the kernel
was built:

# grep -i ""execute"" /var/log/boot.msg

The message: ""NX (Execute Disable) protection: active"" will be written in the
boot log when compiled in the kernel. This is the default for x86_64.

To activate this support, the “noexec=on” kernel parameter must be specified at
boot time. Check for a message with the following command:

# grep –i ""noexec"" /var/log/boot.msg

The message: ""Kernel command line: <boot parameters> noexec=on"" will be
written to the boot log when properly appended to the /boot/grub/menu.lst file.

If non-executable program stacks have not been configured, this is a finding.","Edit the /boot/grub/menu.lst file and add “noexec=on” to the end
of each kernel line entry. A system restart is required to implement this
change.","control ""V-89817"" do
  title ""The SLES for vRealize must implement non-executable data to protect
its memory from unauthorized code execution.""
  desc  ""Some adversaries launch attacks with the intent of executing code in
non-executable regions of memory or in memory locations that are prohibited.
Security safeguards employed to protect memory include, for example, data
execution prevention and address space layout randomization. Data execution
prevention safeguards can either be hardware-enforced or software-enforced with
hardware providing the greater strength of mechanism.

    Examples of attacks are buffer overflow attacks.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000433-GPOS-00192""
  tag ""gid"": ""V-89817""
  tag ""rid"": ""SV-100467r1_rule""
  tag ""stig_id"": ""VRAU-SL-001335""
  tag ""fix_id"": ""F-96559r1_fix""
  tag ""cci"": [""CCI-002824""]
  tag ""nist"": [""SI-16"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""The stock kernel has support for non-executable program stacks
compiled in by default. Verify that the option was specified when the kernel
was built:

# grep -i \""execute\"" /var/log/boot.msg

The message: \""NX (Execute Disable) protection: active\"" will be written in the
boot log when compiled in the kernel. This is the default for x86_64.

To activate this support, the “noexec=on” kernel parameter must be specified at
boot time. Check for a message with the following command:

# grep –i \""noexec\"" /var/log/boot.msg

The message: \""Kernel command line: <boot parameters> noexec=on\"" will be
written to the boot log when properly appended to the /boot/grub/menu.lst file.

If non-executable program stacks have not been configured, this is a finding.""
  tag ""fix"": ""Edit the /boot/grub/menu.lst file and add “noexec=on” to the end
of each kernel line entry. A system restart is required to implement this
change.""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89817.rb""}","","","","",""
V-89819,"The SLES for vRealize must implement address space layout
randomization to protect its memory from unauthorized code execution.","Some adversaries launch attacks with the intent of executing code in
non-executable regions of memory or in memory locations that are prohibited.
Security safeguards employed to protect memory include, for example, data
execution prevention and address space layout randomization. Data execution
prevention safeguards can either be hardware-enforced or software-enforced with
hardware providing the greater strength of mechanism.

    Examples of attacks are buffer overflow attacks.","[{""label""=>""default"", ""data""=>""Some adversaries launch attacks with the intent of executing code in\nnon-executable regions of memory or in memory locations that are prohibited.\nSecurity safeguards employed to protect memory include, for example, data\nexecution prevention and address space layout randomization. Data execution\nprevention safeguards can either be hardware-enforced or software-enforced with\nhardware providing the greater strength of mechanism.\n\n    Examples of attacks are buffer overflow attacks.""}]",0.5,[],"",SRG-OS-000433-GPOS-00193,V-89819,SV-100469r1_rule,VRAU-SL-001340,F-96561r2_fix,"[""CCI-002824""]","[""SI-16"", ""Rev_4""]","","","","","","","","","","","Verify ""randomize_va_space"" has not been changed from the
default ""1"" setting.

# sysctl kernel.randomize_va_space

If the return value is not ""kernel.randomize_va_space = 1"", this is a
finding.","Run the following command:

#sysctl kernel.randomize_va_space=1","control ""V-89819"" do
  title ""The SLES for vRealize must implement address space layout
randomization to protect its memory from unauthorized code execution.""
  desc  ""Some adversaries launch attacks with the intent of executing code in
non-executable regions of memory or in memory locations that are prohibited.
Security safeguards employed to protect memory include, for example, data
execution prevention and address space layout randomization. Data execution
prevention safeguards can either be hardware-enforced or software-enforced with
hardware providing the greater strength of mechanism.

    Examples of attacks are buffer overflow attacks.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000433-GPOS-00193""
  tag ""gid"": ""V-89819""
  tag ""rid"": ""SV-100469r1_rule""
  tag ""stig_id"": ""VRAU-SL-001340""
  tag ""fix_id"": ""F-96561r2_fix""
  tag ""cci"": [""CCI-002824""]
  tag ""nist"": [""SI-16"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify \""randomize_va_space\"" has not been changed from the
default \""1\"" setting.

# sysctl kernel.randomize_va_space

If the return value is not \""kernel.randomize_va_space = 1\"", this is a
finding.""
  tag ""fix"": ""Run the following command:

#sysctl kernel.randomize_va_space=1""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89819.rb""}","","","","",""
V-89821,"The SLES for vRealize must verify correct operation of all security
functions.","Without verification of the security functions, security functions may
not operate correctly and the failure may go unnoticed. Security function is
defined as the hardware, software, and/or firmware of the information system
responsible for enforcing the system security policy and supporting the
isolation of code and data on which the protection is based. Security
functionality includes, but is not limited to, establishing system accounts,
configuring access authorizations (i.e., permissions, privileges), setting
events to be audited, and setting intrusion detection parameters.

    This requirement applies to operating systems performing security function
verification/testing and/or systems and environments that require this
functionality.","[{""label""=>""default"", ""data""=>""Without verification of the security functions, security functions may\nnot operate correctly and the failure may go unnoticed. Security function is\ndefined as the hardware, software, and/or firmware of the information system\nresponsible for enforcing the system security policy and supporting the\nisolation of code and data on which the protection is based. Security\nfunctionality includes, but is not limited to, establishing system accounts,\nconfiguring access authorizations (i.e., permissions, privileges), setting\nevents to be audited, and setting intrusion detection parameters.\n\n    This requirement applies to operating systems performing security function\nverification/testing and/or systems and environments that require this\nfunctionality.""}]",0.5,[],"",SRG-OS-000445-GPOS-00199,V-89821,SV-100471r1_rule,VRAU-SL-001350,F-96563r1_fix,"[""CCI-002696""]","[""SI-6 a"", ""Rev_4""]","","","","","","","","","","","Verify the SLES for vRealize produces audit records by running
the following command to determine the current status of the ""auditd"" service:

# service auditd status

If the service is enabled, the returned message must contain the following text:

Checking for service auditd                running

If the service is not ""running"", this is a finding.","Enable the ""auditd"" service by performing the following
commands:

# chkconfig auditd on
# service auditd start","control ""V-89821"" do
  title ""The SLES for vRealize must verify correct operation of all security
functions.""
  desc  ""Without verification of the security functions, security functions may
not operate correctly and the failure may go unnoticed. Security function is
defined as the hardware, software, and/or firmware of the information system
responsible for enforcing the system security policy and supporting the
isolation of code and data on which the protection is based. Security
functionality includes, but is not limited to, establishing system accounts,
configuring access authorizations (i.e., permissions, privileges), setting
events to be audited, and setting intrusion detection parameters.

    This requirement applies to operating systems performing security function
verification/testing and/or systems and environments that require this
functionality.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000445-GPOS-00199""
  tag ""gid"": ""V-89821""
  tag ""rid"": ""SV-100471r1_rule""
  tag ""stig_id"": ""VRAU-SL-001350""
  tag ""fix_id"": ""F-96563r1_fix""
  tag ""cci"": [""CCI-002696""]
  tag ""nist"": [""SI-6 a"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the SLES for vRealize produces audit records by running
the following command to determine the current status of the \""auditd\"" service:

# service auditd status

If the service is enabled, the returned message must contain the following text:

Checking for service auditd                running

If the service is not \""running\"", this is a finding.""
  tag ""fix"": ""Enable the \""auditd\"" service by performing the following
commands:

# chkconfig auditd on
# service auditd start""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89821.rb""}","","","","",""
V-89823,"The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access security objects occur.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000458-GPOS-00203,V-89823,SV-100473r1_rule,VRAU-SL-001365,F-96565r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","To verify that auditing is configured for system administrator
actions, run the following command:

# auditctl -l | grep ""watch=/etc/sudoers""

The result should return a rule for sudoers, such as:

LIST_RULES: exit,always watch=/etc/sudoers perm=wa key=sudoers

If there is no output, this is a finding.","At a minimum, the audit system should collect administrator
actions for all users and ""root"". Add the following to
""/etc/audit/audit.rules"":

-w /etc/sudoers -p wa -k sudoers

OR

# /etc/dodscript.sh","control ""V-89823"" do
  title ""The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to access security objects occur.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000458-GPOS-00203""
  tag ""gid"": ""V-89823""
  tag ""rid"": ""SV-100473r1_rule""
  tag ""stig_id"": ""VRAU-SL-001365""
  tag ""fix_id"": ""F-96565r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To verify that auditing is configured for system administrator
actions, run the following command:

# auditctl -l | grep \""watch=/etc/sudoers\""

The result should return a rule for sudoers, such as:

LIST_RULES: exit,always watch=/etc/sudoers perm=wa key=sudoers

If there is no output, this is a finding.""
  tag ""fix"": ""At a minimum, the audit system should collect administrator
actions for all users and \""root\"". Add the following to
\""/etc/audit/audit.rules\"":

-w /etc/sudoers -p wa -k sudoers

OR

# /etc/dodscript.sh""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89823.rb""}","","","","",""
V-89825,"The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to modify privileges occur.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000462-GPOS-00206,V-89825,SV-100475r1_rule,VRAU-SL-001375,F-96567r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","To determine if the system is configured to audit calls to the
""chmod"" system call, run the following command:

# auditctl -l | grep syscall | grep chmod

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid=0
syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat
LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid>=500 (0x1f4) auid!=-1
(0xffffffff) syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat
LIST_RULES: exit,always arch=1073741827 (0x40000003)
syscall=chmod,lchown,sethostname,fchmod,fchown,adjtimex,init_module,delete_module,chown,lchown32,fchown32,chown32,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,clock_settime,fchownat,fchmodat

If no lines are returned, this is a finding.","At a minimum, the audit system should collect file permission
changes for all users and ""root"". Add the following to
""/etc/audit/audit.rules"":

-a always,exit -F arch=b64 -S chmod -F auid=0
-a always,exit -F arch=b64 -S chmod -F auid>=500 -F auid!=4294967295
-a always,exit -F arch=b32 -S chmod

OR

# /etc/dodscript.sh","control ""V-89825"" do
  title ""The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to modify privileges occur.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000462-GPOS-00206""
  tag ""gid"": ""V-89825""
  tag ""rid"": ""SV-100475r1_rule""
  tag ""stig_id"": ""VRAU-SL-001375""
  tag ""fix_id"": ""F-96567r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To determine if the system is configured to audit calls to the
\""chmod\"" system call, run the following command:

# auditctl -l | grep syscall | grep chmod

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid=0
syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat
LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid>=500 (0x1f4) auid!=-1
(0xffffffff) syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat
LIST_RULES: exit,always arch=1073741827 (0x40000003)
syscall=chmod,lchown,sethostname,fchmod,fchown,adjtimex,init_module,delete_module,chown,lchown32,fchown32,chown32,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,clock_settime,fchownat,fchmodat

If no lines are returned, this is a finding.""
  tag ""fix"": ""At a minimum, the audit system should collect file permission
changes for all users and \""root\"". Add the following to
\""/etc/audit/audit.rules\"":

-a always,exit -F arch=b64 -S chmod -F auid=0
-a always,exit -F arch=b64 -S chmod -F auid>=500 -F auid!=4294967295
-a always,exit -F arch=b32 -S chmod

OR

# /etc/dodscript.sh""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89825.rb""}","","","","",""
V-89827,"The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to modify security objects occur.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000463-GPOS-00207,V-89827,SV-100477r1_rule,VRAU-SL-001380,F-96569r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","To verify that auditing is configured for system administrator
actions, run the following command:

# auditctl -l | grep ""watch=/etc/sudoers""

The result should return a rule for sudoers, such as:

LIST_RULES: exit,always watch=/etc/sudoers perm=wa key=sudoers

If there is no output, this is a finding.","At a minimum, the audit system should collect administrator
actions for all users and ""root"". Add the following to
""/etc/audit/audit.rules"":

-w /etc/sudoers -p wa -k sudoers

OR

# /etc/dodscript.sh","control ""V-89827"" do
  title ""The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to modify security objects occur.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000463-GPOS-00207""
  tag ""gid"": ""V-89827""
  tag ""rid"": ""SV-100477r1_rule""
  tag ""stig_id"": ""VRAU-SL-001380""
  tag ""fix_id"": ""F-96569r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To verify that auditing is configured for system administrator
actions, run the following command:

# auditctl -l | grep \""watch=/etc/sudoers\""

The result should return a rule for sudoers, such as:

LIST_RULES: exit,always watch=/etc/sudoers perm=wa key=sudoers

If there is no output, this is a finding.""
  tag ""fix"": ""At a minimum, the audit system should collect administrator
actions for all users and \""root\"". Add the following to
\""/etc/audit/audit.rules\"":

-w /etc/sudoers -p wa -k sudoers

OR

# /etc/dodscript.sh""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89827.rb""}","","","","",""
V-89829,"The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to delete privileges occur.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000466-GPOS-00210,V-89829,SV-100479r1_rule,VRAU-SL-001390,F-96571r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","To determine if the system is configured to audit calls to the
""chmod"" system call, run the following command:

# auditctl -l | grep syscall | grep chmod

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid=0
syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat
LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid>=500 (0x1f4) auid!=-1
(0xffffffff) syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat
LIST_RULES: exit,always arch=1073741827 (0x40000003)
syscall=chmod,lchown,sethostname,fchmod,fchown,adjtimex,init_module,delete_module,chown,lchown32,fchown32,chown32,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,clock_settime,fchownat,fchmodat

If no lines are returned, this is a finding.","At a minimum, the audit system should collect file permission
changes for all users and ""root"". Add the following to
""/etc/audit/audit.rules"":

-a always,exit -F arch=b64 -S chmod -F auid=0
-a always,exit -F arch=b64 -S chmod -F auid>=500 -F auid!=4294967295
-a always,exit -F arch=b32 -S chmod

OR

# /etc/dodscript.sh","control ""V-89829"" do
  title ""The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to delete privileges occur.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000466-GPOS-00210""
  tag ""gid"": ""V-89829""
  tag ""rid"": ""SV-100479r1_rule""
  tag ""stig_id"": ""VRAU-SL-001390""
  tag ""fix_id"": ""F-96571r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To determine if the system is configured to audit calls to the
\""chmod\"" system call, run the following command:

# auditctl -l | grep syscall | grep chmod

If the system is configured to audit this activity, it will return several
lines, such as:

LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid=0
syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat
LIST_RULES: exit,always arch=3221225534 (0xc000003e) auid>=500 (0x1f4) auid!=-1
(0xffffffff) syscall=chmod,fchmod,chown,fchown,fchownat,fchmodat
LIST_RULES: exit,always arch=1073741827 (0x40000003)
syscall=chmod,lchown,sethostname,fchmod,fchown,adjtimex,init_module,delete_module,chown,lchown32,fchown32,chown32,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,clock_settime,fchownat,fchmodat

If no lines are returned, this is a finding.""
  tag ""fix"": ""At a minimum, the audit system should collect file permission
changes for all users and \""root\"". Add the following to
\""/etc/audit/audit.rules\"":

-a always,exit -F arch=b64 -S chmod -F auid=0
-a always,exit -F arch=b64 -S chmod -F auid>=500 -F auid!=4294967295
-a always,exit -F arch=b32 -S chmod

OR

# /etc/dodscript.sh""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89829.rb""}","","","","",""
V-89831,"The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to delete security objects occur.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000468-GPOS-00212,V-89831,SV-100481r1_rule,VRAU-SL-001400,F-96573r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","To verify that auditing is configured for system administrator
actions, run the following command:

# auditctl -l | grep ""watch=/etc/sudoers""

The result should return a rule for sudoers, such as:

LIST_RULES: exit,always watch=/etc/sudoers perm=wa key=sudoers

If there is no output, this is a finding.","At a minimum, the audit system should collect administrator
actions for all users and ""root"". Add the following to
""/etc/audit/audit.rules"":

-w /etc/sudoers -p wa -k sudoers

OR

# /etc/dodscript.sh","control ""V-89831"" do
  title ""The SLES for vRealize must generate audit records when
successful/unsuccessful attempts to delete security objects occur.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000468-GPOS-00212""
  tag ""gid"": ""V-89831""
  tag ""rid"": ""SV-100481r1_rule""
  tag ""stig_id"": ""VRAU-SL-001400""
  tag ""fix_id"": ""F-96573r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To verify that auditing is configured for system administrator
actions, run the following command:

# auditctl -l | grep \""watch=/etc/sudoers\""

The result should return a rule for sudoers, such as:

LIST_RULES: exit,always watch=/etc/sudoers perm=wa key=sudoers

If there is no output, this is a finding.""
  tag ""fix"": ""At a minimum, the audit system should collect administrator
actions for all users and \""root\"". Add the following to
\""/etc/audit/audit.rules\"":

-w /etc/sudoers -p wa -k sudoers

OR

# /etc/dodscript.sh""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89831.rb""}","","","","",""
V-89833,"The SLES for vRealize must generate audit records when
successful/unsuccessful logon attempts occur.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000470-GPOS-00214,V-89833,SV-100483r1_rule,VRAU-SL-001405,F-96575r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","The message types that are always recorded to
/var/log/audit/audit.log include ""LOGIN"", ""USER_LOGIN"", ""USER_START"",
""USER_END"" among others and do not need to be added to audit.rules.

The log files /var/log/faillog, /var/log/lastlog, and /var/log/tallylog must be
protected from tampering of the logon records:

# egrep ""faillog|lastlog|tallylog"" /etc/audit/audit.rules

If /var/log/faillog, /var/log/lastlog, and /var/log/tallylog entries do not
exist, this is a finding.","Ensure the auditing of logons by modifying /etc/audit/audit.rules
to contain:

-w /var/log/faillog -p wa
-w /var/log/lastlog -p wa
-w /var/log/tallylog -p wa

OR

# /etc/dodscript.sh","control ""V-89833"" do
  title ""The SLES for vRealize must generate audit records when
successful/unsuccessful logon attempts occur.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000470-GPOS-00214""
  tag ""gid"": ""V-89833""
  tag ""rid"": ""SV-100483r1_rule""
  tag ""stig_id"": ""VRAU-SL-001405""
  tag ""fix_id"": ""F-96575r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""The message types that are always recorded to
/var/log/audit/audit.log include \""LOGIN\"", \""USER_LOGIN\"", \""USER_START\"",
\""USER_END\"" among others and do not need to be added to audit.rules.

The log files /var/log/faillog, /var/log/lastlog, and /var/log/tallylog must be
protected from tampering of the logon records:

# egrep \""faillog|lastlog|tallylog\"" /etc/audit/audit.rules

If /var/log/faillog, /var/log/lastlog, and /var/log/tallylog entries do not
exist, this is a finding.""
  tag ""fix"": ""Ensure the auditing of logons by modifying /etc/audit/audit.rules
to contain:

-w /var/log/faillog -p wa
-w /var/log/lastlog -p wa
-w /var/log/tallylog -p wa

OR

# /etc/dodscript.sh""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89833.rb""}","","","","",""
V-89835,"The SLES for vRealize must generate audit records for privileged
activities or other system-level access.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000471-GPOS-00215,V-89835,SV-100485r1_rule,VRAU-SL-001410,F-96577r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","To verify that auditing of privileged command use is
configured, run the following command to find relevant setuid programs:

# find / -xdev -type f -perm -4000 -o -perm -2000 2>/dev/null

Run the following command to verify entries in the audit rules for all programs
found with the previous command:

# grep path /etc/audit/audit.rules

It should be the case that all relevant setuid programs have a line in the
audit rules.

If it is not the case, this is a finding.","At a minimum, the audit system should collect the execution of
privileged commands for all users and root. To find the relevant setuid
programs:

# find / -xdev -type f -perm -4000 -o -perm -2000 2>/dev/null

Then, for each setuid program on the system, add a line of the following form
to ""/etc/audit/audit.rules"", where [SETUID_PROG_PATH] is the full path to
each setuid program in the list:

-a always,exit -F path=[SETUID_PROG_PATH] -F perm=x -F auid>=500 -k privileged

OR

# /etc/dodscript.sh","control ""V-89835"" do
  title ""The SLES for vRealize must generate audit records for privileged
activities or other system-level access.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000471-GPOS-00215""
  tag ""gid"": ""V-89835""
  tag ""rid"": ""SV-100485r1_rule""
  tag ""stig_id"": ""VRAU-SL-001410""
  tag ""fix_id"": ""F-96577r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To verify that auditing of privileged command use is
configured, run the following command to find relevant setuid programs:

# find / -xdev -type f -perm -4000 -o -perm -2000 2>/dev/null

Run the following command to verify entries in the audit rules for all programs
found with the previous command:

# grep path /etc/audit/audit.rules

It should be the case that all relevant setuid programs have a line in the
audit rules.

If it is not the case, this is a finding.""
  tag ""fix"": ""At a minimum, the audit system should collect the execution of
privileged commands for all users and root. To find the relevant setuid
programs:

# find / -xdev -type f -perm -4000 -o -perm -2000 2>/dev/null

Then, for each setuid program on the system, add a line of the following form
to \""/etc/audit/audit.rules\"", where [SETUID_PROG_PATH] is the full path to
each setuid program in the list:

-a always,exit -F path=[SETUID_PROG_PATH] -F perm=x -F auid>=500 -k privileged

OR

# /etc/dodscript.sh""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89835.rb""}","","","","",""
V-89837,"The SLES for vRealize audit system must be configured to audit the
loading and unloading of dynamic kernel modules.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000471-GPOS-00216,V-89837,SV-100487r1_rule,VRAU-SL-001415,F-96579r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","Determine if ""/sbin/insmod"" is audited:

# cat /etc/audit/audit.rules | grep ""/sbin/insmod""

If the result does not start with ""-w"" and contain ""-p x"", this is a
finding.","Add the following to ""/etc/audit/audit.rules"" in order to
capture kernel module loading and unloading events:

-w /sbin/insmod -p x

OR

# /etc/dodscript.sh","control ""V-89837"" do
  title ""The SLES for vRealize audit system must be configured to audit the
loading and unloading of dynamic kernel modules.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000471-GPOS-00216""
  tag ""gid"": ""V-89837""
  tag ""rid"": ""SV-100487r1_rule""
  tag ""stig_id"": ""VRAU-SL-001415""
  tag ""fix_id"": ""F-96579r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Determine if \""/sbin/insmod\"" is audited:

# cat /etc/audit/audit.rules | grep \""/sbin/insmod\""

If the result does not start with \""-w\"" and contain \""-p x\"", this is a
finding.""
  tag ""fix"": ""Add the following to \""/etc/audit/audit.rules\"" in order to
capture kernel module loading and unloading events:

-w /sbin/insmod -p x

OR

# /etc/dodscript.sh""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89837.rb""}","","","","",""
V-89839,"The SLES for vRealize must generate audit records showing starting and
ending time for user access to the system.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000472-GPOS-00217,V-89839,SV-100489r1_rule,VRAU-SL-001420,F-96581r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","The message types that are always recorded to
/var/log/audit/audit.log include ""LOGIN"", ""USER_LOGIN"", ""USER_START"",
""USER_END"" among others and do not need to be added to audit.rules.

The log files /var/log/faillog, /var/log/lastlog, and /var/log/tallylog must be
protected from tampering of the logon records:

# egrep ""faillog|lastlog|tallylog"" /etc/audit/audit.rules

If /var/log/faillog, /var/log/lastlog, and /var/log/tallylog entries do not
exist, this is a finding.","Ensure the auditing of logons by modifying /etc/audit/audit.rules
to contain:

-w /var/log/faillog -p wa
-w /var/log/lastlog -p wa
-w /var/log/tallylog -p wa

OR...

# /etc/dodscript.sh","control ""V-89839"" do
  title ""The SLES for vRealize must generate audit records showing starting and
ending time for user access to the system.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000472-GPOS-00217""
  tag ""gid"": ""V-89839""
  tag ""rid"": ""SV-100489r1_rule""
  tag ""stig_id"": ""VRAU-SL-001420""
  tag ""fix_id"": ""F-96581r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""The message types that are always recorded to
/var/log/audit/audit.log include \""LOGIN\"", \""USER_LOGIN\"", \""USER_START\"",
\""USER_END\"" among others and do not need to be added to audit.rules.

The log files /var/log/faillog, /var/log/lastlog, and /var/log/tallylog must be
protected from tampering of the logon records:

# egrep \""faillog|lastlog|tallylog\"" /etc/audit/audit.rules

If /var/log/faillog, /var/log/lastlog, and /var/log/tallylog entries do not
exist, this is a finding.""
  tag ""fix"": ""Ensure the auditing of logons by modifying /etc/audit/audit.rules
to contain:

-w /var/log/faillog -p wa
-w /var/log/lastlog -p wa
-w /var/log/tallylog -p wa

OR...

# /etc/dodscript.sh""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89839.rb""}","","","","",""
V-89841,"The SLES for vRealize must generate audit records when concurrent
logons to the same account occur from different sources.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000473-GPOS-00218,V-89841,SV-100491r1_rule,VRAU-SL-001425,F-96583r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","The message types that are always recorded to
/var/log/audit/audit.log include ""LOGIN"", ""USER_LOGIN"", ""USER_START"",
""USER_END"" among others and do not need to be added to audit.rules.

The log files /var/log/faillog, /var/log/lastlog, and /var/log/tallylog must be
protected from tampering of the logon records:

# egrep ""faillog|lastlog|tallylog"" /etc/audit/audit.rules

If /var/log/faillog, /var/log/lastlog, and /var/log/tallylog entries do not
exist, this is a finding.","Ensure the auditing of logons by modifying /etc/audit/audit.rules
to contain:

-w /var/log/faillog -p wa
-w /var/log/lastlog -p wa
-w /var/log/tallylog -p wa

OR...

# /etc/dodscript.sh","control ""V-89841"" do
  title ""The SLES for vRealize must generate audit records when concurrent
logons to the same account occur from different sources.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000473-GPOS-00218""
  tag ""gid"": ""V-89841""
  tag ""rid"": ""SV-100491r1_rule""
  tag ""stig_id"": ""VRAU-SL-001425""
  tag ""fix_id"": ""F-96583r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""The message types that are always recorded to
/var/log/audit/audit.log include \""LOGIN\"", \""USER_LOGIN\"", \""USER_START\"",
\""USER_END\"" among others and do not need to be added to audit.rules.

The log files /var/log/faillog, /var/log/lastlog, and /var/log/tallylog must be
protected from tampering of the logon records:

# egrep \""faillog|lastlog|tallylog\"" /etc/audit/audit.rules

If /var/log/faillog, /var/log/lastlog, and /var/log/tallylog entries do not
exist, this is a finding.""
  tag ""fix"": ""Ensure the auditing of logons by modifying /etc/audit/audit.rules
to contain:

-w /var/log/faillog -p wa
-w /var/log/lastlog -p wa
-w /var/log/tallylog -p wa

OR...

# /etc/dodscript.sh""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89841.rb""}","","","","",""
V-89843,"The SLES for vRealize must generate audit records when
successful/unsuccessful accesses to objects occur.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000474-GPOS-00219,V-89843,SV-100493r1_rule,VRAU-SL-001430,F-96585r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","Verify the SLES for vRealize produces audit records by running
the following command to determine the current status of the ""auditd"" service:

# service auditd status

If the service is ""enabled"", the returned message must contain the following
text:

Checking for service auditd                running

If the service is not ""running"", this is a finding.","Enable the ""auditd"" service by performing the following
commands:

# chkconfig auditd on
# service auditd start","control ""V-89843"" do
  title ""The SLES for vRealize must generate audit records when
successful/unsuccessful accesses to objects occur.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000474-GPOS-00219""
  tag ""gid"": ""V-89843""
  tag ""rid"": ""SV-100493r1_rule""
  tag ""stig_id"": ""VRAU-SL-001430""
  tag ""fix_id"": ""F-96585r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the SLES for vRealize produces audit records by running
the following command to determine the current status of the \""auditd\"" service:

# service auditd status

If the service is \""enabled\"", the returned message must contain the following
text:

Checking for service auditd                running

If the service is not \""running\"", this is a finding.""
  tag ""fix"": ""Enable the \""auditd\"" service by performing the following
commands:

# chkconfig auditd on
# service auditd start""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89843.rb""}","","","","",""
V-89845,"The SLES for vRealize audit system must be configured to audit failed
attempts to access files and programs.","Unsuccessful attempts to access files could be an indicator of
malicious activity on a system. Auditing these events could serve as evidence
of potential system compromise.","[{""label""=>""default"", ""data""=>""Unsuccessful attempts to access files could be an indicator of\nmalicious activity on a system. Auditing these events could serve as evidence\nof potential system compromise.""}]",0.5,[],"",SRG-OS-000474-GPOS-00219,V-89845,SV-100495r1_rule,VRAU-SL-001440,F-96587r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","Verify auditd is configured to audit failed file access
attempts. There must be both an ""-F exit=-EPERM"" and ""-F exit=-EACCES"" for
each access syscall:

# cat /etc/audit.rules /etc/audit/audit.rules | grep -e ""-a exit,always"" |
grep -e ""-S open"" | grep -e ""-F exit=-EPERM""

# cat /etc/audit.rules /etc/audit/audit.rules | grep -e ""-a exit,always"" |
grep -e ""-S open"" | grep -e ""-F exit=-EACCES""

There must be both an ""-F exit=-EPERM"" and ""-F exit=-EACCES"" for each
access syscall.

If not, this is a finding.","Edit the audit.rules file and add the following line(s) to enable
auditing of failed attempts to access files and programs:

-a exit,always -F arch=b64 -S open -F exit=-EPERM
-a exit,always -F arch=b64 -S open -F exit=-EACCES
-a exit,always -F arch=b32 -S open -F exit=-EPERM
-a exit,always -F arch=b32 -S open -F exit=-EACCES","control ""V-89845"" do
  title ""The SLES for vRealize audit system must be configured to audit failed
attempts to access files and programs.""
  desc  ""Unsuccessful attempts to access files could be an indicator of
malicious activity on a system. Auditing these events could serve as evidence
of potential system compromise.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000474-GPOS-00219""
  tag ""gid"": ""V-89845""
  tag ""rid"": ""SV-100495r1_rule""
  tag ""stig_id"": ""VRAU-SL-001440""
  tag ""fix_id"": ""F-96587r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify auditd is configured to audit failed file access
attempts. There must be both an \""-F exit=-EPERM\"" and \""-F exit=-EACCES\"" for
each access syscall:

# cat /etc/audit.rules /etc/audit/audit.rules | grep -e \""-a exit,always\"" |
grep -e \""-S open\"" | grep -e \""-F exit=-EPERM\""

# cat /etc/audit.rules /etc/audit/audit.rules | grep -e \""-a exit,always\"" |
grep -e \""-S open\"" | grep -e \""-F exit=-EACCES\""

There must be both an \""-F exit=-EPERM\"" and \""-F exit=-EACCES\"" for each
access syscall.

If not, this is a finding.""
  tag ""fix"": ""Edit the audit.rules file and add the following line(s) to enable
auditing of failed attempts to access files and programs:

-a exit,always -F arch=b64 -S open -F exit=-EPERM
-a exit,always -F arch=b64 -S open -F exit=-EACCES
-a exit,always -F arch=b32 -S open -F exit=-EPERM
-a exit,always -F arch=b32 -S open -F exit=-EACCES""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89845.rb""}","","","","",""
V-89847,"The SLES for vRealize audit system must be configured to audit failed
attempts to access files and programs.","Unsuccessful attempts to access files could be an indicator of
malicious activity on a system. Auditing these events could serve as evidence
of potential system compromise.","[{""label""=>""default"", ""data""=>""Unsuccessful attempts to access files could be an indicator of\nmalicious activity on a system. Auditing these events could serve as evidence\nof potential system compromise.""}]",0.5,[],"",SRG-OS-000474-GPOS-00219,V-89847,SV-100497r1_rule,VRAU-SL-001455,F-96589r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","Verify auditd is configured to audit failed file access
attempts.

# cat /etc/audit.rules /etc/audit/audit.rules | grep -e ""-a exit,always"" |
grep -e ""-S ftruncate"" | grep -e ""-F success=0""

There must be an audit rule for each of the access syscalls logging all failed
accesses (-F success=0).

If not, this is a finding.","Edit the audit.rules file and add the following line(s) to enable
auditing of failed attempts to access files and programs:

-a exit,always -F arch=b64 -S ftruncate -F success=0
-a exit,always -F arch=b32 -S ftruncate -F success=0","control ""V-89847"" do
  title ""The SLES for vRealize audit system must be configured to audit failed
attempts to access files and programs.""
  desc  ""Unsuccessful attempts to access files could be an indicator of
malicious activity on a system. Auditing these events could serve as evidence
of potential system compromise.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000474-GPOS-00219""
  tag ""gid"": ""V-89847""
  tag ""rid"": ""SV-100497r1_rule""
  tag ""stig_id"": ""VRAU-SL-001455""
  tag ""fix_id"": ""F-96589r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify auditd is configured to audit failed file access
attempts.

# cat /etc/audit.rules /etc/audit/audit.rules | grep -e \""-a exit,always\"" |
grep -e \""-S ftruncate\"" | grep -e \""-F success=0\""

There must be an audit rule for each of the access syscalls logging all failed
accesses (-F success=0).

If not, this is a finding.""
  tag ""fix"": ""Edit the audit.rules file and add the following line(s) to enable
auditing of failed attempts to access files and programs:

-a exit,always -F arch=b64 -S ftruncate -F success=0
-a exit,always -F arch=b32 -S ftruncate -F success=0""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89847.rb""}","","","","",""
V-89849,"The SLES for vRealize audit system must be configured to audit user
deletions of files and programs.","Auditing file deletions will create an audit trail for files that are
removed from the system. The audit trail could aid in system troubleshooting,
as well as detecting malicious processes that attempt to delete log files to
conceal their presence.","[{""label""=>""default"", ""data""=>""Auditing file deletions will create an audit trail for files that are\nremoved from the system. The audit trail could aid in system troubleshooting,\nas well as detecting malicious processes that attempt to delete log files to\nconceal their presence.""}]",0.5,[],"",SRG-OS-000474-GPOS-00219,V-89849,SV-100499r1_rule,VRAU-SL-001460,F-96591r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","To determine if the system is configured to audit calls to the
""unlink"" system call, run the following command:

# auditctl -l | grep syscall | grep unlink | grep -v unlinkat

If the system is configured to audit this activity, it will return several
lines.

If it does not, this is a finding.

To determine if the system is configured to audit calls to the ""unlinkat""
system call, run the following command:

# auditctl -l | grep syscall | grep unlinkat

If the system is configured to audit this activity, it will return several
lines.

If it does not, this is a finding.

To determine if the system is configured to audit calls to the ""rename""
system call, run the following command:

# auditctl -l | grep syscall | grep rename | grep -v renameat

If the system is configured to audit this activity, it will return several
lines.

If it does not, this is a finding.

To determine if the system is configured to audit calls to the ""renameat""
system call, run the following command:

# auditctl -l | grep syscall | grep renameat

If the system is configured to audit this activity, it will return several
lines.

If it does not, this is a finding.","Edit the audit.rules file and add the following line(s) to enable
auditing of deletions of files and programs:

-a always,exit -F arch=b64 -S unlink -S unlinkat -S rename -S renameat -F auid=0
-a always,exit -F arch=b64 -S unlink -S unlinkat -S rename -S renameat -F
auid>=500 -F auid!=4294967295
-a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F auid=0
-a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F
auid>=500 -F auid!=4294967295","control ""V-89849"" do
  title ""The SLES for vRealize audit system must be configured to audit user
deletions of files and programs.""
  desc  ""Auditing file deletions will create an audit trail for files that are
removed from the system. The audit trail could aid in system troubleshooting,
as well as detecting malicious processes that attempt to delete log files to
conceal their presence.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000474-GPOS-00219""
  tag ""gid"": ""V-89849""
  tag ""rid"": ""SV-100499r1_rule""
  tag ""stig_id"": ""VRAU-SL-001460""
  tag ""fix_id"": ""F-96591r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""To determine if the system is configured to audit calls to the
\""unlink\"" system call, run the following command:

# auditctl -l | grep syscall | grep unlink | grep -v unlinkat

If the system is configured to audit this activity, it will return several
lines.

If it does not, this is a finding.

To determine if the system is configured to audit calls to the \""unlinkat\""
system call, run the following command:

# auditctl -l | grep syscall | grep unlinkat

If the system is configured to audit this activity, it will return several
lines.

If it does not, this is a finding.

To determine if the system is configured to audit calls to the \""rename\""
system call, run the following command:

# auditctl -l | grep syscall | grep rename | grep -v renameat

If the system is configured to audit this activity, it will return several
lines.

If it does not, this is a finding.

To determine if the system is configured to audit calls to the \""renameat\""
system call, run the following command:

# auditctl -l | grep syscall | grep renameat

If the system is configured to audit this activity, it will return several
lines.

If it does not, this is a finding.""
  tag ""fix"": ""Edit the audit.rules file and add the following line(s) to enable
auditing of deletions of files and programs:

-a always,exit -F arch=b64 -S unlink -S unlinkat -S rename -S renameat -F auid=0
-a always,exit -F arch=b64 -S unlink -S unlinkat -S rename -S renameat -F
auid>=500 -F auid!=4294967295
-a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F auid=0
-a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F
auid>=500 -F auid!=4294967295""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89849.rb""}","","","","",""
V-89851,"The SLES for vRealize audit system must be configured to audit file
deletions.","If the system is not configured to audit certain activities and write
them to an audit log, it is more difficult to detect and track system
compromises and damages incurred during a system compromise.","[{""label""=>""default"", ""data""=>""If the system is not configured to audit certain activities and write\nthem to an audit log, it is more difficult to detect and track system\ncompromises and damages incurred during a system compromise.""}]",0.5,[],"",SRG-OS-000474-GPOS-00219,V-89851,SV-100501r1_rule,VRAU-SL-001465,F-96593r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","Check the system audit configuration to determine if file and
directory deletions are audited:

# cat /etc/audit.rules /etc/audit/audit.rules | grep -e ""-a exit,always"" |
grep -i ""rmdir""

If no results are returned, or the results do not contain ""-S rmdir"", this is
a finding.","Add the following to ""/etc/audit/audit.rules"" in order to
capture file and directory deletion events:

-a always,exit -F arch=b64 -S rmdir -S rm
-a always,exit -F arch=b32 -S rmdir -S rm","control ""V-89851"" do
  title ""The SLES for vRealize audit system must be configured to audit file
deletions.""
  desc  ""If the system is not configured to audit certain activities and write
them to an audit log, it is more difficult to detect and track system
compromises and damages incurred during a system compromise.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000474-GPOS-00219""
  tag ""gid"": ""V-89851""
  tag ""rid"": ""SV-100501r1_rule""
  tag ""stig_id"": ""VRAU-SL-001465""
  tag ""fix_id"": ""F-96593r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the system audit configuration to determine if file and
directory deletions are audited:

# cat /etc/audit.rules /etc/audit/audit.rules | grep -e \""-a exit,always\"" |
grep -i \""rmdir\""

If no results are returned, or the results do not contain \""-S rmdir\"", this is
a finding.""
  tag ""fix"": ""Add the following to \""/etc/audit/audit.rules\"" in order to
capture file and directory deletion events:

-a always,exit -F arch=b64 -S rmdir -S rm
-a always,exit -F arch=b32 -S rmdir -S rm""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89851.rb""}","","","","",""
V-89853,SLES for vRealize audit logs must be rotated daily.,"Rotate audit logs daily to preserve audit file system space and to
conform to the DISA requirement. If it is not rotated daily and moved to
another location, then there is more of a chance for the compromise of audit
data by malicious users.","[{""label""=>""default"", ""data""=>""Rotate audit logs daily to preserve audit file system space and to\nconform to the DISA requirement. If it is not rotated daily and moved to\nanother location, then there is more of a chance for the compromise of audit\ndata by malicious users.""}]",0.5,[],"",SRG-OS-000474-GPOS-00219,V-89853,SV-100503r1_rule,VRAU-SL-001470,F-96595r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","Check for a ""logrotate"" entry that rotates audit logs.

# ls -l /etc/logrotate.d/audit

If it exists, check for the presence of the ""daily"" rotate flag:

# egrep ""daily"" /etc/logrotate.d/audit

The command should produce a ""daily"" entry in the logrotate file for the
audit daemon.

If the ""daily"" entry is missing, this is a finding.","Create or edit the /etc/logrotate.d/audit file and add the
""daily"" entry, such as:

/var/log/audit/audit.log {
compress
dateext
rotate 15
daily
missingok
notifempty
create 600 root root
sharedscripts
postrotate
/sbin/service auditd restart 2> /dev/null > /dev/null || true
endscript
}","control ""V-89853"" do
  title ""SLES for vRealize audit logs must be rotated daily.""
  desc  ""Rotate audit logs daily to preserve audit file system space and to
conform to the DISA requirement. If it is not rotated daily and moved to
another location, then there is more of a chance for the compromise of audit
data by malicious users.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000474-GPOS-00219""
  tag ""gid"": ""V-89853""
  tag ""rid"": ""SV-100503r1_rule""
  tag ""stig_id"": ""VRAU-SL-001470""
  tag ""fix_id"": ""F-96595r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check for a \""logrotate\"" entry that rotates audit logs.

# ls -l /etc/logrotate.d/audit

If it exists, check for the presence of the \""daily\"" rotate flag:

# egrep \""daily\"" /etc/logrotate.d/audit

The command should produce a \""daily\"" entry in the logrotate file for the
audit daemon.

If the \""daily\"" entry is missing, this is a finding.""
  tag ""fix"": ""Create or edit the /etc/logrotate.d/audit file and add the
\""daily\"" entry, such as:

/var/log/audit/audit.log {
compress
dateext
rotate 15
daily
missingok
notifempty
create 600 root root
sharedscripts
postrotate
/sbin/service auditd restart 2> /dev/null > /dev/null || true
endscript
}""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89853.rb""}","","","","",""
V-89855,"The SLES for vRealize must generate audit records for all direct
access to the information system.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000475-GPOS-00220,V-89855,SV-100505r1_rule,VRAU-SL-001475,F-96597r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","The message types that are always recorded to
/var/log/audit/audit.log include ""LOGIN"", ""USER_LOGIN"", ""USER_START"",
""USER_END"" among others and do not need to be added to audit.rules.

The log files /var/log/faillog, /var/log/lastlog, and /var/log/tallylog must be
protected from tampering of the login records:

# egrep ""faillog|lastlog|tallylog"" /etc/audit/audit.rules

If /var/log/faillog, /var/log/lastlog, and /var/log/tallylog entries do not
exist, this is a finding.","Ensure the auditing of logins by modifying /etc/audit/audit.rules
to contain:

-w /var/log/faillog -p wa
-w /var/log/lastlog -p wa
-w /var/log/tallylog -p wa

OR

# /etc/dodscript.sh","control ""V-89855"" do
  title ""The SLES for vRealize must generate audit records for all direct
access to the information system.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000475-GPOS-00220""
  tag ""gid"": ""V-89855""
  tag ""rid"": ""SV-100505r1_rule""
  tag ""stig_id"": ""VRAU-SL-001475""
  tag ""fix_id"": ""F-96597r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""The message types that are always recorded to
/var/log/audit/audit.log include \""LOGIN\"", \""USER_LOGIN\"", \""USER_START\"",
\""USER_END\"" among others and do not need to be added to audit.rules.

The log files /var/log/faillog, /var/log/lastlog, and /var/log/tallylog must be
protected from tampering of the login records:

# egrep \""faillog|lastlog|tallylog\"" /etc/audit/audit.rules

If /var/log/faillog, /var/log/lastlog, and /var/log/tallylog entries do not
exist, this is a finding.""
  tag ""fix"": ""Ensure the auditing of logins by modifying /etc/audit/audit.rules
to contain:

-w /var/log/faillog -p wa
-w /var/log/lastlog -p wa
-w /var/log/tallylog -p wa

OR

# /etc/dodscript.sh""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89855.rb""}","","","","",""
V-89857,"The SLES for vRealize must generate audit records for all account
creations, modifications, disabling, and termination events.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000476-GPOS-00221,V-89857,SV-100507r1_rule,VRAU-SL-001480,F-96599r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","Determine if execution of the ""usermod"" and ""groupmod""
executable are audited:

# auditctl -l | egrep '(usermod|groupmod)'

If either ""usermod"" or ""groupmod"" are not listed with a permissions filter
of at least ""x"", this is a finding.

Determine if execution of the ""userdel"" and ""groupdel"" executable are
audited:

# auditctl -l | egrep '(userdel|groupdel)'

If either ""userdel"" or ""groupdel"" are not listed with a permissions filter
of at least ""x"", this is a finding.

Determine if execution of ""useradd"" and ""groupadd"" are audited:

# auditctl -l | egrep '(useradd|groupadd)'

If either ""useradd"" or ""groupadd"" are not listed with a permissions filter
of at least ""x"", this is a finding.

Determine if execution of the ""passwd"" executable is audited:

# auditctl -l | grep “/usr/bin/passwd”

If ""/usr/bin/passwd"" is not listed with a permissions filter of at least
""x"", this is a finding.

Determine if /etc/passwd, /etc/shadow, /etc/group, and /etc/security/opasswd
are audited for writing:

# auditctl -l | egrep
'(/etc/passwd|/etc/shadow|/etc/group|/etc/security/opasswd)'

If any of these are not listed with a permissions filter of at least ""w"",
this is a finding.","Configure ""execute"" auditing of the ""usermod"" and
""groupmod"" executables. Add the following to the /etc/audit/audit.rules file:

-w /usr/sbin/usermod -p x -k usermod
-w /usr/sbin/groupmod -p x -k groupmod

Configure ""execute"" auditing of the ""userdel"" and ""groupdel"" executables.
Add the following to the /etc/audit/audit.rules file:

-w /usr/sbin/userdel -p x -k userdel
-w /usr/sbin/groupdel -p x -k groupdel

Configure ""execute"" auditing of the ""useradd"" and ""groupadd"" executables.
Add the following to audit.rules:

-w /usr/sbin/useradd -p x -k useradd
-w /usr/sbin/groupadd -p x -k groupadd

Configure ""execute"" auditing of the ""passwd"" executable. Add the following
to the aud.rules:

-w /usr/bin/passwd -p x -k passwd

Configure ""write"" auditing of the ""passwd"", ""shadow"", ""group"", and
""opasswd"" files. Add the following to the /etc/audit/audit.rules file:

-w /etc/passwd -p wa -k passwd
-w /etc/shadow -p wa -k shadow
-w /etc/group -p wa -k group
-w /etc/security/opasswd -p wa -k opasswd

Restart the auditd service:

# service auditd restart

OR

# /etc/dodscript.sh","control ""V-89857"" do
  title ""The SLES for vRealize must generate audit records for all account
creations, modifications, disabling, and termination events.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000476-GPOS-00221""
  tag ""gid"": ""V-89857""
  tag ""rid"": ""SV-100507r1_rule""
  tag ""stig_id"": ""VRAU-SL-001480""
  tag ""fix_id"": ""F-96599r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Determine if execution of the \""usermod\"" and \""groupmod\""
executable are audited:

# auditctl -l | egrep '(usermod|groupmod)'

If either \""usermod\"" or \""groupmod\"" are not listed with a permissions filter
of at least \""x\"", this is a finding.

Determine if execution of the \""userdel\"" and \""groupdel\"" executable are
audited:

# auditctl -l | egrep '(userdel|groupdel)'

If either \""userdel\"" or \""groupdel\"" are not listed with a permissions filter
of at least \""x\"", this is a finding.

Determine if execution of \""useradd\"" and \""groupadd\"" are audited:

# auditctl -l | egrep '(useradd|groupadd)'

If either \""useradd\"" or \""groupadd\"" are not listed with a permissions filter
of at least \""x\"", this is a finding.

Determine if execution of the \""passwd\"" executable is audited:

# auditctl -l | grep “/usr/bin/passwd”

If \""/usr/bin/passwd\"" is not listed with a permissions filter of at least
\""x\"", this is a finding.

Determine if /etc/passwd, /etc/shadow, /etc/group, and /etc/security/opasswd
are audited for writing:

# auditctl -l | egrep
'(/etc/passwd|/etc/shadow|/etc/group|/etc/security/opasswd)'

If any of these are not listed with a permissions filter of at least \""w\"",
this is a finding.""
  tag ""fix"": ""Configure \""execute\"" auditing of the \""usermod\"" and
\""groupmod\"" executables. Add the following to the /etc/audit/audit.rules file:

-w /usr/sbin/usermod -p x -k usermod
-w /usr/sbin/groupmod -p x -k groupmod

Configure \""execute\"" auditing of the \""userdel\"" and \""groupdel\"" executables.
Add the following to the /etc/audit/audit.rules file:

-w /usr/sbin/userdel -p x -k userdel
-w /usr/sbin/groupdel -p x -k groupdel

Configure \""execute\"" auditing of the \""useradd\"" and \""groupadd\"" executables.
Add the following to audit.rules:

-w /usr/sbin/useradd -p x -k useradd
-w /usr/sbin/groupadd -p x -k groupadd

Configure \""execute\"" auditing of the \""passwd\"" executable. Add the following
to the aud.rules:

-w /usr/bin/passwd -p x -k passwd

Configure \""write\"" auditing of the \""passwd\"", \""shadow\"", \""group\"", and
\""opasswd\"" files. Add the following to the /etc/audit/audit.rules file:

-w /etc/passwd -p wa -k passwd
-w /etc/shadow -p wa -k shadow
-w /etc/group -p wa -k group
-w /etc/security/opasswd -p wa -k opasswd

Restart the auditd service:

# service auditd restart

OR

# /etc/dodscript.sh""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89857.rb""}","","","","",""
V-89859,"The SLES for vRealize must generate audit records for all kernel
module load, unload, and restart actions, and also for all program initiations.","Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).","[{""label""=>""default"", ""data""=>""Without generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify those\nresponsible for one.\n\n    Audit records can be generated from various components within the\ninformation system (e.g., module or policy filter).""}]",0.5,[],"",SRG-OS-000477-GPOS-00222,V-89859,SV-100509r1_rule,VRAU-SL-001485,F-96601r1_fix,"[""CCI-000172""]","[""AU-12 c"", ""Rev_4""]","","","","","","","","","","","Determine if ""/sbin/insmod"" is audited:

# cat /etc/audit/audit.rules | grep ""/sbin/insmod""

If the result does not start with ""-w"" and contain ""-p x"", this is a
finding.","Add the following to ""/etc/audit/audit.rules"" in order to
capture kernel module loading and unloading events:

-w /sbin/insmod -p x

OR

# /etc/dodscript.sh","control ""V-89859"" do
  title ""The SLES for vRealize must generate audit records for all kernel
module load, unload, and restart actions, and also for all program initiations.""
  desc  ""Without generating audit records that are specific to the security and
mission needs of the organization, it would be difficult to establish,
correlate, and investigate the events relating to an incident or identify those
responsible for one.

    Audit records can be generated from various components within the
information system (e.g., module or policy filter).
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000477-GPOS-00222""
  tag ""gid"": ""V-89859""
  tag ""rid"": ""SV-100509r1_rule""
  tag ""stig_id"": ""VRAU-SL-001485""
  tag ""fix_id"": ""F-96601r1_fix""
  tag ""cci"": [""CCI-000172""]
  tag ""nist"": [""AU-12 c"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Determine if \""/sbin/insmod\"" is audited:

# cat /etc/audit/audit.rules | grep \""/sbin/insmod\""

If the result does not start with \""-w\"" and contain \""-p x\"", this is a
finding.""
  tag ""fix"": ""Add the following to \""/etc/audit/audit.rules\"" in order to
capture kernel module loading and unloading events:

-w /sbin/insmod -p x

OR

# /etc/dodscript.sh""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89859.rb""}","","","","",""
V-89861,"The SLES for vRealize must implement NIST FIPS-validated cryptography
for the following: to provision digital signatures, to generate cryptographic
hashes, and to protect unclassified information requiring confidentiality and
cryptographic protection in accordance with applicable federal laws, Executive
Orders, directives, policies, regulations, and standards.","Use of weak or untested encryption algorithms undermines the purposes
of utilizing encryption to protect data. The SLES for vRealize must implement
cryptographic modules adhering to the higher standards approved by the federal
government since this provides assurance they have been tested and validated.","[{""label""=>""default"", ""data""=>""Use of weak or untested encryption algorithms undermines the purposes\nof utilizing encryption to protect data. The SLES for vRealize must implement\ncryptographic modules adhering to the higher standards approved by the federal\ngovernment since this provides assurance they have been tested and validated.""}]",0.5,[],"",SRG-OS-000478-GPOS-00223,V-89861,SV-100511r1_rule,VRAU-SL-001490,F-96603r1_fix,"[""CCI-002450""]","[""SC-13"", ""Rev_4""]","","","","","","","","","","","Check the SSH daemon configuration for allowed MACs:

# grep -i macs /etc/ssh/sshd_config | grep -v '^#'

If no lines are returned, or the returned MACs list contains any MAC other than
""hmac-sha1"", this is a finding.","Edit the SSH daemon configuration and remove any MACs other than
""hmac-sha1"". If necessary, add a ""MACs"" line.","control ""V-89861"" do
  title ""The SLES for vRealize must implement NIST FIPS-validated cryptography
for the following: to provision digital signatures, to generate cryptographic
hashes, and to protect unclassified information requiring confidentiality and
cryptographic protection in accordance with applicable federal laws, Executive
Orders, directives, policies, regulations, and standards.""
  desc  ""Use of weak or untested encryption algorithms undermines the purposes
of utilizing encryption to protect data. The SLES for vRealize must implement
cryptographic modules adhering to the higher standards approved by the federal
government since this provides assurance they have been tested and validated.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000478-GPOS-00223""
  tag ""gid"": ""V-89861""
  tag ""rid"": ""SV-100511r1_rule""
  tag ""stig_id"": ""VRAU-SL-001490""
  tag ""fix_id"": ""F-96603r1_fix""
  tag ""cci"": [""CCI-002450""]
  tag ""nist"": [""SC-13"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the SSH daemon configuration for allowed MACs:

# grep -i macs /etc/ssh/sshd_config | grep -v '^#'

If no lines are returned, or the returned MACs list contains any MAC other than
\""hmac-sha1\"", this is a finding.""
  tag ""fix"": ""Edit the SSH daemon configuration and remove any MACs other than
\""hmac-sha1\"". If necessary, add a \""MACs\"" line.""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89861.rb""}","","","","",""
V-89863,"The SLES for vRealize must, at a minimum, off-load audit information
on interconnected systems in real time and off-load standalone systems weekly.","Information stored in one location is vulnerable to accidental or
incidental deletion or alteration.

    Off-loading is a common process in information systems with limited audit
storage capacity.","[{""label""=>""default"", ""data""=>""Information stored in one location is vulnerable to accidental or\nincidental deletion or alteration.\n\n    Off-loading is a common process in information systems with limited audit\nstorage capacity.""}]",0.5,[],"",SRG-OS-000479-GPOS-00224,V-89863,SV-100513r1_rule,VRAU-SL-001495,F-96605r2_fix,"[""CCI-001851""]","[""AU-4 (1)"", ""Rev_4""]","","","","","","","","","","","Check the ""syslog"" configuration file for remote syslog
servers:

# cat /etc/syslog-ng/syslog-ng.conf | grep logserver

If no line is returned, or ""logserver"" is commented out, this is a finding.","Edit the syslog configuration file and add an appropriate remote
syslog server:

In the /etc/syslog-ng/syslog-ng.conf file, the remote logging entries must be
uncommented and the IP address must be modified to point to the remote syslog
server:

#
# Enable this and adopt IP to send log messages to a log server.
#
destination logserver { udp(""10.10.10.10"" port(514)); };
log { source(src); destination(logserver); };","control ""V-89863"" do
  title ""The SLES for vRealize must, at a minimum, off-load audit information
on interconnected systems in real time and off-load standalone systems weekly.""
  desc  ""Information stored in one location is vulnerable to accidental or
incidental deletion or alteration.

    Off-loading is a common process in information systems with limited audit
storage capacity.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000479-GPOS-00224""
  tag ""gid"": ""V-89863""
  tag ""rid"": ""SV-100513r1_rule""
  tag ""stig_id"": ""VRAU-SL-001495""
  tag ""fix_id"": ""F-96605r2_fix""
  tag ""cci"": [""CCI-001851""]
  tag ""nist"": [""AU-4 (1)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the \""syslog\"" configuration file for remote syslog
servers:

# cat /etc/syslog-ng/syslog-ng.conf | grep logserver

If no line is returned, or \""logserver\"" is commented out, this is a finding.""
  tag ""fix"": ""Edit the syslog configuration file and add an appropriate remote
syslog server:

In the /etc/syslog-ng/syslog-ng.conf file, the remote logging entries must be
uncommented and the IP address must be modified to point to the remote syslog
server:

#
# Enable this and adopt IP to send log messages to a log server.
#
destination logserver { udp(\""10.10.10.10\"" port(514)); };
log { source(src); destination(logserver); };""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89863.rb""}","","","","",""
V-89865,"The SLES for vRealize must prevent the use of dictionary words for
passwords.","If the operating system allows the user to select passwords based on
dictionary words,  this increases the chances of password compromise by
increasing the opportunity for successful guesses and brute-force attacks.","[{""label""=>""default"", ""data""=>""If the operating system allows the user to select passwords based on\ndictionary words,  this increases the chances of password compromise by\nincreasing the opportunity for successful guesses and brute-force attacks.""}]",0.5,[],"",SRG-OS-000480-GPOS-00225,V-89865,SV-100515r1_rule,VRAU-SL-001500,F-96607r1_fix,"[""CCI-000366""]","[""CM-6 b"", ""Rev_4""]","","","","","","","","","","","Check ""/etc/pam.d/common-password"" for ""pam_cracklib""
configuration:

# grep pam_cracklib /etc/pam.d/common-password*

If ""pam_cracklib"" is not present, this is a finding.

Ensure the ""passwd"" command uses the ""common-password"" settings.

# grep common-password /etc/pam.d/passwd

If a line ""password include common-password"" is not found then the ""password
checks in common-password"" will not be applied to new passwords, this is a
finding.","Edit ""/etc/pam.d/common-password"" and configure
""pam_cracklib"" by adding a line such as ""password requisite
pam_cracklib.so""","control ""V-89865"" do
  title ""The SLES for vRealize must prevent the use of dictionary words for
passwords.""
  desc  ""If the operating system allows the user to select passwords based on
dictionary words,  this increases the chances of password compromise by
increasing the opportunity for successful guesses and brute-force attacks.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000480-GPOS-00225""
  tag ""gid"": ""V-89865""
  tag ""rid"": ""SV-100515r1_rule""
  tag ""stig_id"": ""VRAU-SL-001500""
  tag ""fix_id"": ""F-96607r1_fix""
  tag ""cci"": [""CCI-000366""]
  tag ""nist"": [""CM-6 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check \""/etc/pam.d/common-password\"" for \""pam_cracklib\""
configuration:

# grep pam_cracklib /etc/pam.d/common-password*

If \""pam_cracklib\"" is not present, this is a finding.

Ensure the \""passwd\"" command uses the \""common-password\"" settings.

# grep common-password /etc/pam.d/passwd

If a line \""password include common-password\"" is not found then the \""password
checks in common-password\"" will not be applied to new passwords, this is a
finding.""
  tag ""fix"": ""Edit \""/etc/pam.d/common-password\"" and configure
\""pam_cracklib\"" by adding a line such as \""password requisite
pam_cracklib.so\""""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89865.rb""}","","","","",""
V-89867,"The SLES for vRealize must prevent the use of dictionary words for
passwords.","If the operating system allows the user to select passwords based on
dictionary words, this increases the chances of password compromise by
increasing the opportunity for successful guesses and brute-force attacks.","[{""label""=>""default"", ""data""=>""If the operating system allows the user to select passwords based on\ndictionary words, this increases the chances of password compromise by\nincreasing the opportunity for successful guesses and brute-force attacks.""}]",0.5,[],"",SRG-OS-000480-GPOS-00225,V-89867,SV-100517r1_rule,VRAU-SL-001505,F-96609r1_fix,"[""CCI-000366""]","[""CM-6 b"", ""Rev_4""]","","","","","","","","","","","Verify the module ""pam_cracklib.so"" is present.

# ls /lib/security/

Confirm that ""pam_cracklib.so"" is present in the directory listing.

If ""pam_cracklib.so"" is not present, this is a finding.

Verify the file ""/etc/pam.d/common-password"" is configured.

# grep pam_cracklib /etc/pam.d/common-password*

If a line containing ""password required pam_cracklib.so""  is not present,
this is a finding.","Configure the SLES for vRealize to prevent the use of dictionary
words for passwords. Edit the file ""/etc/pam.d/common-password"". Configure
""common-password"" by adding a line such as:

password  required pam_cracklib.so

Save the changes made to the file ""/etc/pam.d/common-password"".","control ""V-89867"" do
  title ""The SLES for vRealize must prevent the use of dictionary words for
passwords.""
  desc  ""If the operating system allows the user to select passwords based on
dictionary words, this increases the chances of password compromise by
increasing the opportunity for successful guesses and brute-force attacks.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000480-GPOS-00225""
  tag ""gid"": ""V-89867""
  tag ""rid"": ""SV-100517r1_rule""
  tag ""stig_id"": ""VRAU-SL-001505""
  tag ""fix_id"": ""F-96609r1_fix""
  tag ""cci"": [""CCI-000366""]
  tag ""nist"": [""CM-6 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the module \""pam_cracklib.so\"" is present.

# ls /lib/security/

Confirm that \""pam_cracklib.so\"" is present in the directory listing.

If \""pam_cracklib.so\"" is not present, this is a finding.

Verify the file \""/etc/pam.d/common-password\"" is configured.

# grep pam_cracklib /etc/pam.d/common-password*

If a line containing \""password required pam_cracklib.so\""  is not present,
this is a finding.""
  tag ""fix"": ""Configure the SLES for vRealize to prevent the use of dictionary
words for passwords. Edit the file \""/etc/pam.d/common-password\"". Configure
\""common-password\"" by adding a line such as:

password  required pam_cracklib.so

Save the changes made to the file \""/etc/pam.d/common-password\"".""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89867.rb""}","","","","",""
V-89869,"The SLES for vRealize must prevent the use of dictionary words for
passwords.","If the operating system allows the user to select passwords based on
dictionary words, this increases the chances of password compromise by
increasing the opportunity for successful guesses and brute-force attacks.","[{""label""=>""default"", ""data""=>""If the operating system allows the user to select passwords based on\ndictionary words, this increases the chances of password compromise by\nincreasing the opportunity for successful guesses and brute-force attacks.""}]",0.5,[],"",SRG-OS-000480-GPOS-00225,V-89869,SV-100519r1_rule,VRAU-SL-001510,F-96611r1_fix,"[""CCI-000366""]","[""CM-6 b"", ""Rev_4""]","","","","","","","","","","","Verify the ""passwd"" command uses the ""common-password""
settings.

# grep common-password /etc/pam.d/passwd

If a line ""password include common-password"" is not found then the ""password
checks in common-password"" will not be applied to new passwords, and this is a
finding.","Configure the SLES for vRealize to prevent the use of dictionary
words for passwords.

Edit the file ""/etc/pam.d/passwd"". Configure ""passwd"" by adding a line such
as:

password include common-password

Save the changes made to the file.","control ""V-89869"" do
  title ""The SLES for vRealize must prevent the use of dictionary words for
passwords.""
  desc  ""If the operating system allows the user to select passwords based on
dictionary words, this increases the chances of password compromise by
increasing the opportunity for successful guesses and brute-force attacks.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000480-GPOS-00225""
  tag ""gid"": ""V-89869""
  tag ""rid"": ""SV-100519r1_rule""
  tag ""stig_id"": ""VRAU-SL-001510""
  tag ""fix_id"": ""F-96611r1_fix""
  tag ""cci"": [""CCI-000366""]
  tag ""nist"": [""CM-6 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the \""passwd\"" command uses the \""common-password\""
settings.

# grep common-password /etc/pam.d/passwd

If a line \""password include common-password\"" is not found then the \""password
checks in common-password\"" will not be applied to new passwords, and this is a
finding.""
  tag ""fix"": ""Configure the SLES for vRealize to prevent the use of dictionary
words for passwords.

Edit the file \""/etc/pam.d/passwd\"". Configure \""passwd\"" by adding a line such
as:

password include common-password

Save the changes made to the file.""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89869.rb""}","","","","",""
V-89871,"The SLES for vRealize must enforce a delay of at least 4 seconds
between logon prompts following a failed logon attempt.","Limiting the number of logon attempts over a certain time interval
reduces the chances that an unauthorized user may gain access to an account.","[{""label""=>""default"", ""data""=>""Limiting the number of logon attempts over a certain time interval\nreduces the chances that an unauthorized user may gain access to an account.""}]",0.5,[],",
",SRG-OS-000480-GPOS-00226,V-89871,SV-100521r1_rule,VRAU-SL-001515,F-96613r1_fix,"[""CCI-000366""]","[""CM-6 b"", ""Rev_4""]",",
",",
",",
",",
",",
",",
",",
",",
",",
",",
","Check the value of the ""FAIL_DELAY"" variable and the ability
to use it:

# grep FAIL_DELAY /etc/login.defs

The following result should be displayed:

FAIL_DELAY 4

If the value does not exist, or is less than ""4"", this is a finding.

Check for the use of ""pam_faildelay"":

# grep pam_faildelay /etc/pam.d/common-auth*

The following result should be displayed:

/etc/pam.d/common-auth:auth optional pam_faildelay.so

If the ""pam_faildelay.so"" module is not listed or is commented out, this is a
finding.","Add the ""pam_faildelay"" module and set the ""FAIL_DELAY""
variable.

Edit ""/etc/login.defs"" and set the value of the ""FAIL_DELAY"" variable to
""4"" or more.

Edit ""/etc/pam.d/common-auth"" and add a ""pam_faildelay"" entry if one does
not exist, such as:

auth optional pam_faildelay.so","control ""V-89871"" do
  title ""The SLES for vRealize must enforce a delay of at least 4 seconds
between logon prompts following a failed logon attempt.""
  desc  ""Limiting the number of logon attempts over a certain time interval
reduces the chances that an unauthorized user may gain access to an account.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000480-GPOS-00226""
  tag ""gid"": ""V-89871""
  tag ""rid"": ""SV-100521r1_rule""
  tag ""stig_id"": ""VRAU-SL-001515""
  tag ""fix_id"": ""F-96613r1_fix""
  tag ""cci"": [""CCI-000366""]
  tag ""nist"": [""CM-6 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check the value of the \""FAIL_DELAY\"" variable and the ability
to use it:

# grep FAIL_DELAY /etc/login.defs

The following result should be displayed:

FAIL_DELAY 4

If the value does not exist, or is less than \""4\"", this is a finding.

Check for the use of \""pam_faildelay\"":

# grep pam_faildelay /etc/pam.d/common-auth*

The following result should be displayed:

/etc/pam.d/common-auth:auth optional pam_faildelay.so

If the \""pam_faildelay.so\"" module is not listed or is commented out, this is a
finding.""
  tag ""fix"": ""Add the \""pam_faildelay\"" module and set the \""FAIL_DELAY\""
variable.

Edit \""/etc/login.defs\"" and set the value of the \""FAIL_DELAY\"" variable to
\""4\"" or more.

Edit \""/etc/pam.d/common-auth\"" and add a \""pam_faildelay\"" entry if one does
not exist, such as:

auth optional pam_faildelay.so""

describe login_defs do
  its('FAIL_DELAY') { should cmp '4' }
end

describe file('/etc/pam.d/common-auth') do
  its('content'){should match %r{auth\toptional\tpam_faildelay.so}}
end



end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89871.rb""}","passed,
passed","login.defs FAIL_DELAY should cmp == ""4"",
File /etc/pam.d/common-auth content should match /auth\toptional\tpam_faildelay.so/","0.0013169,
0.0003795","2019-08-01T08:47:33-07:00,
2019-08-01T08:47:33-07:00",",
"
V-89873,"The SLES for vRealize must enforce a delay of at least 4 seconds
between logon prompts following a failed logon attempt.","Limiting the number of logon attempts over a certain time interval
reduces the chances that an unauthorized user may gain access to an account.","[{""label""=>""default"", ""data""=>""Limiting the number of logon attempts over a certain time interval\nreduces the chances that an unauthorized user may gain access to an account.""}]",0.5,[],"",SRG-OS-000480-GPOS-00226,V-89873,SV-100523r1_rule,VRAU-SL-001520,F-96615r1_fix,"[""CCI-000366""]","[""CM-6 b"", ""Rev_4""]","","","","","","","","","","","Verify the SLES for vRealize enforces a delay of at least ""4""
seconds between logon prompts following a failed logon attempt.

Review the file ""/etc/login.defs"" and verify the parameter ""FAIL_DELAY"" is
a value of ""4"" or greater.

# grep FAIL_DELAY /etc/login.defs

The typical configuration looks something like this:

FAIL_DELAY    4

If the parameter ""FAIL_DELAY"" does not exists, or is less than ""4"", this is
a finding.","Configure the SLES for vRealize to enforce a delay of at least
""4"" seconds between logon prompts following a failed logon attempt.

Set the parameter ""FAIL_DELAY"" to a value of ""4"" or greater.

Edit the file ""/etc/login.defs"". Set the parameter ""FAIL_DELAY"" to a value
of ""4"" or greater.

The typical configuration looks something like this:

FAIL_DELAY    4

Save the changes made to the file.","control ""V-89873"" do
  title ""The SLES for vRealize must enforce a delay of at least 4 seconds
between logon prompts following a failed logon attempt.""
  desc  ""Limiting the number of logon attempts over a certain time interval
reduces the chances that an unauthorized user may gain access to an account.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000480-GPOS-00226""
  tag ""gid"": ""V-89873""
  tag ""rid"": ""SV-100523r1_rule""
  tag ""stig_id"": ""VRAU-SL-001520""
  tag ""fix_id"": ""F-96615r1_fix""
  tag ""cci"": [""CCI-000366""]
  tag ""nist"": [""CM-6 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the SLES for vRealize enforces a delay of at least \""4\""
seconds between logon prompts following a failed logon attempt.

Review the file \""/etc/login.defs\"" and verify the parameter \""FAIL_DELAY\"" is
a value of \""4\"" or greater.

# grep FAIL_DELAY /etc/login.defs

The typical configuration looks something like this:

FAIL_DELAY    4

If the parameter \""FAIL_DELAY\"" does not exists, or is less than \""4\"", this is
a finding.""
  tag ""fix"": ""Configure the SLES for vRealize to enforce a delay of at least
\""4\"" seconds between logon prompts following a failed logon attempt.

Set the parameter \""FAIL_DELAY\"" to a value of \""4\"" or greater.

Edit the file \""/etc/login.defs\"". Set the parameter \""FAIL_DELAY\"" to a value
of \""4\"" or greater.

The typical configuration looks something like this:

FAIL_DELAY    4

Save the changes made to the file.""

describe login_defs do
  its('FAIL_DELAY') { should cmp '4' }
end

end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89873.rb""}",passed,"login.defs FAIL_DELAY should cmp == ""4""",0.0009522,2019-08-01T08:47:33-07:00,""
V-89875,"The SLES for vRealize must enforce a delay of at least 4 seconds
between logon prompts following a failed logon attempt.","Limiting the number of logon attempts over a certain time interval
reduces the chances that an unauthorized user may gain access to an account.","[{""label""=>""default"", ""data""=>""Limiting the number of logon attempts over a certain time interval\nreduces the chances that an unauthorized user may gain access to an account.""}]",0.5,[],"",SRG-OS-000480-GPOS-00226,V-89875,SV-100525r1_rule,VRAU-SL-001525,F-96617r2_fix,"[""CCI-000366""]","[""CM-6 b"", ""Rev_4""]","","","","","","","","","","","Verify the SLES for vRealize enforces a delay of at least ""4""
seconds between logon prompts following a failed logon attempt.

Verify the use of the ""pam_faildelay"" module.

# grep pam_faildelay /etc/pam.d/common-auth*

The typical configuration looks something like this:

#delay is in micro seconds
auth    required    pam_faildelay.so    delay=4000000

If the line is not present, this is a finding.","Configure the SLES for vRealize to enforce a delay of at least
""4"" seconds between logon prompts following a failed logon attempt with the
following command:

# sed -i ""/^[^#]*pam_faildelay.so/ c\auth required pam_faildelay.so
delay=4000000"" /etc/pam.d/common-auth-vmware.local","control ""V-89875"" do
  title ""The SLES for vRealize must enforce a delay of at least 4 seconds
between logon prompts following a failed logon attempt.""
  desc  ""Limiting the number of logon attempts over a certain time interval
reduces the chances that an unauthorized user may gain access to an account.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000480-GPOS-00226""
  tag ""gid"": ""V-89875""
  tag ""rid"": ""SV-100525r1_rule""
  tag ""stig_id"": ""VRAU-SL-001525""
  tag ""fix_id"": ""F-96617r2_fix""
  tag ""cci"": [""CCI-000366""]
  tag ""nist"": [""CM-6 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the SLES for vRealize enforces a delay of at least \""4\""
seconds between logon prompts following a failed logon attempt.

Verify the use of the \""pam_faildelay\"" module.

# grep pam_faildelay /etc/pam.d/common-auth*

The typical configuration looks something like this:

#delay is in micro seconds
auth    required    pam_faildelay.so    delay=4000000

If the line is not present, this is a finding.""
  tag ""fix"": ""Configure the SLES for vRealize to enforce a delay of at least
\""4\"" seconds between logon prompts following a failed logon attempt with the
following command:

# sed -i \""/^[^#]*pam_faildelay.so/ c\\auth required pam_faildelay.so
delay=4000000\"" /etc/pam.d/common-auth-vmware.local""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89875.rb""}","","","","",""
V-89877,"The SLES for vRealize must be configured in accordance with the
security configuration settings based on DoD security configuration or
implementation guidance, including STIGs, NSA configuration guides, CTOs, and
DTMs.","Configuring the operating system to implement organization-wide
security implementation guides and security checklists ensures compliance with
federal standards and establishes a common security baseline across DoD that
reflects the most restrictive security posture consistent with operational
requirements.

    Configuration settings are the set of parameters that can be changed in
hardware, software, or firmware components of the system that affect the
security posture and/or functionality of the system. Security-related
parameters are those parameters impacting the security state of the system,
including the parameters required to satisfy other security control
requirements. Security-related parameters include, for example: registry
settings; account, file, directory permission settings; and settings for
functions, ports, protocols, services, and remote connections.","[{""label""=>""default"", ""data""=>""Configuring the operating system to implement organization-wide\nsecurity implementation guides and security checklists ensures compliance with\nfederal standards and establishes a common security baseline across DoD that\nreflects the most restrictive security posture consistent with operational\nrequirements.\n\n    Configuration settings are the set of parameters that can be changed in\nhardware, software, or firmware components of the system that affect the\nsecurity posture and/or functionality of the system. Security-related\nparameters are those parameters impacting the security state of the system,\nincluding the parameters required to satisfy other security control\nrequirements. Security-related parameters include, for example: registry\nsettings; account, file, directory permission settings; and settings for\nfunctions, ports, protocols, services, and remote connections.""}]",0.5,[],"",SRG-OS-000480-GPOS-00227,V-89877,SV-100527r1_rule,VRAU-SL-001530,F-96619r1_fix,"[""CCI-000366""]","[""CM-6 b"", ""Rev_4""]","","","","","","","","","","","Verify the SLES for vRealize is configured in accordance with
the security configuration settings based on DoD security configuration or
implementation guidance, including STIGs, NSA configuration guides, CTOs, and
DTMs.

If it is not, this is a finding.","Configure the SLES for vRealize in accordance with the security
configuration settings based on DoD security configuration or implementation
guidance, including STIGs, NSA configuration guides, CTOs, and DTMs.","control ""V-89877"" do
  title ""The SLES for vRealize must be configured in accordance with the
security configuration settings based on DoD security configuration or
implementation guidance, including STIGs, NSA configuration guides, CTOs, and
DTMs.""
  desc  ""Configuring the operating system to implement organization-wide
security implementation guides and security checklists ensures compliance with
federal standards and establishes a common security baseline across DoD that
reflects the most restrictive security posture consistent with operational
requirements.

    Configuration settings are the set of parameters that can be changed in
hardware, software, or firmware components of the system that affect the
security posture and/or functionality of the system. Security-related
parameters are those parameters impacting the security state of the system,
including the parameters required to satisfy other security control
requirements. Security-related parameters include, for example: registry
settings; account, file, directory permission settings; and settings for
functions, ports, protocols, services, and remote connections.
  ""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000480-GPOS-00227""
  tag ""gid"": ""V-89877""
  tag ""rid"": ""SV-100527r1_rule""
  tag ""stig_id"": ""VRAU-SL-001530""
  tag ""fix_id"": ""F-96619r1_fix""
  tag ""cci"": [""CCI-000366""]
  tag ""nist"": [""CM-6 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Verify the SLES for vRealize is configured in accordance with
the security configuration settings based on DoD security configuration or
implementation guidance, including STIGs, NSA configuration guides, CTOs, and
DTMs.

If it is not, this is a finding.""
  tag ""fix"": ""Configure the SLES for vRealize in accordance with the security
configuration settings based on DoD security configuration or implementation
guidance, including STIGs, NSA configuration guides, CTOs, and DTMs.""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89877.rb""}","","","","",""
V-89879,"The SLES for vRealize must define default permissions for all
authenticated users in such a way that the user can only read and modify their
own files.","Setting the most restrictive default permissions ensures that when new
accounts are created they do not have unnecessary access.","[{""label""=>""default"", ""data""=>""Setting the most restrictive default permissions ensures that when new\naccounts are created they do not have unnecessary access.""}]",0.5,[],"",SRG-OS-000480-GPOS-00228,V-89879,SV-100529r1_rule,VRAU-SL-001535,F-96621r1_fix,"[""CCI-000366""]","[""CM-6 b"", ""Rev_4""]","","","","","","","","","","","Check for the configured ""umask"" value in ""login.defs"" with
the following command:

# grep UMASK /etc/login.defs

If the default ""umask"" is not ""077"", this a finding.

Note: If the default umask is ""000"" or allows for the creation of
world-writable files this becomes a Severity Code I finding.","To configure the correct UMASK setting run the following command:

# sed -i ""/^[^#]*UMASK/ c\UMASK 077"" /etc/login.defs","control ""V-89879"" do
  title ""The SLES for vRealize must define default permissions for all
authenticated users in such a way that the user can only read and modify their
own files.""
  desc  ""Setting the most restrictive default permissions ensures that when new
accounts are created they do not have unnecessary access.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000480-GPOS-00228""
  tag ""gid"": ""V-89879""
  tag ""rid"": ""SV-100529r1_rule""
  tag ""stig_id"": ""VRAU-SL-001535""
  tag ""fix_id"": ""F-96621r1_fix""
  tag ""cci"": [""CCI-000366""]
  tag ""nist"": [""CM-6 b"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check for the configured \""umask\"" value in \""login.defs\"" with
the following command:

# grep UMASK /etc/login.defs

If the default \""umask\"" is not \""077\"", this a finding.

Note: If the default umask is \""000\"" or allows for the creation of
world-writable files this becomes a Severity Code I finding.""
  tag ""fix"": ""To configure the correct UMASK setting run the following command:

# sed -i \""/^[^#]*UMASK/ c\\UMASK 077\"" /etc/login.defs""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89879.rb""}","","","","",""
V-89881,"The SLES for vRealize must employ a deny-all, allow-by-exception
firewall policy for allowing connections to other systems.","Failure to restrict network connectivity only to authorized systems
permits inbound connections from malicious systems. It also permits outbound
connections that may facilitate exfiltration of DoD data.","[{""label""=>""default"", ""data""=>""Failure to restrict network connectivity only to authorized systems\npermits inbound connections from malicious systems. It also permits outbound\nconnections that may facilitate exfiltration of DoD data.""}]",0.5,[],"",SRG-OS-000480-GPOS-00231,V-89881,SV-100531r1_rule,VRAU-SL-001550,F-96623r1_fix,"[""CCI-000366"", ""CCI-002080""]","[""CM-6 b"", ""CA-3 (5)"", ""Rev_4""]","","","","","","","","","","","Check firewall configuration with the following command:

iptables --list|grep -e OUTPUT -e INPUT -e FORWARD

If employ a deny-all, allow-by-exception firewall policy for allowing
connections to other systems, this is a finding.","Configure the SLES for vRealize to employ a deny-all,
allow-by-exception firewall policy for allowing connections to other systems.","control ""V-89881"" do
  title ""The SLES for vRealize must employ a deny-all, allow-by-exception
firewall policy for allowing connections to other systems.""
  desc  ""Failure to restrict network connectivity only to authorized systems
permits inbound connections from malicious systems. It also permits outbound
connections that may facilitate exfiltration of DoD data.""
  impact 0.5
  tag ""severity"": nil
  tag ""gtitle"": ""SRG-OS-000480-GPOS-00231""
  tag ""gid"": ""V-89881""
  tag ""rid"": ""SV-100531r1_rule""
  tag ""stig_id"": ""VRAU-SL-001550""
  tag ""fix_id"": ""F-96623r1_fix""
  tag ""cci"": [""CCI-000366"", ""CCI-002080""]
  tag ""nist"": [""CM-6 b"", ""CA-3 (5)"", ""Rev_4""]
  tag ""false_negatives"": nil
  tag ""false_positives"": nil
  tag ""documentable"": false
  tag ""mitigations"": nil
  tag ""severity_override_guidance"": false
  tag ""potential_impacts"": nil
  tag ""third_party_tools"": nil
  tag ""mitigation_controls"": nil
  tag ""responsibility"": nil
  tag ""ia_controls"": nil
  tag ""check"": ""Check firewall configuration with the following command:

iptables --list|grep -e OUTPUT -e INPUT -e FORWARD

If employ a deny-all, allow-by-exception firewall policy for allowing
connections to other systems, this is a finding.""
  tag ""fix"": ""Configure the SLES for vRealize to employ a deny-all,
allow-by-exception firewall policy for allowing connections to other systems.""
end
","{""line""=>1, ""ref""=>""vmware-vrealize-automation-7-x-sles-stig-baseline/controls/V-89881.rb""}","","","","",""
